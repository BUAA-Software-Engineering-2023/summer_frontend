import{_ as Du,g as Vu,e as ht,q as Vl,s as qu,I as zu,r as $t,o as Xt,c as ks,b as lt,w as st,F as er,a as la,t as Yi,A as Yu,z as Za,k as ya,m as Tr,x as Rr,i as Xu,v as Ku,l as Gu,E as Xi,p as Zu,d as Wu}from"./index-d420b9fe.js";import{t as Qu}from"./team-b7aacf9b.js";import{c as Dt}from"./chat-41fceae0.js";const $u="/assets/doe-25c3a146.png";function Ju(e,t){const a=Object.create(null),s=e.split(",");for(let n=0;n<s.length;n++)a[s[n]]=!0;return t?n=>!!a[n.toLowerCase()]:n=>!!a[n]}const ed=()=>{},td=Object.assign,ad=Object.prototype.hasOwnProperty,ui=(e,t)=>ad.call(e,t),vs=Array.isArray,Kn=e=>v1(e)==="[object Map]",sd=e=>typeof e=="function",rd=e=>typeof e=="string",Xo=e=>typeof e=="symbol",di=e=>e!==null&&typeof e=="object",nd=Object.prototype.toString,v1=e=>nd.call(e),id=e=>v1(e).slice(8,-1),Ko=e=>rd(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,_1=(e,t)=>!Object.is(e,t),od=(e,t,a)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:a})};let Ua;class ld{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Ua&&(this.parent=Ua,this.index=(Ua.scopes||(Ua.scopes=[])).push(this)-1)}run(t){if(this.active){const a=Ua;try{return Ua=this,t()}finally{Ua=a}}}on(){Ua=this}off(){Ua=this.parent}stop(t){if(this.active){let a,s;for(a=0,s=this.effects.length;a<s;a++)this.effects[a].stop();for(a=0,s=this.cleanups.length;a<s;a++)this.cleanups[a]();if(this.scopes)for(a=0,s=this.scopes.length;a<s;a++)this.scopes[a].stop(!0);if(this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.active=!1}}}function cd(e,t=Ua){t&&t.active&&t.effects.push(e)}const Go=e=>{const t=new Set(e);return t.w=0,t.n=0,t},p1=e=>(e.w&ys)>0,g1=e=>(e.n&ys)>0,ud=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=ys},dd=e=>{const{deps:t}=e;if(t.length){let a=0;for(let s=0;s<t.length;s++){const n=t[s];p1(n)&&!g1(n)?n.delete(e):t[a++]=n,n.w&=~ys,n.n&=~ys}t.length=a}},go=new WeakMap;let Fr=0,ys=1;const bo=30;let Ca;const zs=Symbol(""),yo=Symbol("");class Zo{constructor(t,a=null,s){this.fn=t,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,cd(this,s)}run(){if(!this.active)return this.fn();let t=Ca,a=_s;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Ca,Ca=this,_s=!0,ys=1<<++Fr,Fr<=bo?ud(this):ql(this),this.fn()}finally{Fr<=bo&&dd(this),ys=1<<--Fr,Ca=this.parent,_s=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ca===this?this.deferStop=!0:this.active&&(ql(this),this.onStop&&this.onStop(),this.active=!1)}}function ql(e){const{deps:t}=e;if(t.length){for(let a=0;a<t.length;a++)t[a].delete(e);t.length=0}}let _s=!0;const b1=[];function gr(){b1.push(_s),_s=!1}function br(){const e=b1.pop();_s=e===void 0?!0:e}function pa(e,t,a){if(_s&&Ca){let s=go.get(e);s||go.set(e,s=new Map);let n=s.get(a);n||s.set(a,n=Go()),y1(n)}}function y1(e,t){let a=!1;Fr<=bo?g1(e)||(e.n|=ys,a=!p1(e)):a=!e.has(Ca),a&&(e.add(Ca),Ca.deps.push(e))}function es(e,t,a,s,n,r){const o=go.get(e);if(!o)return;let u=[];if(t==="clear")u=[...o.values()];else if(a==="length"&&vs(e))o.forEach((b,l)=>{(l==="length"||l>=s)&&u.push(b)});else switch(a!==void 0&&u.push(o.get(a)),t){case"add":vs(e)?Ko(a)&&u.push(o.get("length")):(u.push(o.get(zs)),Kn(e)&&u.push(o.get(yo)));break;case"delete":vs(e)||(u.push(o.get(zs)),Kn(e)&&u.push(o.get(yo)));break;case"set":Kn(e)&&u.push(o.get(zs));break}if(u.length===1)u[0]&&wo(u[0]);else{const b=[];for(const l of u)l&&b.push(...l);wo(Go(b))}}function wo(e,t){const a=vs(e)?e:[...e];for(const s of a)s.computed&&zl(s);for(const s of a)s.computed||zl(s)}function zl(e,t){(e!==Ca||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const md=Ju("__proto__,__v_isRef,__isVue"),w1=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Xo)),fd=Wo(),hd=Wo(!1,!0),vd=Wo(!0),Yl=_d();function _d(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...a){const s=pt(this);for(let r=0,o=this.length;r<o;r++)pa(s,"get",r+"");const n=s[t](...a);return n===-1||n===!1?s[t](...a.map(pt)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...a){gr();const s=pt(this)[t].apply(this,a);return br(),s}}),e}function Wo(e=!1,t=!1){return function(s,n,r){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&r===(e?t?Cd:k1:t?A1:E1).get(s))return s;const o=vs(s);if(!e&&o&&ui(Yl,n))return Reflect.get(Yl,n,r);const u=Reflect.get(s,n,r);return(Xo(n)?w1.has(n):md(n))||(e||pa(s,"get",n),t)?u:ea(u)?o&&Ko(n)?u:u.value:di(u)?e?T1(u):Jo(u):u}}const pd=S1(),gd=S1(!0);function S1(e=!1){return function(a,s,n,r){let o=a[s];if(Zr(o)&&ea(o)&&!ea(n))return!1;if(!e&&!Zr(n)&&(So(n)||(n=pt(n),o=pt(o)),!vs(a)&&ea(o)&&!ea(n)))return o.value=n,!0;const u=vs(a)&&Ko(s)?Number(s)<a.length:ui(a,s),b=Reflect.set(a,s,n,r);return a===pt(r)&&(u?_1(n,o)&&es(a,"set",s,n):es(a,"add",s,n)),b}}function bd(e,t){const a=ui(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&a&&es(e,"delete",t,void 0),s}function yd(e,t){const a=Reflect.has(e,t);return(!Xo(t)||!w1.has(t))&&pa(e,"has",t),a}function wd(e){return pa(e,"iterate",vs(e)?"length":zs),Reflect.ownKeys(e)}const M1={get:fd,set:pd,deleteProperty:bd,has:yd,ownKeys:wd},Sd={get:vd,set(e,t){return!0},deleteProperty(e,t){return!0}},Md=td({},M1,{get:hd,set:gd}),Qo=e=>e,mi=e=>Reflect.getPrototypeOf(e);function Rn(e,t,a=!1,s=!1){e=e.__v_raw;const n=pt(e),r=pt(t);a||(t!==r&&pa(n,"get",t),pa(n,"get",r));const{has:o}=mi(n),u=s?Qo:a?al:tl;if(o.call(n,t))return u(e.get(t));if(o.call(n,r))return u(e.get(r));e!==n&&e.get(t)}function xn(e,t=!1){const a=this.__v_raw,s=pt(a),n=pt(e);return t||(e!==n&&pa(s,"has",e),pa(s,"has",n)),e===n?a.has(e):a.has(e)||a.has(n)}function On(e,t=!1){return e=e.__v_raw,!t&&pa(pt(e),"iterate",zs),Reflect.get(e,"size",e)}function Xl(e){e=pt(e);const t=pt(this);return mi(t).has.call(t,e)||(t.add(e),es(t,"add",e,e)),this}function Kl(e,t){t=pt(t);const a=pt(this),{has:s,get:n}=mi(a);let r=s.call(a,e);r||(e=pt(e),r=s.call(a,e));const o=n.call(a,e);return a.set(e,t),r?_1(t,o)&&es(a,"set",e,t):es(a,"add",e,t),this}function Gl(e){const t=pt(this),{has:a,get:s}=mi(t);let n=a.call(t,e);n||(e=pt(e),n=a.call(t,e)),s&&s.call(t,e);const r=t.delete(e);return n&&es(t,"delete",e,void 0),r}function Zl(){const e=pt(this),t=e.size!==0,a=e.clear();return t&&es(e,"clear",void 0,void 0),a}function In(e,t){return function(s,n){const r=this,o=r.__v_raw,u=pt(o),b=t?Qo:e?al:tl;return!e&&pa(u,"iterate",zs),o.forEach((l,p)=>s.call(n,b(l),b(p),r))}}function Cn(e,t,a){return function(...s){const n=this.__v_raw,r=pt(n),o=Kn(r),u=e==="entries"||e===Symbol.iterator&&o,b=e==="keys"&&o,l=n[e](...s),p=a?Qo:t?al:tl;return!t&&pa(r,"iterate",b?yo:zs),{next(){const{value:c,done:E}=l.next();return E?{value:c,done:E}:{value:u?[p(c[0]),p(c[1])]:p(c),done:E}},[Symbol.iterator](){return this}}}}function ns(e){return function(...t){return e==="delete"?!1:this}}function Ed(){const e={get(r){return Rn(this,r)},get size(){return On(this)},has:xn,add:Xl,set:Kl,delete:Gl,clear:Zl,forEach:In(!1,!1)},t={get(r){return Rn(this,r,!1,!0)},get size(){return On(this)},has:xn,add:Xl,set:Kl,delete:Gl,clear:Zl,forEach:In(!1,!0)},a={get(r){return Rn(this,r,!0)},get size(){return On(this,!0)},has(r){return xn.call(this,r,!0)},add:ns("add"),set:ns("set"),delete:ns("delete"),clear:ns("clear"),forEach:In(!0,!1)},s={get(r){return Rn(this,r,!0,!0)},get size(){return On(this,!0)},has(r){return xn.call(this,r,!0)},add:ns("add"),set:ns("set"),delete:ns("delete"),clear:ns("clear"),forEach:In(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=Cn(r,!1,!1),a[r]=Cn(r,!0,!1),t[r]=Cn(r,!1,!0),s[r]=Cn(r,!0,!0)}),[e,a,t,s]}const[Ad,kd,Td,Rd]=Ed();function $o(e,t){const a=t?e?Rd:Td:e?kd:Ad;return(s,n,r)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?s:Reflect.get(ui(a,n)&&n in s?a:s,n,r)}const xd={get:$o(!1,!1)},Od={get:$o(!1,!0)},Id={get:$o(!0,!1)},E1=new WeakMap,A1=new WeakMap,k1=new WeakMap,Cd=new WeakMap;function Bd(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ld(e){return e.__v_skip||!Object.isExtensible(e)?0:Bd(id(e))}function Jo(e){return Zr(e)?e:el(e,!1,M1,xd,E1)}function Nd(e){return el(e,!1,Md,Od,A1)}function T1(e){return el(e,!0,Sd,Id,k1)}function el(e,t,a,s,n){if(!di(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=n.get(e);if(r)return r;const o=Ld(e);if(o===0)return e;const u=new Proxy(e,o===2?s:a);return n.set(e,u),u}function lr(e){return Zr(e)?lr(e.__v_raw):!!(e&&e.__v_isReactive)}function Zr(e){return!!(e&&e.__v_isReadonly)}function So(e){return!!(e&&e.__v_isShallow)}function R1(e){return lr(e)||Zr(e)}function pt(e){const t=e&&e.__v_raw;return t?pt(t):e}function x1(e){return od(e,"__v_skip",!0),e}const tl=e=>di(e)?Jo(e):e,al=e=>di(e)?T1(e):e;function jd(e){_s&&Ca&&(e=pt(e),y1(e.dep||(e.dep=Go())))}function Fd(e,t){e=pt(e),e.dep&&wo(e.dep)}function ea(e){return!!(e&&e.__v_isRef===!0)}function Hd(e){return ea(e)?e.value:e}const Pd={get:(e,t,a)=>Hd(Reflect.get(e,t,a)),set:(e,t,a,s)=>{const n=e[t];return ea(n)&&!ea(a)?(n.value=a,!0):Reflect.set(e,t,a,s)}};function O1(e){return lr(e)?e:new Proxy(e,Pd)}class Ud{constructor(t,a,s,n){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Zo(t,()=>{this._dirty||(this._dirty=!0,Fd(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=s}get value(){const t=pt(this);return jd(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Dd(e,t,a=!1){let s,n;const r=sd(e);return r?(s=e,n=ed):(s=e.get,n=e.set),new Ud(s,n,r||!n,a)}function Vd(e,t){const a=Object.create(null),s=e.split(",");for(let n=0;n<s.length;n++)a[s[n]]=!0;return t?n=>!!a[n.toLowerCase()]:n=>!!a[n]}function Ot(e){if(dt(e)){const t={};for(let a=0;a<e.length;a++){const s=e[a],n=ta(s)?Yd(s):Ot(s);if(n)for(const r in n)t[r]=n[r]}return t}else{if(ta(e))return e;if(aa(e))return e}}const qd=/;(?![^(]*\))/g,zd=/:(.+)/;function Yd(e){const t={};return e.split(qd).forEach(a=>{if(a){const s=a.split(zd);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function rt(e){let t="";if(ta(e))t=e;else if(dt(e))for(let a=0;a<e.length;a++){const s=rt(e[a]);s&&(t+=s+" ")}else if(aa(e))for(const a in e)e[a]&&(t+=a+" ");return t.trim()}function St(e){if(!e)return null;let{class:t,style:a}=e;return t&&!ta(t)&&(e.class=rt(t)),a&&(e.style=Ot(a)),e}const $e=e=>ta(e)?e:e==null?"":dt(e)||aa(e)&&(e.toString===j1||!ot(e.toString))?JSON.stringify(e,I1,2):String(e),I1=(e,t)=>t&&t.__v_isRef?I1(e,t.value):B1(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((a,[s,n])=>(a[`${s} =>`]=n,a),{})}:L1(t)?{[`Set(${t.size})`]:[...t.values()]}:aa(t)&&!dt(t)&&!F1(t)?String(t):t,kt={},cr=[],$a=()=>{},Xd=()=>!1,Kd=/^on[^a-z]/,sl=e=>Kd.test(e),C1=e=>e.startsWith("onUpdate:"),ga=Object.assign,rl=(e,t)=>{const a=e.indexOf(t);a>-1&&e.splice(a,1)},Gd=Object.prototype.hasOwnProperty,_t=(e,t)=>Gd.call(e,t),dt=Array.isArray,B1=e=>nl(e)==="[object Map]",L1=e=>nl(e)==="[object Set]",ot=e=>typeof e=="function",ta=e=>typeof e=="string",aa=e=>e!==null&&typeof e=="object",N1=e=>aa(e)&&ot(e.then)&&ot(e.catch),j1=Object.prototype.toString,nl=e=>j1.call(e),F1=e=>nl(e)==="[object Object]",Gn=Vd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),fi=e=>{const t=Object.create(null);return a=>t[a]||(t[a]=e(a))},Zd=/-(\w)/g,Ga=fi(e=>e.replace(Zd,(t,a)=>a?a.toUpperCase():"")),Wd=/\B([A-Z])/g,hi=fi(e=>e.replace(Wd,"-$1").toLowerCase()),il=fi(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ki=fi(e=>e?`on${il(e)}`:""),Wl=(e,t)=>!Object.is(e,t),Gi=(e,t)=>{for(let a=0;a<e.length;a++)e[a](t)},Mo=(e,t,a)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:a})},Qd=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ql;const $d=()=>Ql||(Ql=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ps(e,t,a,s){let n;try{n=s?e(...s):e()}catch(r){vi(r,t,a)}return n}function Aa(e,t,a,s){if(ot(e)){const r=ps(e,t,a,s);return r&&N1(r)&&r.catch(o=>{vi(o,t,a)}),r}const n=[];for(let r=0;r<e.length;r++)n.push(Aa(e[r],t,a,s));return n}function vi(e,t,a,s=!0){const n=t?t.vnode:null;if(t){let r=t.parent;const o=t.proxy,u=a;for(;r;){const l=r.ec;if(l){for(let p=0;p<l.length;p++)if(l[p](e,o,u)===!1)return}r=r.parent}const b=t.appContext.config.errorHandler;if(b){ps(b,null,10,[e,o,u]);return}}Jd(e,a,n,s)}function Jd(e,t,a,s=!0){console.error(e)}let ei=!1,Eo=!1;const _a=[];let Qa=0;const qr=[];let Hr=null,nr=0;const zr=[];let ms=null,ir=0;const H1=Promise.resolve();let ol=null,Ao=null;function P1(e){const t=ol||H1;return e?t.then(this?e.bind(this):e):t}function em(e){let t=Qa+1,a=_a.length;for(;t<a;){const s=t+a>>>1;Wr(_a[s])<e?t=s+1:a=s}return t}function U1(e){(!_a.length||!_a.includes(e,ei&&e.allowRecurse?Qa+1:Qa))&&e!==Ao&&(e.id==null?_a.push(e):_a.splice(em(e.id),0,e),D1())}function D1(){!ei&&!Eo&&(Eo=!0,ol=H1.then(z1))}function tm(e){const t=_a.indexOf(e);t>Qa&&_a.splice(t,1)}function V1(e,t,a,s){dt(e)?a.push(...e):(!t||!t.includes(e,e.allowRecurse?s+1:s))&&a.push(e),D1()}function am(e){V1(e,Hr,qr,nr)}function sm(e){V1(e,ms,zr,ir)}function _i(e,t=null){if(qr.length){for(Ao=t,Hr=[...new Set(qr)],qr.length=0,nr=0;nr<Hr.length;nr++)Hr[nr]();Hr=null,nr=0,Ao=null,_i(e,t)}}function q1(e){if(_i(),zr.length){const t=[...new Set(zr)];if(zr.length=0,ms){ms.push(...t);return}for(ms=t,ms.sort((a,s)=>Wr(a)-Wr(s)),ir=0;ir<ms.length;ir++)ms[ir]();ms=null,ir=0}}const Wr=e=>e.id==null?1/0:e.id;function z1(e){Eo=!1,ei=!0,_i(e),_a.sort((t,a)=>Wr(t)-Wr(a));try{for(Qa=0;Qa<_a.length;Qa++){const t=_a[Qa];t&&t.active!==!1&&ps(t,null,14)}}finally{Qa=0,_a.length=0,q1(),ei=!1,ol=null,(_a.length||qr.length||zr.length)&&z1(e)}}function rm(e,t,...a){if(e.isUnmounted)return;const s=e.vnode.props||kt;let n=a;const r=t.startsWith("update:"),o=r&&t.slice(7);if(o&&o in s){const p=`${o==="modelValue"?"model":o}Modifiers`,{number:c,trim:E}=s[p]||kt;E&&(n=a.map(A=>A.trim())),c&&(n=a.map(Qd))}let u,b=s[u=Ki(t)]||s[u=Ki(Ga(t))];!b&&r&&(b=s[u=Ki(hi(t))]),b&&Aa(b,e,6,n);const l=s[u+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Aa(l,e,6,n)}}function Y1(e,t,a=!1){const s=t.emitsCache,n=s.get(e);if(n!==void 0)return n;const r=e.emits;let o={},u=!1;if(!ot(e)){const b=l=>{const p=Y1(l,t,!0);p&&(u=!0,ga(o,p))};!a&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!r&&!u?(s.set(e,null),null):(dt(r)?r.forEach(b=>o[b]=null):ga(o,r),s.set(e,o),o)}function pi(e,t){return!e||!sl(t)?!1:(t=t.slice(2).replace(/Once$/,""),_t(e,t[0].toLowerCase()+t.slice(1))||_t(e,hi(t))||_t(e,t))}let Zt=null,X1=null;function ti(e){const t=Zt;return Zt=e,X1=e&&e.type.__scopeId||null,t}function Ze(e,t=Zt,a){if(!t||e._n)return e;const s=(...n)=>{s._d&&lc(-1);const r=ti(t),o=e(...n);return ti(r),s._d&&lc(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function Zi(e){const{type:t,vnode:a,proxy:s,withProxy:n,props:r,propsOptions:[o],slots:u,attrs:b,emit:l,render:p,renderCache:c,data:E,setupState:A,ctx:i,inheritAttrs:F}=e;let L,B;const f=ti(e);try{if(a.shapeFlag&4){const C=n||s;L=Va(p.call(C,C,c,r,A,E,i)),B=b}else{const C=t;L=Va(C.length>1?C(r,{attrs:b,slots:u,emit:l}):C(r,null)),B=t.props?b:nm(b)}}catch(C){Xr.length=0,vi(C,e,1),L=Fe(ka)}let R=L;if(B&&F!==!1){const C=Object.keys(B),{shapeFlag:T}=R;C.length&&T&7&&(o&&C.some(C1)&&(B=im(B,o)),R=ws(R,B))}return a.dirs&&(R=ws(R),R.dirs=R.dirs?R.dirs.concat(a.dirs):a.dirs),a.transition&&(R.transition=a.transition),L=R,ti(f),L}const nm=e=>{let t;for(const a in e)(a==="class"||a==="style"||sl(a))&&((t||(t={}))[a]=e[a]);return t},im=(e,t)=>{const a={};for(const s in e)(!C1(s)||!(s.slice(9)in t))&&(a[s]=e[s]);return a};function om(e,t,a){const{props:s,children:n,component:r}=e,{props:o,children:u,patchFlag:b}=t,l=r.emitsOptions;if(t.dirs||t.transition)return!0;if(a&&b>=0){if(b&1024)return!0;if(b&16)return s?$l(s,o,l):!!o;if(b&8){const p=t.dynamicProps;for(let c=0;c<p.length;c++){const E=p[c];if(o[E]!==s[E]&&!pi(l,E))return!0}}}else return(n||u)&&(!u||!u.$stable)?!0:s===o?!1:s?o?$l(s,o,l):!0:!!o;return!1}function $l(e,t,a){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let n=0;n<s.length;n++){const r=s[n];if(t[r]!==e[r]&&!pi(a,r))return!0}return!1}function lm({vnode:e,parent:t},a){for(;t&&t.subTree===e;)(e=t.vnode).el=a,t=t.parent}const cm=e=>e.__isSuspense;function um(e,t){t&&t.pendingBranch?dt(e)?t.effects.push(...e):t.effects.push(e):sm(e)}function dm(e,t){if(qt){let a=qt.provides;const s=qt.parent&&qt.parent.provides;s===a&&(a=qt.provides=Object.create(s)),a[e]=t}}function Wi(e,t,a=!1){const s=qt||Zt;if(s){const n=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(n&&e in n)return n[e];if(arguments.length>1)return a&&ot(t)?t.call(s.proxy):t}}const Jl={};function Qi(e,t,a){return K1(e,t,a)}function K1(e,t,{immediate:a,deep:s,flush:n,onTrack:r,onTrigger:o}=kt){const u=qt;let b,l=!1,p=!1;if(ea(e)?(b=()=>e.value,l=So(e)):lr(e)?(b=()=>e,s=!0):dt(e)?(p=!0,l=e.some(B=>lr(B)||So(B)),b=()=>e.map(B=>{if(ea(B))return B.value;if(lr(B))return Vs(B);if(ot(B))return ps(B,u,2)})):ot(e)?t?b=()=>ps(e,u,2):b=()=>{if(!(u&&u.isUnmounted))return c&&c(),Aa(e,u,3,[E])}:b=$a,t&&s){const B=b;b=()=>Vs(B())}let c,E=B=>{c=L.onStop=()=>{ps(B,u,4)}};if(en)return E=$a,t?a&&Aa(t,u,3,[b(),p?[]:void 0,E]):b(),$a;let A=p?[]:Jl;const i=()=>{if(L.active)if(t){const B=L.run();(s||l||(p?B.some((f,R)=>Wl(f,A[R])):Wl(B,A)))&&(c&&c(),Aa(t,u,3,[B,A===Jl?void 0:A,E]),A=B)}else L.run()};i.allowRecurse=!!t;let F;n==="sync"?F=i:n==="post"?F=()=>ca(i,u&&u.suspense):F=()=>am(i);const L=new Zo(b,F);return t?a?i():A=L.run():n==="post"?ca(L.run.bind(L),u&&u.suspense):L.run(),()=>{L.stop(),u&&u.scope&&rl(u.scope.effects,L)}}function mm(e,t,a){const s=this.proxy,n=ta(e)?e.includes(".")?G1(s,e):()=>s[e]:e.bind(s,s);let r;ot(t)?r=t:(r=t.handler,a=t);const o=qt;fr(this);const u=K1(n,r.bind(s),a);return o?fr(o):Ys(),u}function G1(e,t){const a=t.split(".");return()=>{let s=e;for(let n=0;n<a.length&&s;n++)s=s[a[n]];return s}}function Vs(e,t){if(!aa(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ea(e))Vs(e.value,t);else if(dt(e))for(let a=0;a<e.length;a++)Vs(e[a],t);else if(L1(e)||B1(e))e.forEach(a=>{Vs(a,t)});else if(F1(e))for(const a in e)Vs(e[a],t);return e}function Z1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return J1(()=>{e.isMounted=!0}),t0(()=>{e.isUnmounting=!0}),e}const wa=[Function,Array],fm={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:wa,onEnter:wa,onAfterEnter:wa,onEnterCancelled:wa,onBeforeLeave:wa,onLeave:wa,onAfterLeave:wa,onLeaveCancelled:wa,onBeforeAppear:wa,onAppear:wa,onAfterAppear:wa,onAppearCancelled:wa},setup(e,{slots:t}){const a=_0(),s=Z1();let n;return()=>{const r=t.default&&ll(t.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const F of r)if(F.type!==ka){o=F;break}}const u=pt(e),{mode:b}=u;if(s.isLeaving)return $i(o);const l=ec(o);if(!l)return $i(o);const p=Qr(l,u,s,a);$r(l,p);const c=a.subTree,E=c&&ec(c);let A=!1;const{getTransitionKey:i}=l.type;if(i){const F=i();n===void 0?n=F:F!==n&&(n=F,A=!0)}if(E&&E.type!==ka&&(!Ps(l,E)||A)){const F=Qr(E,u,s,a);if($r(E,F),b==="out-in")return s.isLeaving=!0,F.afterLeave=()=>{s.isLeaving=!1,a.update()},$i(o);b==="in-out"&&l.type!==ka&&(F.delayLeave=(L,B,f)=>{const R=Q1(s,E);R[String(E.key)]=E,L._leaveCb=()=>{B(),L._leaveCb=void 0,delete p.delayedLeave},p.delayedLeave=f})}return o}}},W1=fm;function Q1(e,t){const{leavingVNodes:a}=e;let s=a.get(t.type);return s||(s=Object.create(null),a.set(t.type,s)),s}function Qr(e,t,a,s){const{appear:n,mode:r,persisted:o=!1,onBeforeEnter:u,onEnter:b,onAfterEnter:l,onEnterCancelled:p,onBeforeLeave:c,onLeave:E,onAfterLeave:A,onLeaveCancelled:i,onBeforeAppear:F,onAppear:L,onAfterAppear:B,onAppearCancelled:f}=t,R=String(e.key),C=Q1(a,e),T=(k,S)=>{k&&Aa(k,s,9,S)},N=(k,S)=>{const h=S[1];T(k,S),dt(k)?k.every(g=>g.length<=1)&&h():k.length<=1&&h()},m={mode:r,persisted:o,beforeEnter(k){let S=u;if(!a.isMounted)if(n)S=F||u;else return;k._leaveCb&&k._leaveCb(!0);const h=C[R];h&&Ps(e,h)&&h.el._leaveCb&&h.el._leaveCb(),T(S,[k])},enter(k){let S=b,h=l,g=p;if(!a.isMounted)if(n)S=L||b,h=B||l,g=f||p;else return;let _=!1;const v=k._enterCb=y=>{_||(_=!0,y?T(g,[k]):T(h,[k]),m.delayedLeave&&m.delayedLeave(),k._enterCb=void 0)};S?N(S,[k,v]):v()},leave(k,S){const h=String(e.key);if(k._enterCb&&k._enterCb(!0),a.isUnmounting)return S();T(c,[k]);let g=!1;const _=k._leaveCb=v=>{g||(g=!0,S(),v?T(i,[k]):T(A,[k]),k._leaveCb=void 0,C[h]===e&&delete C[h])};C[h]=e,E?N(E,[k,_]):_()},clone(k){return Qr(k,t,a,s)}};return m}function $i(e){if(gi(e))return e=ws(e),e.children=null,e}function ec(e){return gi(e)?e.children?e.children[0]:void 0:e}function $r(e,t){e.shapeFlag&6&&e.component?$r(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ll(e,t=!1,a){let s=[],n=0;for(let r=0;r<e.length;r++){let o=e[r];const u=a==null?o.key:String(a)+String(o.key!=null?o.key:r);o.type===ft?(o.patchFlag&128&&n++,s=s.concat(ll(o.children,t,u))):(t||o.type!==ka)&&s.push(u!=null?ws(o,{key:u}):o)}if(n>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function hm(e){return ot(e)?{setup:e,name:e.name}:e}const Yr=e=>!!e.type.__asyncLoader,gi=e=>e.type.__isKeepAlive;function vm(e,t){$1(e,"a",t)}function _m(e,t){$1(e,"da",t)}function $1(e,t,a=qt){const s=e.__wdc||(e.__wdc=()=>{let n=a;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(bi(t,s,a),a){let n=a.parent;for(;n&&n.parent;)gi(n.parent.vnode)&&pm(s,t,a,n),n=n.parent}}function pm(e,t,a,s){const n=bi(t,e,s,!0);a0(()=>{rl(s[t],n)},a)}function bi(e,t,a=qt,s=!1){if(a){const n=a[e]||(a[e]=[]),r=t.__weh||(t.__weh=(...o)=>{if(a.isUnmounted)return;gr(),fr(a);const u=Aa(t,a,e,o);return Ys(),br(),u});return s?n.unshift(r):n.push(r),r}}const ss=e=>(t,a=qt)=>(!en||e==="sp")&&bi(e,t,a),gm=ss("bm"),J1=ss("m"),bm=ss("bu"),e0=ss("u"),t0=ss("bum"),a0=ss("um"),ym=ss("sp"),wm=ss("rtg"),Sm=ss("rtc");function Mm(e,t=qt){bi("ec",e,t)}function ts(e,t){const a=Zt;if(a===null)return e;const s=Si(a)||a.proxy,n=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[o,u,b,l=kt]=t[r];ot(o)&&(o={mounted:o,updated:o}),o.deep&&Vs(u),n.push({dir:o,instance:s,value:u,oldValue:void 0,arg:b,modifiers:l})}return e}function Ts(e,t,a,s){const n=e.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const u=n[o];r&&(u.oldValue=r[o].value);let b=u.dir[s];b&&(gr(),Aa(b,a,8,[e.el,u,e,t]),br())}}const cl="components",Em="directives";function Ge(e,t){return ul(cl,e,!0,t)||e}const s0=Symbol();function Am(e){return ta(e)?ul(cl,e,!1)||e:e||s0}function yi(e){return ul(Em,e)}function ul(e,t,a=!0,s=!1){const n=Zt||qt;if(n){const r=n.type;if(e===cl){const u=$m(r,!1);if(u&&(u===t||u===Ga(t)||u===il(Ga(t))))return r}const o=tc(n[e]||r[e],t)||tc(n.appContext[e],t);return!o&&s?r:o}}function tc(e,t){return e&&(e[t]||e[Ga(t)]||e[il(Ga(t))])}function at(e,t,a,s){let n;const r=a&&a[s];if(dt(e)||ta(e)){n=new Array(e.length);for(let o=0,u=e.length;o<u;o++)n[o]=t(e[o],o,void 0,r&&r[o])}else if(typeof e=="number"){n=new Array(e);for(let o=0;o<e;o++)n[o]=t(o+1,o,void 0,r&&r[o])}else if(aa(e))if(e[Symbol.iterator])n=Array.from(e,(o,u)=>t(o,u,void 0,r&&r[u]));else{const o=Object.keys(e);n=new Array(o.length);for(let u=0,b=o.length;u<b;u++){const l=o[u];n[u]=t(e[l],l,u,r&&r[u])}}else n=[];return a&&(a[s]=n),n}function Mt(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(dt(s))for(let n=0;n<s.length;n++)e[s[n].name]=s[n].fn;else s&&(e[s.name]=s.fn)}return e}function Le(e,t,a={},s,n){if(Zt.isCE||Zt.parent&&Yr(Zt.parent)&&Zt.parent.isCE)return Fe("slot",t==="default"?null:{name:t},s&&s());let r=e[t];r&&r._c&&(r._d=!1),ee();const o=r&&r0(r(a)),u=gt(ft,{key:a.key||`_${t}`},o||(s?s():[]),o&&e._===1?64:-2);return!n&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),r&&r._c&&(r._d=!0),u}function r0(e){return e.some(t=>ri(t)?!(t.type===ka||t.type===ft&&!r0(t.children)):!0)?e:null}const ko=e=>e?p0(e)?Si(e)||e.proxy:ko(e.parent):null,ai=ga(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ko(e.parent),$root:e=>ko(e.root),$emit:e=>e.emit,$options:e=>i0(e),$forceUpdate:e=>e.f||(e.f=()=>U1(e.update)),$nextTick:e=>e.n||(e.n=P1.bind(e.proxy)),$watch:e=>mm.bind(e)}),km={get({_:e},t){const{ctx:a,setupState:s,data:n,props:r,accessCache:o,type:u,appContext:b}=e;let l;if(t[0]!=="$"){const A=o[t];if(A!==void 0)switch(A){case 1:return s[t];case 2:return n[t];case 4:return a[t];case 3:return r[t]}else{if(s!==kt&&_t(s,t))return o[t]=1,s[t];if(n!==kt&&_t(n,t))return o[t]=2,n[t];if((l=e.propsOptions[0])&&_t(l,t))return o[t]=3,r[t];if(a!==kt&&_t(a,t))return o[t]=4,a[t];To&&(o[t]=0)}}const p=ai[t];let c,E;if(p)return t==="$attrs"&&pa(e,"get",t),p(e);if((c=u.__cssModules)&&(c=c[t]))return c;if(a!==kt&&_t(a,t))return o[t]=4,a[t];if(E=b.config.globalProperties,_t(E,t))return E[t]},set({_:e},t,a){const{data:s,setupState:n,ctx:r}=e;return n!==kt&&_t(n,t)?(n[t]=a,!0):s!==kt&&_t(s,t)?(s[t]=a,!0):_t(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=a,!0)},has({_:{data:e,setupState:t,accessCache:a,ctx:s,appContext:n,propsOptions:r}},o){let u;return!!a[o]||e!==kt&&_t(e,o)||t!==kt&&_t(t,o)||(u=r[0])&&_t(u,o)||_t(s,o)||_t(ai,o)||_t(n.config.globalProperties,o)},defineProperty(e,t,a){return a.get!=null?e._.accessCache[t]=0:_t(a,"value")&&this.set(e,t,a.value,null),Reflect.defineProperty(e,t,a)}};let To=!0;function Tm(e){const t=i0(e),a=e.proxy,s=e.ctx;To=!1,t.beforeCreate&&ac(t.beforeCreate,e,"bc");const{data:n,computed:r,methods:o,watch:u,provide:b,inject:l,created:p,beforeMount:c,mounted:E,beforeUpdate:A,updated:i,activated:F,deactivated:L,beforeDestroy:B,beforeUnmount:f,destroyed:R,unmounted:C,render:T,renderTracked:N,renderTriggered:m,errorCaptured:k,serverPrefetch:S,expose:h,inheritAttrs:g,components:_,directives:v,filters:y}=t;if(l&&Rm(l,s,null,e.appContext.config.unwrapInjectedRef),o)for(const K in o){const P=o[K];ot(P)&&(s[K]=P.bind(a))}if(n){const K=n.call(a,a);aa(K)&&(e.data=Jo(K))}if(To=!0,r)for(const K in r){const P=r[K],z=ot(P)?P.bind(a,a):ot(P.get)?P.get.bind(a,a):$a,d=!ot(P)&&ot(P.set)?P.set.bind(a):$a,M=ef({get:z,set:d});Object.defineProperty(s,K,{enumerable:!0,configurable:!0,get:()=>M.value,set:W=>M.value=W})}if(u)for(const K in u)n0(u[K],s,a,K);if(b){const K=ot(b)?b.call(a):b;Reflect.ownKeys(K).forEach(P=>{dm(P,K[P])})}p&&ac(p,e,"c");function j(K,P){dt(P)?P.forEach(z=>K(z.bind(a))):P&&K(P.bind(a))}if(j(gm,c),j(J1,E),j(bm,A),j(e0,i),j(vm,F),j(_m,L),j(Mm,k),j(Sm,N),j(wm,m),j(t0,f),j(a0,C),j(ym,S),dt(h))if(h.length){const K=e.exposed||(e.exposed={});h.forEach(P=>{Object.defineProperty(K,P,{get:()=>a[P],set:z=>a[P]=z})})}else e.exposed||(e.exposed={});T&&e.render===$a&&(e.render=T),g!=null&&(e.inheritAttrs=g),_&&(e.components=_),v&&(e.directives=v)}function Rm(e,t,a=$a,s=!1){dt(e)&&(e=Ro(e));for(const n in e){const r=e[n];let o;aa(r)?"default"in r?o=Wi(r.from||n,r.default,!0):o=Wi(r.from||n):o=Wi(r),ea(o)&&s?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>o.value,set:u=>o.value=u}):t[n]=o}}function ac(e,t,a){Aa(dt(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,a)}function n0(e,t,a,s){const n=s.includes(".")?G1(a,s):()=>a[s];if(ta(e)){const r=t[e];ot(r)&&Qi(n,r)}else if(ot(e))Qi(n,e.bind(a));else if(aa(e))if(dt(e))e.forEach(r=>n0(r,t,a,s));else{const r=ot(e.handler)?e.handler.bind(a):t[e.handler];ot(r)&&Qi(n,r,e)}}function i0(e){const t=e.type,{mixins:a,extends:s}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=e.appContext,u=r.get(t);let b;return u?b=u:!n.length&&!a&&!s?b=t:(b={},n.length&&n.forEach(l=>si(b,l,o,!0)),si(b,t,o)),r.set(t,b),b}function si(e,t,a,s=!1){const{mixins:n,extends:r}=t;r&&si(e,r,a,!0),n&&n.forEach(o=>si(e,o,a,!0));for(const o in t)if(!(s&&o==="expose")){const u=xm[o]||a&&a[o];e[o]=u?u(e[o],t[o]):t[o]}return e}const xm={data:sc,props:Fs,emits:Fs,methods:Fs,computed:Fs,beforeCreate:Jt,created:Jt,beforeMount:Jt,mounted:Jt,beforeUpdate:Jt,updated:Jt,beforeDestroy:Jt,beforeUnmount:Jt,destroyed:Jt,unmounted:Jt,activated:Jt,deactivated:Jt,errorCaptured:Jt,serverPrefetch:Jt,components:Fs,directives:Fs,watch:Im,provide:sc,inject:Om};function sc(e,t){return t?e?function(){return ga(ot(e)?e.call(this,this):e,ot(t)?t.call(this,this):t)}:t:e}function Om(e,t){return Fs(Ro(e),Ro(t))}function Ro(e){if(dt(e)){const t={};for(let a=0;a<e.length;a++)t[e[a]]=e[a];return t}return e}function Jt(e,t){return e?[...new Set([].concat(e,t))]:t}function Fs(e,t){return e?ga(ga(Object.create(null),e),t):t}function Im(e,t){if(!e)return t;if(!t)return e;const a=ga(Object.create(null),e);for(const s in t)a[s]=Jt(e[s],t[s]);return a}function Cm(e,t,a,s=!1){const n={},r={};Mo(r,wi,1),e.propsDefaults=Object.create(null),o0(e,t,n,r);for(const o in e.propsOptions[0])o in n||(n[o]=void 0);a?e.props=s?n:Nd(n):e.type.props?e.props=n:e.props=r,e.attrs=r}function Bm(e,t,a,s){const{props:n,attrs:r,vnode:{patchFlag:o}}=e,u=pt(n),[b]=e.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const p=e.vnode.dynamicProps;for(let c=0;c<p.length;c++){let E=p[c];if(pi(e.emitsOptions,E))continue;const A=t[E];if(b)if(_t(r,E))A!==r[E]&&(r[E]=A,l=!0);else{const i=Ga(E);n[i]=xo(b,u,i,A,e,!1)}else A!==r[E]&&(r[E]=A,l=!0)}}}else{o0(e,t,n,r)&&(l=!0);let p;for(const c in u)(!t||!_t(t,c)&&((p=hi(c))===c||!_t(t,p)))&&(b?a&&(a[c]!==void 0||a[p]!==void 0)&&(n[c]=xo(b,u,c,void 0,e,!0)):delete n[c]);if(r!==u)for(const c in r)(!t||!_t(t,c))&&(delete r[c],l=!0)}l&&es(e,"set","$attrs")}function o0(e,t,a,s){const[n,r]=e.propsOptions;let o=!1,u;if(t)for(let b in t){if(Gn(b))continue;const l=t[b];let p;n&&_t(n,p=Ga(b))?!r||!r.includes(p)?a[p]=l:(u||(u={}))[p]=l:pi(e.emitsOptions,b)||(!(b in s)||l!==s[b])&&(s[b]=l,o=!0)}if(r){const b=pt(a),l=u||kt;for(let p=0;p<r.length;p++){const c=r[p];a[c]=xo(n,b,c,l[c],e,!_t(l,c))}}return o}function xo(e,t,a,s,n,r){const o=e[a];if(o!=null){const u=_t(o,"default");if(u&&s===void 0){const b=o.default;if(o.type!==Function&&ot(b)){const{propsDefaults:l}=n;a in l?s=l[a]:(fr(n),s=l[a]=b.call(null,t),Ys())}else s=b}o[0]&&(r&&!u?s=!1:o[1]&&(s===""||s===hi(a))&&(s=!0))}return s}function l0(e,t,a=!1){const s=t.propsCache,n=s.get(e);if(n)return n;const r=e.props,o={},u=[];let b=!1;if(!ot(e)){const p=c=>{b=!0;const[E,A]=l0(c,t,!0);ga(o,E),A&&u.push(...A)};!a&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!r&&!b)return s.set(e,cr),cr;if(dt(r))for(let p=0;p<r.length;p++){const c=Ga(r[p]);rc(c)&&(o[c]=kt)}else if(r)for(const p in r){const c=Ga(p);if(rc(c)){const E=r[p],A=o[c]=dt(E)||ot(E)?{type:E}:E;if(A){const i=oc(Boolean,A.type),F=oc(String,A.type);A[0]=i>-1,A[1]=F<0||i<F,(i>-1||_t(A,"default"))&&u.push(c)}}}const l=[o,u];return s.set(e,l),l}function rc(e){return e[0]!=="$"}function nc(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function ic(e,t){return nc(e)===nc(t)}function oc(e,t){return dt(t)?t.findIndex(a=>ic(a,e)):ot(t)&&ic(t,e)?0:-1}const c0=e=>e[0]==="_"||e==="$stable",dl=e=>dt(e)?e.map(Va):[Va(e)],Lm=(e,t,a)=>{if(t._n)return t;const s=Ze((...n)=>dl(t(...n)),a);return s._c=!1,s},u0=(e,t,a)=>{const s=e._ctx;for(const n in e){if(c0(n))continue;const r=e[n];if(ot(r))t[n]=Lm(n,r,s);else if(r!=null){const o=dl(r);t[n]=()=>o}}},d0=(e,t)=>{const a=dl(t);e.slots.default=()=>a},Nm=(e,t)=>{if(e.vnode.shapeFlag&32){const a=t._;a?(e.slots=pt(t),Mo(t,"_",a)):u0(t,e.slots={})}else e.slots={},t&&d0(e,t);Mo(e.slots,wi,1)},jm=(e,t,a)=>{const{vnode:s,slots:n}=e;let r=!0,o=kt;if(s.shapeFlag&32){const u=t._;u?a&&u===1?r=!1:(ga(n,t),!a&&u===1&&delete n._):(r=!t.$stable,u0(t,n)),o=t}else t&&(d0(e,t),o={default:1});if(r)for(const u in n)!c0(u)&&!(u in o)&&delete n[u]};function m0(){return{app:null,config:{isNativeTag:Xd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fm=0;function Hm(e,t){return function(s,n=null){ot(s)||(s=Object.assign({},s)),n!=null&&!aa(n)&&(n=null);const r=m0(),o=new Set;let u=!1;const b=r.app={_uid:Fm++,_component:s,_props:n,_container:null,_context:r,_instance:null,version:af,get config(){return r.config},set config(l){},use(l,...p){return o.has(l)||(l&&ot(l.install)?(o.add(l),l.install(b,...p)):ot(l)&&(o.add(l),l(b,...p))),b},mixin(l){return r.mixins.includes(l)||r.mixins.push(l),b},component(l,p){return p?(r.components[l]=p,b):r.components[l]},directive(l,p){return p?(r.directives[l]=p,b):r.directives[l]},mount(l,p,c){if(!u){const E=Fe(s,n);return E.appContext=r,p&&t?t(E,l):e(E,l,c),u=!0,b._container=l,l.__vue_app__=b,Si(E.component)||E.component.proxy}},unmount(){u&&(e(null,b._container),delete b._container.__vue_app__)},provide(l,p){return r.provides[l]=p,b}};return b}}function Oo(e,t,a,s,n=!1){if(dt(e)){e.forEach((E,A)=>Oo(E,t&&(dt(t)?t[A]:t),a,s,n));return}if(Yr(s)&&!n)return;const r=s.shapeFlag&4?Si(s.component)||s.component.proxy:s.el,o=n?null:r,{i:u,r:b}=e,l=t&&t.r,p=u.refs===kt?u.refs={}:u.refs,c=u.setupState;if(l!=null&&l!==b&&(ta(l)?(p[l]=null,_t(c,l)&&(c[l]=null)):ea(l)&&(l.value=null)),ot(b))ps(b,u,12,[o,p]);else{const E=ta(b),A=ea(b);if(E||A){const i=()=>{if(e.f){const F=E?p[b]:b.value;n?dt(F)&&rl(F,r):dt(F)?F.includes(r)||F.push(r):E?(p[b]=[r],_t(c,b)&&(c[b]=p[b])):(b.value=[r],e.k&&(p[e.k]=b.value))}else E?(p[b]=o,_t(c,b)&&(c[b]=o)):A&&(b.value=o,e.k&&(p[e.k]=o))};o?(i.id=-1,ca(i,a)):i()}}}const ca=um;function Pm(e){return Um(e)}function Um(e,t){const a=$d();a.__VUE__=!0;const{insert:s,remove:n,patchProp:r,createElement:o,createText:u,createComment:b,setText:l,setElementText:p,parentNode:c,nextSibling:E,setScopeId:A=$a,cloneNode:i,insertStaticContent:F}=e,L=(U,Y,te,de=null,me=null,Ee=null,xe=!1,be=null,ke=!!Y.dynamicChildren)=>{if(U===Y)return;U&&!Ps(U,Y)&&(de=Ve(U),$(U,me,Ee,!0),U=null),Y.patchFlag===-2&&(ke=!1,Y.dynamicChildren=null);const{type:pe,ref:De,shapeFlag:He}=Y;switch(pe){case ml:B(U,Y,te,de);break;case ka:f(U,Y,te,de);break;case Ji:U==null&&R(Y,te,de,xe);break;case ft:v(U,Y,te,de,me,Ee,xe,be,ke);break;default:He&1?N(U,Y,te,de,me,Ee,xe,be,ke):He&6?y(U,Y,te,de,me,Ee,xe,be,ke):(He&64||He&128)&&pe.process(U,Y,te,de,me,Ee,xe,be,ke,he)}De!=null&&me&&Oo(De,U&&U.ref,Ee,Y||U,!Y)},B=(U,Y,te,de)=>{if(U==null)s(Y.el=u(Y.children),te,de);else{const me=Y.el=U.el;Y.children!==U.children&&l(me,Y.children)}},f=(U,Y,te,de)=>{U==null?s(Y.el=b(Y.children||""),te,de):Y.el=U.el},R=(U,Y,te,de)=>{[U.el,U.anchor]=F(U.children,Y,te,de,U.el,U.anchor)},C=({el:U,anchor:Y},te,de)=>{let me;for(;U&&U!==Y;)me=E(U),s(U,te,de),U=me;s(Y,te,de)},T=({el:U,anchor:Y})=>{let te;for(;U&&U!==Y;)te=E(U),n(U),U=te;n(Y)},N=(U,Y,te,de,me,Ee,xe,be,ke)=>{xe=xe||Y.type==="svg",U==null?m(Y,te,de,me,Ee,xe,be,ke):h(U,Y,me,Ee,xe,be,ke)},m=(U,Y,te,de,me,Ee,xe,be)=>{let ke,pe;const{type:De,props:He,shapeFlag:fe,transition:ae,patchFlag:ve,dirs:se}=U;if(U.el&&i!==void 0&&ve===-1)ke=U.el=i(U.el);else{if(ke=U.el=o(U.type,Ee,He&&He.is,He),fe&8?p(ke,U.children):fe&16&&S(U.children,ke,null,de,me,Ee&&De!=="foreignObject",xe,be),se&&Ts(U,null,de,"created"),He){for(const Q in He)Q!=="value"&&!Gn(Q)&&r(ke,Q,null,He[Q],Ee,U.children,de,me,ge);"value"in He&&r(ke,"value",null,He.value),(pe=He.onVnodeBeforeMount)&&Fa(pe,de,U)}k(ke,U,U.scopeId,xe,de)}se&&Ts(U,null,de,"beforeMount");const le=(!me||me&&!me.pendingBranch)&&ae&&!ae.persisted;le&&ae.beforeEnter(ke),s(ke,Y,te),((pe=He&&He.onVnodeMounted)||le||se)&&ca(()=>{pe&&Fa(pe,de,U),le&&ae.enter(ke),se&&Ts(U,null,de,"mounted")},me)},k=(U,Y,te,de,me)=>{if(te&&A(U,te),de)for(let Ee=0;Ee<de.length;Ee++)A(U,de[Ee]);if(me){let Ee=me.subTree;if(Y===Ee){const xe=me.vnode;k(U,xe,xe.scopeId,xe.slotScopeIds,me.parent)}}},S=(U,Y,te,de,me,Ee,xe,be,ke=0)=>{for(let pe=ke;pe<U.length;pe++){const De=U[pe]=be?hs(U[pe]):Va(U[pe]);L(null,De,Y,te,de,me,Ee,xe,be)}},h=(U,Y,te,de,me,Ee,xe)=>{const be=Y.el=U.el;let{patchFlag:ke,dynamicChildren:pe,dirs:De}=Y;ke|=U.patchFlag&16;const He=U.props||kt,fe=Y.props||kt;let ae;te&&Rs(te,!1),(ae=fe.onVnodeBeforeUpdate)&&Fa(ae,te,Y,U),De&&Ts(Y,U,te,"beforeUpdate"),te&&Rs(te,!0);const ve=me&&Y.type!=="foreignObject";if(pe?g(U.dynamicChildren,pe,be,te,de,ve,Ee):xe||z(U,Y,be,null,te,de,ve,Ee,!1),ke>0){if(ke&16)_(be,Y,He,fe,te,de,me);else if(ke&2&&He.class!==fe.class&&r(be,"class",null,fe.class,me),ke&4&&r(be,"style",He.style,fe.style,me),ke&8){const se=Y.dynamicProps;for(let le=0;le<se.length;le++){const Q=se[le],Oe=He[Q],x=fe[Q];(x!==Oe||Q==="value")&&r(be,Q,Oe,x,me,U.children,te,de,ge)}}ke&1&&U.children!==Y.children&&p(be,Y.children)}else!xe&&pe==null&&_(be,Y,He,fe,te,de,me);((ae=fe.onVnodeUpdated)||De)&&ca(()=>{ae&&Fa(ae,te,Y,U),De&&Ts(Y,U,te,"updated")},de)},g=(U,Y,te,de,me,Ee,xe)=>{for(let be=0;be<Y.length;be++){const ke=U[be],pe=Y[be],De=ke.el&&(ke.type===ft||!Ps(ke,pe)||ke.shapeFlag&70)?c(ke.el):te;L(ke,pe,De,null,de,me,Ee,xe,!0)}},_=(U,Y,te,de,me,Ee,xe)=>{if(te!==de){for(const be in de){if(Gn(be))continue;const ke=de[be],pe=te[be];ke!==pe&&be!=="value"&&r(U,be,pe,ke,xe,Y.children,me,Ee,ge)}if(te!==kt)for(const be in te)!Gn(be)&&!(be in de)&&r(U,be,te[be],null,xe,Y.children,me,Ee,ge);"value"in de&&r(U,"value",te.value,de.value)}},v=(U,Y,te,de,me,Ee,xe,be,ke)=>{const pe=Y.el=U?U.el:u(""),De=Y.anchor=U?U.anchor:u("");let{patchFlag:He,dynamicChildren:fe,slotScopeIds:ae}=Y;ae&&(be=be?be.concat(ae):ae),U==null?(s(pe,te,de),s(De,te,de),S(Y.children,te,De,me,Ee,xe,be,ke)):He>0&&He&64&&fe&&U.dynamicChildren?(g(U.dynamicChildren,fe,te,me,Ee,xe,be),(Y.key!=null||me&&Y===me.subTree)&&f0(U,Y,!0)):z(U,Y,te,De,me,Ee,xe,be,ke)},y=(U,Y,te,de,me,Ee,xe,be,ke)=>{Y.slotScopeIds=be,U==null?Y.shapeFlag&512?me.ctx.activate(Y,te,de,xe,ke):w(Y,te,de,me,Ee,xe,ke):j(U,Y,ke)},w=(U,Y,te,de,me,Ee,xe)=>{const be=U.component=Km(U,de,me);if(gi(U)&&(be.ctx.renderer=he),Gm(be),be.asyncDep){if(me&&me.registerDep(be,K),!U.el){const ke=be.subTree=Fe(ka);f(null,ke,Y,te)}return}K(be,U,Y,te,me,Ee,xe)},j=(U,Y,te)=>{const de=Y.component=U.component;if(om(U,Y,te))if(de.asyncDep&&!de.asyncResolved){P(de,Y,te);return}else de.next=Y,tm(de.update),de.update();else Y.el=U.el,de.vnode=Y},K=(U,Y,te,de,me,Ee,xe)=>{const be=()=>{if(U.isMounted){let{next:De,bu:He,u:fe,parent:ae,vnode:ve}=U,se=De,le;Rs(U,!1),De?(De.el=ve.el,P(U,De,xe)):De=ve,He&&Gi(He),(le=De.props&&De.props.onVnodeBeforeUpdate)&&Fa(le,ae,De,ve),Rs(U,!0);const Q=Zi(U),Oe=U.subTree;U.subTree=Q,L(Oe,Q,c(Oe.el),Ve(Oe),U,me,Ee),De.el=Q.el,se===null&&lm(U,Q.el),fe&&ca(fe,me),(le=De.props&&De.props.onVnodeUpdated)&&ca(()=>Fa(le,ae,De,ve),me)}else{let De;const{el:He,props:fe}=Y,{bm:ae,m:ve,parent:se}=U,le=Yr(Y);if(Rs(U,!1),ae&&Gi(ae),!le&&(De=fe&&fe.onVnodeBeforeMount)&&Fa(De,se,Y),Rs(U,!0),He&&it){const Q=()=>{U.subTree=Zi(U),it(He,U.subTree,U,me,null)};le?Y.type.__asyncLoader().then(()=>!U.isUnmounted&&Q()):Q()}else{const Q=U.subTree=Zi(U);L(null,Q,te,de,U,me,Ee),Y.el=Q.el}if(ve&&ca(ve,me),!le&&(De=fe&&fe.onVnodeMounted)){const Q=Y;ca(()=>Fa(De,se,Q),me)}(Y.shapeFlag&256||se&&Yr(se.vnode)&&se.vnode.shapeFlag&256)&&U.a&&ca(U.a,me),U.isMounted=!0,Y=te=de=null}},ke=U.effect=new Zo(be,()=>U1(pe),U.scope),pe=U.update=()=>ke.run();pe.id=U.uid,Rs(U,!0),pe()},P=(U,Y,te)=>{Y.component=U;const de=U.vnode.props;U.vnode=Y,U.next=null,Bm(U,Y.props,de,te),jm(U,Y.children,te),gr(),_i(void 0,U.update),br()},z=(U,Y,te,de,me,Ee,xe,be,ke=!1)=>{const pe=U&&U.children,De=U?U.shapeFlag:0,He=Y.children,{patchFlag:fe,shapeFlag:ae}=Y;if(fe>0){if(fe&128){M(pe,He,te,de,me,Ee,xe,be,ke);return}else if(fe&256){d(pe,He,te,de,me,Ee,xe,be,ke);return}}ae&8?(De&16&&ge(pe,me,Ee),He!==pe&&p(te,He)):De&16?ae&16?M(pe,He,te,de,me,Ee,xe,be,ke):ge(pe,me,Ee,!0):(De&8&&p(te,""),ae&16&&S(He,te,de,me,Ee,xe,be,ke))},d=(U,Y,te,de,me,Ee,xe,be,ke)=>{U=U||cr,Y=Y||cr;const pe=U.length,De=Y.length,He=Math.min(pe,De);let fe;for(fe=0;fe<He;fe++){const ae=Y[fe]=ke?hs(Y[fe]):Va(Y[fe]);L(U[fe],ae,te,null,me,Ee,xe,be,ke)}pe>De?ge(U,me,Ee,!0,!1,He):S(Y,te,de,me,Ee,xe,be,ke,He)},M=(U,Y,te,de,me,Ee,xe,be,ke)=>{let pe=0;const De=Y.length;let He=U.length-1,fe=De-1;for(;pe<=He&&pe<=fe;){const ae=U[pe],ve=Y[pe]=ke?hs(Y[pe]):Va(Y[pe]);if(Ps(ae,ve))L(ae,ve,te,null,me,Ee,xe,be,ke);else break;pe++}for(;pe<=He&&pe<=fe;){const ae=U[He],ve=Y[fe]=ke?hs(Y[fe]):Va(Y[fe]);if(Ps(ae,ve))L(ae,ve,te,null,me,Ee,xe,be,ke);else break;He--,fe--}if(pe>He){if(pe<=fe){const ae=fe+1,ve=ae<De?Y[ae].el:de;for(;pe<=fe;)L(null,Y[pe]=ke?hs(Y[pe]):Va(Y[pe]),te,ve,me,Ee,xe,be,ke),pe++}}else if(pe>fe)for(;pe<=He;)$(U[pe],me,Ee,!0),pe++;else{const ae=pe,ve=pe,se=new Map;for(pe=ve;pe<=fe;pe++){const X=Y[pe]=ke?hs(Y[pe]):Va(Y[pe]);X.key!=null&&se.set(X.key,pe)}let le,Q=0;const Oe=fe-ve+1;let x=!1,I=0;const D=new Array(Oe);for(pe=0;pe<Oe;pe++)D[pe]=0;for(pe=ae;pe<=He;pe++){const X=U[pe];if(Q>=Oe){$(X,me,Ee,!0);continue}let H;if(X.key!=null)H=se.get(X.key);else for(le=ve;le<=fe;le++)if(D[le-ve]===0&&Ps(X,Y[le])){H=le;break}H===void 0?$(X,me,Ee,!0):(D[H-ve]=pe+1,H>=I?I=H:x=!0,L(X,Y[H],te,null,me,Ee,xe,be,ke),Q++)}const V=x?Dm(D):cr;for(le=V.length-1,pe=Oe-1;pe>=0;pe--){const X=ve+pe,H=Y[X],Z=X+1<De?Y[X+1].el:de;D[pe]===0?L(null,H,te,Z,me,Ee,xe,be,ke):x&&(le<0||pe!==V[le]?W(H,te,Z,2):le--)}}},W=(U,Y,te,de,me=null)=>{const{el:Ee,type:xe,transition:be,children:ke,shapeFlag:pe}=U;if(pe&6){W(U.component.subTree,Y,te,de);return}if(pe&128){U.suspense.move(Y,te,de);return}if(pe&64){xe.move(U,Y,te,he);return}if(xe===ft){s(Ee,Y,te);for(let He=0;He<ke.length;He++)W(ke[He],Y,te,de);s(U.anchor,Y,te);return}if(xe===Ji){C(U,Y,te);return}if(de!==2&&pe&1&&be)if(de===0)be.beforeEnter(Ee),s(Ee,Y,te),ca(()=>be.enter(Ee),me);else{const{leave:He,delayLeave:fe,afterLeave:ae}=be,ve=()=>s(Ee,Y,te),se=()=>{He(Ee,()=>{ve(),ae&&ae()})};fe?fe(Ee,ve,se):se()}else s(Ee,Y,te)},$=(U,Y,te,de=!1,me=!1)=>{const{type:Ee,props:xe,ref:be,children:ke,dynamicChildren:pe,shapeFlag:De,patchFlag:He,dirs:fe}=U;if(be!=null&&Oo(be,null,te,U,!0),De&256){Y.ctx.deactivate(U);return}const ae=De&1&&fe,ve=!Yr(U);let se;if(ve&&(se=xe&&xe.onVnodeBeforeUnmount)&&Fa(se,Y,U),De&6)Re(U.component,te,de);else{if(De&128){U.suspense.unmount(te,de);return}ae&&Ts(U,null,Y,"beforeUnmount"),De&64?U.type.remove(U,Y,te,me,he,de):pe&&(Ee!==ft||He>0&&He&64)?ge(pe,Y,te,!1,!0):(Ee===ft&&He&384||!me&&De&16)&&ge(ke,Y,te),de&&_e(U)}(ve&&(se=xe&&xe.onVnodeUnmounted)||ae)&&ca(()=>{se&&Fa(se,Y,U),ae&&Ts(U,null,Y,"unmounted")},te)},_e=U=>{const{type:Y,el:te,anchor:de,transition:me}=U;if(Y===ft){Ae(te,de);return}if(Y===Ji){T(U);return}const Ee=()=>{n(te),me&&!me.persisted&&me.afterLeave&&me.afterLeave()};if(U.shapeFlag&1&&me&&!me.persisted){const{leave:xe,delayLeave:be}=me,ke=()=>xe(te,Ee);be?be(U.el,Ee,ke):ke()}else Ee()},Ae=(U,Y)=>{let te;for(;U!==Y;)te=E(U),n(U),U=te;n(Y)},Re=(U,Y,te)=>{const{bum:de,scope:me,update:Ee,subTree:xe,um:be}=U;de&&Gi(de),me.stop(),Ee&&(Ee.active=!1,$(xe,U,Y,te)),be&&ca(be,Y),ca(()=>{U.isUnmounted=!0},Y),Y&&Y.pendingBranch&&!Y.isUnmounted&&U.asyncDep&&!U.asyncResolved&&U.suspenseId===Y.pendingId&&(Y.deps--,Y.deps===0&&Y.resolve())},ge=(U,Y,te,de=!1,me=!1,Ee=0)=>{for(let xe=Ee;xe<U.length;xe++)$(U[xe],Y,te,de,me)},Ve=U=>U.shapeFlag&6?Ve(U.component.subTree):U.shapeFlag&128?U.suspense.next():E(U.anchor||U.el),Ne=(U,Y,te)=>{U==null?Y._vnode&&$(Y._vnode,null,null,!0):L(Y._vnode||null,U,Y,null,null,null,te),q1(),Y._vnode=U},he={p:L,um:$,m:W,r:_e,mt:w,mc:S,pc:z,pbc:g,n:Ve,o:e};let Ke,it;return t&&([Ke,it]=t(he)),{render:Ne,hydrate:Ke,createApp:Hm(Ne,Ke)}}function Rs({effect:e,update:t},a){e.allowRecurse=t.allowRecurse=a}function f0(e,t,a=!1){const s=e.children,n=t.children;if(dt(s)&&dt(n))for(let r=0;r<s.length;r++){const o=s[r];let u=n[r];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=n[r]=hs(n[r]),u.el=o.el),a||f0(o,u))}}function Dm(e){const t=e.slice(),a=[0];let s,n,r,o,u;const b=e.length;for(s=0;s<b;s++){const l=e[s];if(l!==0){if(n=a[a.length-1],e[n]<l){t[s]=n,a.push(s);continue}for(r=0,o=a.length-1;r<o;)u=r+o>>1,e[a[u]]<l?r=u+1:o=u;l<e[a[r]]&&(r>0&&(t[s]=a[r-1]),a[r]=s)}}for(r=a.length,o=a[r-1];r-- >0;)a[r]=o,o=t[o];return a}const Vm=e=>e.__isTeleport,ft=Symbol(void 0),ml=Symbol(void 0),ka=Symbol(void 0),Ji=Symbol(void 0),Xr=[];let Ba=null;function ee(e=!1){Xr.push(Ba=e?null:[])}function qm(){Xr.pop(),Ba=Xr[Xr.length-1]||null}let Jr=1;function lc(e){Jr+=e}function h0(e){return e.dynamicChildren=Jr>0?Ba||cr:null,qm(),Jr>0&&Ba&&Ba.push(e),e}function ue(e,t,a,s,n,r){return h0(Me(e,t,a,s,n,r,!0))}function gt(e,t,a,s,n){return h0(Fe(e,t,a,s,n,!0))}function ri(e){return e?e.__v_isVNode===!0:!1}function Ps(e,t){return e.type===t.type&&e.key===t.key}const wi="__vInternal",v0=({key:e})=>e??null,Zn=({ref:e,ref_key:t,ref_for:a})=>e!=null?ta(e)||ea(e)||ot(e)?{i:Zt,r:e,k:t,f:!!a}:e:null;function Me(e,t=null,a=null,s=0,n=null,r=e===ft?0:1,o=!1,u=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&v0(t),ref:t&&Zn(t),scopeId:X1,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null};return u?(fl(b,a),r&128&&e.normalize(b)):a&&(b.shapeFlag|=ta(a)?8:16),Jr>0&&!o&&Ba&&(b.patchFlag>0||r&6)&&b.patchFlag!==32&&Ba.push(b),b}const Fe=zm;function zm(e,t=null,a=null,s=0,n=null,r=!1){if((!e||e===s0)&&(e=ka),ri(e)){const u=ws(e,t,!0);return a&&fl(u,a),Jr>0&&!r&&Ba&&(u.shapeFlag&6?Ba[Ba.indexOf(e)]=u:Ba.push(u)),u.patchFlag|=-2,u}if(Jm(e)&&(e=e.__vccOpts),t){t=bt(t);let{class:u,style:b}=t;u&&!ta(u)&&(t.class=rt(u)),aa(b)&&(R1(b)&&!dt(b)&&(b=ga({},b)),t.style=Ot(b))}const o=ta(e)?1:cm(e)?128:Vm(e)?64:aa(e)?4:ot(e)?2:0;return Me(e,t,a,s,n,o,r,!0)}function bt(e){return e?R1(e)||wi in e?ga({},e):e:null}function ws(e,t,a=!1){const{props:s,ref:n,patchFlag:r,children:o}=e,u=t?hl(s||{},t):s;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&v0(u),ref:t&&t.ref?a&&n?dt(n)?n.concat(Zn(t)):[n,Zn(t)]:Zn(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ft?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ws(e.ssContent),ssFallback:e.ssFallback&&ws(e.ssFallback),el:e.el,anchor:e.anchor}}function Ss(e=" ",t=0){return Fe(ml,null,e,t)}function Ce(e="",t=!1){return t?(ee(),gt(ka,null,e)):Fe(ka,null,e)}function Va(e){return e==null||typeof e=="boolean"?Fe(ka):dt(e)?Fe(ft,null,e.slice()):typeof e=="object"?hs(e):Fe(ml,null,String(e))}function hs(e){return e.el===null||e.memo?e:ws(e)}function fl(e,t){let a=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(dt(t))a=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),fl(e,n()),n._c&&(n._d=!0));return}else{a=32;const n=t._;!n&&!(wi in t)?t._ctx=Zt:n===3&&Zt&&(Zt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ot(t)?(t={default:t,_ctx:Zt},a=32):(t=String(t),s&64?(a=16,t=[Ss(t)]):a=8);e.children=t,e.shapeFlag|=a}function hl(...e){const t={};for(let a=0;a<e.length;a++){const s=e[a];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=rt([t.class,s.class]));else if(n==="style")t.style=Ot([t.style,s.style]);else if(sl(n)){const r=t[n],o=s[n];o&&r!==o&&!(dt(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=s[n])}return t}function Fa(e,t,a,s=null){Aa(e,t,7,[a,s])}const Ym=m0();let Xm=0;function Km(e,t,a){const s=e.type,n=(t?t.appContext:e.appContext)||Ym,r={uid:Xm++,vnode:e,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new ld(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:l0(s,n),emitsOptions:Y1(s,n),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:s.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=rm.bind(null,r),e.ce&&e.ce(r),r}let qt=null;const _0=()=>qt||Zt,fr=e=>{qt=e,e.scope.on()},Ys=()=>{qt&&qt.scope.off(),qt=null};function p0(e){return e.vnode.shapeFlag&4}let en=!1;function Gm(e,t=!1){en=t;const{props:a,children:s}=e.vnode,n=p0(e);Cm(e,a,n,t),Nm(e,s);const r=n?Zm(e,t):void 0;return en=!1,r}function Zm(e,t){const a=e.type;e.accessCache=Object.create(null),e.proxy=x1(new Proxy(e.ctx,km));const{setup:s}=a;if(s){const n=e.setupContext=s.length>1?Qm(e):null;fr(e),gr();const r=ps(s,e,0,[e.props,n]);if(br(),Ys(),N1(r)){if(r.then(Ys,Ys),t)return r.then(o=>{cc(e,o,t)}).catch(o=>{vi(o,e,0)});e.asyncDep=r}else cc(e,r,t)}else g0(e,t)}function cc(e,t,a){ot(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:aa(t)&&(e.setupState=O1(t)),g0(e,a)}let uc;function g0(e,t,a){const s=e.type;if(!e.render){if(!t&&uc&&!s.render){const n=s.template;if(n){const{isCustomElement:r,compilerOptions:o}=e.appContext.config,{delimiters:u,compilerOptions:b}=s,l=ga(ga({isCustomElement:r,delimiters:u},o),b);s.render=uc(n,l)}}e.render=s.render||$a}fr(e),gr(),Tm(e),br(),Ys()}function Wm(e){return new Proxy(e.attrs,{get(t,a){return pa(e,"get","$attrs"),t[a]}})}function Qm(e){const t=s=>{e.exposed=s||{}};let a;return{get attrs(){return a||(a=Wm(e))},slots:e.slots,emit:e.emit,expose:t}}function Si(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(O1(x1(e.exposed)),{get(t,a){if(a in t)return t[a];if(a in ai)return ai[a](e)}}))}function $m(e,t=!0){return ot(e)?e.displayName||e.name:e.name||t&&e.__name}function Jm(e){return ot(e)&&"__vccOpts"in e}const ef=(e,t)=>Dd(e,t,en);function tf(e,t,a){const s=arguments.length;return s===2?aa(t)&&!dt(t)?ri(t)?Fe(e,null,[t]):Fe(e,t):Fe(e,null,t):(s>3?a=Array.prototype.slice.call(arguments,2):s===3&&ri(a)&&(a=[a]),Fe(e,t,a))}const af="3.2.37";function sf(e,t){const a=Object.create(null),s=e.split(",");for(let n=0;n<s.length;n++)a[s[n]]=!0;return t?n=>!!a[n.toLowerCase()]:n=>!!a[n]}const rf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",nf=sf(rf);function b0(e){return!!e||e===""}const of=/^on[^a-z]/,lf=e=>of.test(e),cf=e=>e.startsWith("onUpdate:"),mn=Object.assign,fn=Array.isArray,uf=e=>typeof e=="function",Io=e=>typeof e=="string",df=e=>e!==null&&typeof e=="object",vl=e=>{const t=Object.create(null);return a=>t[a]||(t[a]=e(a))},mf=/-(\w)/g,dc=vl(e=>e.replace(mf,(t,a)=>a?a.toUpperCase():"")),ff=/\B([A-Z])/g,ur=vl(e=>e.replace(ff,"-$1").toLowerCase()),hf=vl(e=>e.charAt(0).toUpperCase()+e.slice(1)),Co=e=>{const t=parseFloat(e);return isNaN(t)?e:t},vf="http://www.w3.org/2000/svg",Us=typeof document<"u"?document:null,mc=Us&&Us.createElement("template"),_f={insert:(e,t,a)=>{t.insertBefore(e,a||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,a,s)=>{const n=t?Us.createElementNS(vf,e):Us.createElement(e,a?{is:a}:void 0);return e==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:e=>Us.createTextNode(e),createComment:e=>Us.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Us.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,a,s,n,r){const o=a?a.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),a),!(n===r||!(n=n.nextSibling)););else{mc.innerHTML=s?`<svg>${e}</svg>`:e;const u=mc.content;if(s){const b=u.firstChild;for(;b.firstChild;)u.appendChild(b.firstChild);u.removeChild(b)}t.insertBefore(u,a)}return[o?o.nextSibling:t.firstChild,a?a.previousSibling:t.lastChild]}};function pf(e,t,a){const s=e._vtc;s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):a?e.setAttribute("class",t):e.className=t}function gf(e,t,a){const s=e.style,n=Io(a);if(a&&!n){for(const r in a)Bo(s,r,a[r]);if(t&&!Io(t))for(const r in t)a[r]==null&&Bo(s,r,"")}else{const r=s.display;n?t!==a&&(s.cssText=a):t&&e.removeAttribute("style"),"_vod"in e&&(s.display=r)}}const fc=/\s*!important$/;function Bo(e,t,a){if(fn(a))a.forEach(s=>Bo(e,t,s));else if(a==null&&(a=""),t.startsWith("--"))e.setProperty(t,a);else{const s=bf(e,t);fc.test(a)?e.setProperty(ur(s),a.replace(fc,""),"important"):e[s]=a}}const hc=["Webkit","Moz","ms"],eo={};function bf(e,t){const a=eo[t];if(a)return a;let s=Ga(t);if(s!=="filter"&&s in e)return eo[t]=s;s=hf(s);for(let n=0;n<hc.length;n++){const r=hc[n]+s;if(r in e)return eo[t]=r}return t}const vc="http://www.w3.org/1999/xlink";function yf(e,t,a,s,n){if(s&&t.startsWith("xlink:"))a==null?e.removeAttributeNS(vc,t.slice(6,t.length)):e.setAttributeNS(vc,t,a);else{const r=nf(t);a==null||r&&!b0(a)?e.removeAttribute(t):e.setAttribute(t,r?"":a)}}function wf(e,t,a,s,n,r,o){if(t==="innerHTML"||t==="textContent"){s&&o(s,n,r),e[t]=a??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const b=a??"";(e.value!==b||e.tagName==="OPTION")&&(e.value=b),a==null&&e.removeAttribute(t);return}let u=!1;if(a===""||a==null){const b=typeof e[t];b==="boolean"?a=b0(a):a==null&&b==="string"?(a="",u=!0):b==="number"&&(a=0,u=!0)}try{e[t]=a}catch{}u&&e.removeAttribute(t)}const[y0,Sf]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const a=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(a&&Number(a[1])<=53)}return[e,t]})();let Lo=0;const Mf=Promise.resolve(),Ef=()=>{Lo=0},Af=()=>Lo||(Mf.then(Ef),Lo=y0());function kf(e,t,a,s){e.addEventListener(t,a,s)}function Tf(e,t,a,s){e.removeEventListener(t,a,s)}function Rf(e,t,a,s,n=null){const r=e._vei||(e._vei={}),o=r[t];if(s&&o)o.value=s;else{const[u,b]=xf(t);if(s){const l=r[t]=Of(s,n);kf(e,u,l,b)}else o&&(Tf(e,u,o,b),r[t]=void 0)}}const _c=/(?:Once|Passive|Capture)$/;function xf(e){let t;if(_c.test(e)){t={};let a;for(;a=e.match(_c);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[ur(e.slice(2)),t]}function Of(e,t){const a=s=>{const n=s.timeStamp||y0();(Sf||n>=a.attached-1)&&Aa(If(s,a.value),t,5,[s])};return a.value=e,a.attached=Af(),a}function If(e,t){if(fn(t)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const pc=/^on[a-z]/,Cf=(e,t,a,s,n=!1,r,o,u,b)=>{t==="class"?pf(e,s,n):t==="style"?gf(e,a,s):lf(t)?cf(t)||Rf(e,t,a,s,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Bf(e,t,s,n))?wf(e,t,s,r,o,u,b):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),yf(e,t,s,n))};function Bf(e,t,a,s){return s?!!(t==="innerHTML"||t==="textContent"||t in e&&pc.test(t)&&uf(a)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||pc.test(t)&&Io(a)?!1:t in e}function Lf(e,t){const a=hm(e);class s extends _l{constructor(r){super(a,r,t)}}return s.def=a,s}const Nf=typeof HTMLElement<"u"?HTMLElement:class{};class _l extends Nf{constructor(t,a={},s){super(),this._def=t,this._props=a,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,P1(()=>{this._connected||(Ec(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);new MutationObserver(s=>{for(const n of s)this._setAttr(n.attributeName)}).observe(this,{attributes:!0});const t=s=>{const{props:n,styles:r}=s,o=!fn(n),u=n?o?Object.keys(n):n:[];let b;if(o)for(const l in this._props){const p=n[l];(p===Number||p&&p.type===Number)&&(this._props[l]=Co(this._props[l]),(b||(b=Object.create(null)))[l]=!0)}this._numberProps=b;for(const l of Object.keys(this))l[0]!=="_"&&this._setProp(l,this[l],!0,!1);for(const l of u.map(dc))Object.defineProperty(this,l,{get(){return this._getProp(l)},set(p){this._setProp(l,p)}});this._applyStyles(r),this._update()},a=this._def.__asyncLoader;a?a().then(t):t(this._def)}_setAttr(t){let a=this.getAttribute(t);this._numberProps&&this._numberProps[t]&&(a=Co(a)),this._setProp(dc(t),a,!1)}_getProp(t){return this._props[t]}_setProp(t,a,s=!0,n=!0){a!==this._props[t]&&(this._props[t]=a,n&&this._instance&&this._update(),s&&(a===!0?this.setAttribute(ur(t),""):typeof a=="string"||typeof a=="number"?this.setAttribute(ur(t),a+""):a||this.removeAttribute(ur(t))))}_update(){Ec(this._createVNode(),this.shadowRoot)}_createVNode(){const t=Fe(this._def,mn({},this._props));return this._instance||(t.ce=a=>{this._instance=a,a.isCE=!0,a.emit=(n,...r)=>{this.dispatchEvent(new CustomEvent(n,{detail:r}))};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof _l){a.parent=s._instance;break}}),t}_applyStyles(t){t&&t.forEach(a=>{const s=document.createElement("style");s.textContent=a,this.shadowRoot.appendChild(s)})}}const is="transition",xr="animation",Ht=(e,{slots:t})=>tf(W1,S0(e),t);Ht.displayName="Transition";const w0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jf=Ht.props=mn({},W1.props,w0),xs=(e,t=[])=>{fn(e)?e.forEach(a=>a(...t)):e&&e(...t)},gc=e=>e?fn(e)?e.some(t=>t.length>1):e.length>1:!1;function S0(e){const t={};for(const _ in e)_ in w0||(t[_]=e[_]);if(e.css===!1)return t;const{name:a="v",type:s,duration:n,enterFromClass:r=`${a}-enter-from`,enterActiveClass:o=`${a}-enter-active`,enterToClass:u=`${a}-enter-to`,appearFromClass:b=r,appearActiveClass:l=o,appearToClass:p=u,leaveFromClass:c=`${a}-leave-from`,leaveActiveClass:E=`${a}-leave-active`,leaveToClass:A=`${a}-leave-to`}=e,i=Ff(n),F=i&&i[0],L=i&&i[1],{onBeforeEnter:B,onEnter:f,onEnterCancelled:R,onLeave:C,onLeaveCancelled:T,onBeforeAppear:N=B,onAppear:m=f,onAppearCancelled:k=R}=t,S=(_,v,y)=>{fs(_,v?p:u),fs(_,v?l:o),y&&y()},h=(_,v)=>{_._isLeaving=!1,fs(_,c),fs(_,A),fs(_,E),v&&v()},g=_=>(v,y)=>{const w=_?m:f,j=()=>S(v,_,y);xs(w,[v,j]),bc(()=>{fs(v,_?b:r),Wa(v,_?p:u),gc(w)||yc(v,s,F,j)})};return mn(t,{onBeforeEnter(_){xs(B,[_]),Wa(_,r),Wa(_,o)},onBeforeAppear(_){xs(N,[_]),Wa(_,b),Wa(_,l)},onEnter:g(!1),onAppear:g(!0),onLeave(_,v){_._isLeaving=!0;const y=()=>h(_,v);Wa(_,c),E0(),Wa(_,E),bc(()=>{_._isLeaving&&(fs(_,c),Wa(_,A),gc(C)||yc(_,s,L,y))}),xs(C,[_,y])},onEnterCancelled(_){S(_,!1),xs(R,[_])},onAppearCancelled(_){S(_,!0),xs(k,[_])},onLeaveCancelled(_){h(_),xs(T,[_])}})}function Ff(e){if(e==null)return null;if(df(e))return[to(e.enter),to(e.leave)];{const t=to(e);return[t,t]}}function to(e){return Co(e)}function Wa(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(t)}function fs(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const{_vtc:a}=e;a&&(a.delete(t),a.size||(e._vtc=void 0))}function bc(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Hf=0;function yc(e,t,a,s){const n=e._endId=++Hf,r=()=>{n===e._endId&&s()};if(a)return setTimeout(r,a);const{type:o,timeout:u,propCount:b}=M0(e,t);if(!o)return s();const l=o+"end";let p=0;const c=()=>{e.removeEventListener(l,E),r()},E=A=>{A.target===e&&++p>=b&&c()};setTimeout(()=>{p<b&&c()},u+1),e.addEventListener(l,E)}function M0(e,t){const a=window.getComputedStyle(e),s=i=>(a[i]||"").split(", "),n=s(is+"Delay"),r=s(is+"Duration"),o=wc(n,r),u=s(xr+"Delay"),b=s(xr+"Duration"),l=wc(u,b);let p=null,c=0,E=0;t===is?o>0&&(p=is,c=o,E=r.length):t===xr?l>0&&(p=xr,c=l,E=b.length):(c=Math.max(o,l),p=c>0?o>l?is:xr:null,E=p?p===is?r.length:b.length:0);const A=p===is&&/\b(transform|all)(,|$)/.test(a[is+"Property"]);return{type:p,timeout:c,propCount:E,hasTransform:A}}function wc(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((a,s)=>Sc(a)+Sc(e[s])))}function Sc(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function E0(){return document.body.offsetHeight}const A0=new WeakMap,k0=new WeakMap,Pf={name:"TransitionGroup",props:mn({},jf,{tag:String,moveClass:String}),setup(e,{slots:t}){const a=_0(),s=Z1();let n,r;return e0(()=>{if(!n.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!qf(n[0].el,a.vnode.el,o))return;n.forEach(Uf),n.forEach(Df);const u=n.filter(Vf);E0(),u.forEach(b=>{const l=b.el,p=l.style;Wa(l,o),p.transform=p.webkitTransform=p.transitionDuration="";const c=l._moveCb=E=>{E&&E.target!==l||(!E||/transform$/.test(E.propertyName))&&(l.removeEventListener("transitionend",c),l._moveCb=null,fs(l,o))};l.addEventListener("transitionend",c)})}),()=>{const o=pt(e),u=S0(o);let b=o.tag||ft;n=r,r=t.default?ll(t.default()):[];for(let l=0;l<r.length;l++){const p=r[l];p.key!=null&&$r(p,Qr(p,u,s,a))}if(n)for(let l=0;l<n.length;l++){const p=n[l];$r(p,Qr(p,u,s,a)),A0.set(p,p.el.getBoundingClientRect())}return Fe(b,null,r)}}},pl=Pf;function Uf(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Df(e){k0.set(e,e.el.getBoundingClientRect())}function Vf(e){const t=A0.get(e),a=k0.get(e),s=t.left-a.left,n=t.top-a.top;if(s||n){const r=e.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${n}px)`,r.transitionDuration="0s",e}}function qf(e,t,a){const s=e.cloneNode();e._vtc&&e._vtc.forEach(o=>{o.split(/\s+/).forEach(u=>u&&s.classList.remove(u))}),a.split(/\s+/).forEach(o=>o&&s.classList.add(o)),s.style.display="none";const n=t.nodeType===1?t:t.parentNode;n.appendChild(s);const{hasTransform:r}=M0(s);return n.removeChild(s),r}const zf=["ctrl","shift","alt","meta"],Yf={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>zf.some(a=>e[`${a}Key`]&&!t.includes(a))},Ya=(e,t)=>(a,...s)=>{for(let n=0;n<t.length;n++){const r=Yf[t[n]];if(r&&r(a,t))return}return e(a,...s)},Xf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Hs=(e,t)=>a=>{if(!("key"in a))return;const s=ur(a.key);if(t.some(n=>n===s||Xf[n]===s))return e(a)},Mi={beforeMount(e,{value:t},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&t?a.beforeEnter(e):Or(e,t)},mounted(e,{value:t},{transition:a}){a&&t&&a.enter(e)},updated(e,{value:t,oldValue:a},{transition:s}){!t!=!a&&(s?t?(s.beforeEnter(e),Or(e,!0),s.enter(e)):s.leave(e,()=>{Or(e,!1)}):Or(e,t))},beforeUnmount(e,{value:t}){Or(e,t)}};function Or(e,t){e.style.display=t?e._vod:"none"}const Kf=mn({patchProp:Cf},_f);let Mc;function Gf(){return Mc||(Mc=Pm(Kf))}const Ec=(...e)=>{Gf().render(...e)};var Tt=(e,t)=>{const a=e.__vccOpts||e;for(const[s,n]of t)a[s]=n;return a};const Zf={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},Wf=Me("div",{id:"vac-circle"},null,-1),Qf=Me("div",{id:"vac-circle"},null,-1),$f=Me("div",{id:"vac-circle"},null,-1),Jf=Me("div",{id:"vac-circle"},null,-1),eh=Me("div",{id:"vac-circle"},null,-1),th=Me("div",{id:"vac-circle"},null,-1);function ah(e,t,a,s,n,r){return ee(),gt(Ht,{name:"vac-fade-spinner",appear:""},{default:Ze(()=>[a.show?(ee(),ue("div",{key:0,class:rt(["vac-loader-wrapper",{"vac-container-center":!a.infinite,"vac-container-top":a.infinite}])},[a.type==="rooms"?Le(e.$slots,"spinner-icon-rooms",{key:0},()=>[Wf]):Ce("",!0),a.type==="infinite-rooms"?Le(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[Qf]):Ce("",!0),a.type==="message-file"?Le(e.$slots,"spinner-icon-message-file_"+a.messageId,{key:2},()=>[$f]):Ce("",!0),a.type==="room-file"?Le(e.$slots,"spinner-icon-room-file",{key:3},()=>[Jf]):Ce("",!0),a.type==="messages"?Le(e.$slots,"spinner-icon-messages",{key:4},()=>[eh]):Ce("",!0),a.type==="infinite-messages"?Le(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[th]):Ce("",!0)],2)):Ce("",!0)]),_:3})}var Ei=Tt(Zf,[["render",ah]]);const sh={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return e.size==="large"?512:e.size==="medium"?48:24}}},rh=["viewBox"],nh=["id","d"],ih=["id","d"];function oh(e,t,a,s,n,r){return ee(),ue("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${r.size} ${r.size}`},[Me("path",{id:r.svgId,d:n.svgItem[a.name].path},null,8,nh),n.svgItem[a.name].path2?(ee(),ue("path",{key:0,id:r.svgId,d:n.svgItem[a.name].path2},null,8,ih)):Ce("",!0)],8,rh)}var zt=Tt(sh,[["render",oh]]);const lh={name:"RoomsSearch",components:{SvgIcon:zt},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},ch={key:0,class:"vac-icon-search"},uh=["placeholder"];function dh(e,t,a,s,n,r){const o=Ge("svg-icon");return ee(),ue("div",{class:rt({"vac-box-search":r.showSearchBar,"vac-box-empty":!r.showSearchBar})},[a.showSearch?(ee(),ue(ft,{key:0},[!a.loadingRooms&&a.rooms.length?(ee(),ue("div",ch,[Le(e.$slots,"search-icon",{},()=>[Fe(o,{name:"search"})])])):Ce("",!0),!a.loadingRooms&&a.rooms.length?(ee(),ue("input",{key:1,type:"search",placeholder:a.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=u=>e.$emit("search-room",u))},null,40,uh)):Ce("",!0)],64)):Ce("",!0),a.showAddRoom?(ee(),ue("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=u=>e.$emit("add-room"))},[Le(e.$slots,"add-icon",{},()=>[Fe(o,{name:"add"})])])):Ce("",!0)],2)}var mh=Tt(lh,[["render",dh]]),Kt={},yr={};yr.__esModule=!0;yr.inherits=fh;function fh(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Object.create(e.prototype);for(var n in a)s[n]=a[n];return s.constructor=t,t.prototype=s,t}var hn={};hn.__esModule=!0;var hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va={defaultProtocol:"http",events:null,format:Ac,formatHref:Ac,nl2br:!1,tagName:"a",target:_h,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};hn.defaults=va;hn.Options=T0;hn.contains=vh;function T0(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:va.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:va.events,this.format=e.hasOwnProperty("format")?e.format:va.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:va.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:va.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:va.tagName,this.target=e.hasOwnProperty("target")?e.target:va.target,this.validate=e.hasOwnProperty("validate")?e.validate:va.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||va.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||va.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:va.ignoreTags,a=0;a<t.length;a++)this.ignoreTags.push(t[a].toUpperCase())}T0.prototype={resolve:function(t){var a=t.toHref(this.defaultProtocol);return{formatted:this.get("format",t.toString(),t),formattedHref:this.get("formatHref",a,t),tagName:this.get("tagName",a,t),className:this.get("className",a,t),target:this.get("target",a,t),events:this.getObject("events",a,t),attributes:this.getObject("attributes",a,t)}},check:function(t){return this.get("validate",t.toString(),t)},get:function(t,a,s){var n=void 0,r=this[t];if(!r)return r;switch(typeof r>"u"?"undefined":hh(r)){case"function":return r(a,s.type);case"object":return n=r.hasOwnProperty(s.type)?r[s.type]:va[t],typeof n=="function"?n(a,s.type):n}return r},getObject:function(t,a,s){var n=this[t];return typeof n=="function"?n(a,s.type):n}};function vh(e,t){for(var a=0;a<e.length;a++)if(e[a]===t)return!0;return!1}function Ac(e){return e}function _h(e,t){return t==="url"?"_blank":null}var Xa={},Ja={};Ja.__esModule=!0;Ja.stateify=Ja.TokenState=Ja.CharacterState=void 0;var R0=yr;function gl(){return function(e){this.j=[],this.T=e||null}}var bl=gl();bl.prototype={defaultTransition:!1,on:function(t,a){if(t instanceof Array){for(var s=0;s<t.length;s++)this.j.push([t[s],a]);return this}return this.j.push([t,a]),this},next:function(t){for(var a=0;a<this.j.length;a++){var s=this.j[a],n=s[0],r=s[1];if(this.test(t,n))return r}return this.defaultTransition},accepts:function(){return!!this.T},test:function(t,a){return t===a},emit:function(){return this.T}};var No=(0,R0.inherits)(bl,gl(),{test:function(t,a){return t===a||a instanceof RegExp&&a.test(t)}}),ph=(0,R0.inherits)(bl,gl(),{jump:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.next(new t(""));return s===this.defaultTransition?(s=new this.constructor(a),this.on(t,s)):a&&(s.T=a),s},test:function(t,a){return t instanceof a}});function gh(e,t,a,s){for(var n=0,r=e.length,o=t,u=[],b=void 0;n<r&&(b=o.next(e[n]));)o=b,n++;if(n>=r)return[];for(;n<r-1;)b=new No(s),u.push(b),o.on(e[n],b),o=b,n++;return b=new No(a),u.push(b),o.on(e[r-1],b),u}Ja.CharacterState=No;Ja.TokenState=ph;Ja.stateify=gh;var ze={},Ai={};Ai.__esModule=!0;function bh(){return function(e){e&&(this.v=e)}}Ai.createTokenClass=bh;ze.__esModule=!0;ze.AMPERSAND=ze.CLOSEPAREN=ze.CLOSEANGLEBRACKET=ze.CLOSEBRACKET=ze.CLOSEBRACE=ze.OPENPAREN=ze.OPENANGLEBRACKET=ze.OPENBRACKET=ze.OPENBRACE=ze.WS=ze.TLD=ze.SYM=ze.UNDERSCORE=ze.SLASH=ze.MAILTO=ze.PROTOCOL=ze.QUERY=ze.POUND=ze.PLUS=ze.NUM=ze.NL=ze.LOCALHOST=ze.PUNCTUATION=ze.DOT=ze.COLON=ze.AT=ze.DOMAIN=ze.Base=void 0;var x0=Ai,yh=yr,yl=(0,x0.createTokenClass)();yl.prototype={toString:function(){return this.v+""}};function Rt(e){var t=e?{v:e}:{};return(0,yh.inherits)(yl,(0,x0.createTokenClass)(),t)}var wh=Rt(),Sh=Rt("@"),Mh=Rt(":"),Eh=Rt("."),Ah=Rt(),kh=Rt(),Th=Rt(`
`),Rh=Rt(),xh=Rt("+"),Oh=Rt("#"),Ih=Rt(),Ch=Rt("mailto:"),Bh=Rt("?"),Lh=Rt("/"),Nh=Rt("_"),jh=Rt(),Fh=Rt(),Hh=Rt(),Ph=Rt("{"),Uh=Rt("["),Dh=Rt("<"),Vh=Rt("("),qh=Rt("}"),zh=Rt("]"),Yh=Rt(">"),Xh=Rt(")"),Kh=Rt("&");ze.Base=yl;ze.DOMAIN=wh;ze.AT=Sh;ze.COLON=Mh;ze.DOT=Eh;ze.PUNCTUATION=Ah;ze.LOCALHOST=kh;ze.NL=Th;ze.NUM=Rh;ze.PLUS=xh;ze.POUND=Oh;ze.QUERY=Bh;ze.PROTOCOL=Ih;ze.MAILTO=Ch;ze.SLASH=Lh;ze.UNDERSCORE=Nh;ze.SYM=jh;ze.TLD=Fh;ze.WS=Hh;ze.OPENBRACE=Ph;ze.OPENBRACKET=Uh;ze.OPENANGLEBRACKET=Dh;ze.OPENPAREN=Vh;ze.CLOSEBRACE=qh;ze.CLOSEBRACKET=zh;ze.CLOSEANGLEBRACKET=Yh;ze.CLOSEPAREN=Xh;ze.AMPERSAND=Kh;Xa.__esModule=!0;Xa.start=Xa.run=Xa.TOKENS=Xa.State=void 0;var Ms=Ja,nt=ze,Gh=Zh(nt);function Zh(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}var kc="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),wl="0123456789".split(""),ki="0123456789abcdefghijklmnopqrstuvwxyz".split(""),O0=[" ","\f","\r","	","\v"," "," ","᠎"],sa=[],wt=function(t){return new Ms.CharacterState(t)},Ta=wt(),jo=wt(nt.NUM),hr=wt(nt.DOMAIN),tn=wt(),Fo=wt(nt.WS);Ta.on("@",wt(nt.AT)).on(".",wt(nt.DOT)).on("+",wt(nt.PLUS)).on("#",wt(nt.POUND)).on("?",wt(nt.QUERY)).on("/",wt(nt.SLASH)).on("_",wt(nt.UNDERSCORE)).on(":",wt(nt.COLON)).on("{",wt(nt.OPENBRACE)).on("[",wt(nt.OPENBRACKET)).on("<",wt(nt.OPENANGLEBRACKET)).on("(",wt(nt.OPENPAREN)).on("}",wt(nt.CLOSEBRACE)).on("]",wt(nt.CLOSEBRACKET)).on(">",wt(nt.CLOSEANGLEBRACKET)).on(")",wt(nt.CLOSEPAREN)).on("&",wt(nt.AMPERSAND)).on([",",";","!",'"',"'"],wt(nt.PUNCTUATION));Ta.on(`
`,wt(nt.NL)).on(O0,Fo);Fo.on(O0,Fo);for(var ao=0;ao<kc.length;ao++){var Wh=(0,Ms.stateify)(kc[ao],Ta,nt.TLD,nt.DOMAIN);sa.push.apply(sa,Wh)}var I0=(0,Ms.stateify)("file",Ta,nt.DOMAIN,nt.DOMAIN),C0=(0,Ms.stateify)("ftp",Ta,nt.DOMAIN,nt.DOMAIN),B0=(0,Ms.stateify)("http",Ta,nt.DOMAIN,nt.DOMAIN),L0=(0,Ms.stateify)("mailto",Ta,nt.DOMAIN,nt.DOMAIN);sa.push.apply(sa,I0);sa.push.apply(sa,C0);sa.push.apply(sa,B0);sa.push.apply(sa,L0);var Qh=I0.pop(),$h=C0.pop(),Jh=B0.pop(),e2=L0.pop(),Ti=wt(nt.DOMAIN),Ri=wt(nt.PROTOCOL),t2=wt(nt.MAILTO);$h.on("s",Ti).on(":",Ri);Jh.on("s",Ti).on(":",Ri);sa.push(Ti);Qh.on(":",Ri);Ti.on(":",Ri);e2.on(":",t2);var a2=(0,Ms.stateify)("localhost",Ta,nt.LOCALHOST,nt.DOMAIN);sa.push.apply(sa,a2);Ta.on(wl,jo);jo.on("-",tn).on(wl,jo).on(ki,hr);hr.on("-",tn).on(ki,hr);for(var so=0;so<sa.length;so++)sa[so].on("-",tn).on(ki,hr);tn.on("-",tn).on(wl,hr).on(ki,hr);Ta.defaultTransition=wt(nt.SYM);var s2=function(t){for(var a=t.replace(/[A-Z]/g,function(E){return E.toLowerCase()}),s=t.length,n=[],r=0;r<s;){for(var o=Ta,u=null,b=0,l=null,p=-1;r<s&&(u=o.next(a[r]));)o=u,o.accepts()?(p=0,l=o):p>=0&&p++,b++,r++;if(!(p<0)){r-=p,b-=p;var c=l.emit();n.push(new c(t.substr(r-b,b)))}}return n},r2=Ta;Xa.State=Ms.CharacterState;Xa.TOKENS=Gh;Xa.run=s2;Xa.start=r2;var Ka={},ua={};ua.__esModule=!0;ua.URL=ua.TEXT=ua.NL=ua.EMAIL=ua.MAILTOEMAIL=ua.Base=void 0;var wr=Ai,vn=yr,Kr=ze;function n2(e){return e instanceof Kr.DOMAIN||e instanceof Kr.TLD}var Qs=(0,wr.createTokenClass)();Qs.prototype={type:"token",isLink:!1,toString:function(){for(var t=[],a=0;a<this.v.length;a++)t.push(this.v[a].toString());return t.join("")},toHref:function(){return this.toString()},toObject:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(t)}}};var i2=(0,vn.inherits)(Qs,(0,wr.createTokenClass)(),{type:"email",isLink:!0}),o2=(0,vn.inherits)(Qs,(0,wr.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),l2=(0,vn.inherits)(Qs,(0,wr.createTokenClass)(),{type:"text"}),c2=(0,vn.inherits)(Qs,(0,wr.createTokenClass)(),{type:"nl"}),u2=(0,vn.inherits)(Qs,(0,wr.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",a=!1,s=!1,n=this.v,r=[],o=0;n[o]instanceof Kr.PROTOCOL;)a=!0,r.push(n[o].toString().toLowerCase()),o++;for(;n[o]instanceof Kr.SLASH;)s=!0,r.push(n[o].toString()),o++;for(;n2(n[o]);)r.push(n[o].toString().toLowerCase()),o++;for(;o<n.length;o++)r.push(n[o].toString());return r=r.join(""),a||s||(r=t+"://"+r),r},hasProtocol:function(){return this.v[0]instanceof Kr.PROTOCOL}});ua.Base=Qs;ua.MAILTOEMAIL=i2;ua.EMAIL=o2;ua.NL=c2;ua.TEXT=l2;ua.URL=u2;Ka.__esModule=!0;Ka.start=Ka.run=Ka.TOKENS=Ka.State=void 0;var N0=Ja,da=ua,d2=m2(da),Te=ze;function m2(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}var ct=function(t){return new N0.TokenState(t)},xi=ct(),j0=ct(),F0=ct(),Sl=ct(),H0=ct(),gs=ct(),Oi=ct(),_n=ct(da.URL),P0=ct(),U0=ct(da.URL),Lt=ct(da.URL),an=ct(),pn=ct(),gn=ct(),bn=ct(),yn=ct(),Xs=ct(da.URL),Ks=ct(da.URL),Gs=ct(da.URL),Zs=ct(da.URL),sn=ct(),rn=ct(),nn=ct(),on=ct(),dr=ct(),Ml=ct(),Ii=ct(da.EMAIL),D0=ct(),f2=ct(da.EMAIL),qs=ct(da.MAILTOEMAIL),Ho=ct(),vr=ct(),Ci=ct(),V0=ct(),h2=ct(da.NL);xi.on(Te.NL,h2).on(Te.PROTOCOL,j0).on(Te.MAILTO,F0).on(Te.SLASH,Sl);j0.on(Te.SLASH,Sl);Sl.on(Te.SLASH,H0);xi.on(Te.TLD,gs).on(Te.DOMAIN,gs).on(Te.LOCALHOST,_n).on(Te.NUM,gs);H0.on(Te.TLD,Lt).on(Te.DOMAIN,Lt).on(Te.NUM,Lt).on(Te.LOCALHOST,Lt);gs.on(Te.DOT,Oi);dr.on(Te.DOT,Ml);Oi.on(Te.TLD,_n).on(Te.DOMAIN,gs).on(Te.NUM,gs).on(Te.LOCALHOST,gs);Ml.on(Te.TLD,Ii).on(Te.DOMAIN,dr).on(Te.NUM,dr).on(Te.LOCALHOST,dr);_n.on(Te.DOT,Oi);Ii.on(Te.DOT,Ml);_n.on(Te.COLON,P0).on(Te.SLASH,Lt);P0.on(Te.NUM,U0);U0.on(Te.SLASH,Lt);Ii.on(Te.COLON,D0);D0.on(Te.NUM,f2);var Wt=[Te.DOMAIN,Te.AT,Te.LOCALHOST,Te.NUM,Te.PLUS,Te.POUND,Te.PROTOCOL,Te.SLASH,Te.TLD,Te.UNDERSCORE,Te.SYM,Te.AMPERSAND],Qt=[Te.COLON,Te.DOT,Te.QUERY,Te.PUNCTUATION,Te.CLOSEBRACE,Te.CLOSEBRACKET,Te.CLOSEANGLEBRACKET,Te.CLOSEPAREN,Te.OPENBRACE,Te.OPENBRACKET,Te.OPENANGLEBRACKET,Te.OPENPAREN];Lt.on(Te.OPENBRACE,pn).on(Te.OPENBRACKET,gn).on(Te.OPENANGLEBRACKET,bn).on(Te.OPENPAREN,yn);an.on(Te.OPENBRACE,pn).on(Te.OPENBRACKET,gn).on(Te.OPENANGLEBRACKET,bn).on(Te.OPENPAREN,yn);pn.on(Te.CLOSEBRACE,Lt);gn.on(Te.CLOSEBRACKET,Lt);bn.on(Te.CLOSEANGLEBRACKET,Lt);yn.on(Te.CLOSEPAREN,Lt);Xs.on(Te.CLOSEBRACE,Lt);Ks.on(Te.CLOSEBRACKET,Lt);Gs.on(Te.CLOSEANGLEBRACKET,Lt);Zs.on(Te.CLOSEPAREN,Lt);sn.on(Te.CLOSEBRACE,Lt);rn.on(Te.CLOSEBRACKET,Lt);nn.on(Te.CLOSEANGLEBRACKET,Lt);on.on(Te.CLOSEPAREN,Lt);pn.on(Wt,Xs);gn.on(Wt,Ks);bn.on(Wt,Gs);yn.on(Wt,Zs);pn.on(Qt,sn);gn.on(Qt,rn);bn.on(Qt,nn);yn.on(Qt,on);Xs.on(Wt,Xs);Ks.on(Wt,Ks);Gs.on(Wt,Gs);Zs.on(Wt,Zs);Xs.on(Qt,Xs);Ks.on(Qt,Ks);Gs.on(Qt,Gs);Zs.on(Qt,Zs);sn.on(Wt,Xs);rn.on(Wt,Ks);nn.on(Wt,Gs);on.on(Wt,Zs);sn.on(Qt,sn);rn.on(Qt,rn);nn.on(Qt,nn);on.on(Qt,on);Lt.on(Wt,Lt);an.on(Wt,Lt);Lt.on(Qt,an);an.on(Qt,an);F0.on(Te.TLD,qs).on(Te.DOMAIN,qs).on(Te.NUM,qs).on(Te.LOCALHOST,qs);qs.on(Wt,qs).on(Qt,Ho);Ho.on(Wt,qs).on(Qt,Ho);var wn=[Te.DOMAIN,Te.NUM,Te.PLUS,Te.POUND,Te.QUERY,Te.UNDERSCORE,Te.SYM,Te.AMPERSAND,Te.TLD];gs.on(wn,vr).on(Te.AT,Ci);_n.on(wn,vr).on(Te.AT,Ci);Oi.on(wn,vr);vr.on(wn,vr).on(Te.AT,Ci).on(Te.DOT,V0);V0.on(wn,vr);Ci.on(Te.TLD,dr).on(Te.DOMAIN,dr).on(Te.LOCALHOST,Ii);var v2=function(t){for(var a=t.length,s=0,n=[],r=[];s<a;){for(var o=xi,u=null,b=null,l=0,p=null,c=-1;s<a&&!(u=o.next(t[s]));)r.push(t[s++]);for(;s<a&&(b=u||o.next(t[s]));)u=null,o=b,o.accepts()?(c=0,p=o):c>=0&&c++,s++,l++;if(c<0)for(var E=s-l;E<s;E++)r.push(t[E]);else{r.length>0&&(n.push(new da.TEXT(r)),r=[]),s-=c,l-=c;var A=p.emit();n.push(new A(t.slice(s-l,s)))}}return r.length>0&&n.push(new da.TEXT(r)),n};Ka.State=N0.TokenState;Ka.TOKENS=d2;Ka.run=v2;Ka.start=xi;Kt.__esModule=!0;Kt.tokenize=Kt.test=Kt.scanner=Kt.parser=Kt.options=Kt.inherits=Kt.find=void 0;var _2=yr,p2=hn,g2=El(p2),b2=Xa,q0=El(b2),y2=Ka,z0=El(y2);function El(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"});var Al=function(t){return z0.run(q0.run(t))},w2=function(t){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=Al(t),n=[],r=0;r<s.length;r++){var o=s[r];o.isLink&&(!a||o.type===a)&&n.push(o.toObject())}return n},S2=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=Al(t);return s.length===1&&s[0].isLink&&(!a||s[0].type===a)};Kt.find=w2;Kt.inherits=_2.inherits;Kt.options=g2;Kt.parser=z0;Kt.scanner=q0;Kt.test=S2;Kt.tokenize=Al;var Y0=Kt,M2=(e,t,a)=>{const s={bold:a.bold,italic:a.italic,strike:a.strike,underline:a.underline,multilineCode:a.multilineCode,inlineCode:a.inlineCode},n={[s.bold]:{end:"\\"+s.bold,allowed_chars:".",type:"bold"},[s.italic]:{end:s.italic,allowed_chars:".",type:"italic"},[s.strike]:{end:s.strike,allowed_chars:".",type:"strike"},[s.underline]:{end:s.underline,allowed_chars:".",type:"underline"},[s.multilineCode]:{end:s.multilineCode,allowed_chars:`(.|
)`,type:"multiline-code"},[s.inlineCode]:{end:s.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},r=Wn(e,n),o=E2(r,n),u=[].concat.apply([],o);return t&&k2(u),u};function Wn(e,t){let a=[],s=-1,n=null,r=Y0.find(e),o=!1;if(r.length>0&&(s=e.indexOf(r[0].value),o=!0),Object.keys(t).forEach(u=>{const b=e.indexOf(u);b>=0&&(s<0||b<s)&&(s=b,n=u,o=!1)}),o&&n!==-1){let u=e.substr(0,s),b=e.substr(s,r[0].value.length),l=e.substr(s+r[0].value.length);return a.push(u),a.push(b),a=a.concat(Wn(l,t)),a}if(n){let u=e.substr(0,s);const b=n;let l=e.substr(s+b.length);if(e.replace(/\s/g,"").length===b.length*2)return[e];const p=l.match(new RegExp("^("+(t[b].allowed_chars||".")+"*"+(t[b].end?"?":"")+")"+(t[b].end?"("+t[b].end+")":""),"m"));if(!p||!p[1])u=u+b,a.push(u);else{u&&a.push(u);const c={start:b,content:Wn(p[1],t),end:p[2],type:t[b].type};a.push(c),l=l.substr(p[0].length)}return a=a.concat(Wn(l,t)),a}else return e?[e]:[]}function E2(e,t){const a=[];return e.forEach(s=>{typeof s=="string"?a.push({types:[],value:s}):t[s.start]&&a.push(A2(s))}),a}function A2(e){const t=[];return X0(e,t,[]),t}function X0(e,t,a){e.content.forEach(s=>{typeof s=="string"?t.push({types:Tc(a.concat([e.type])),value:s}):X0(s,t,Tc([s.type].concat([e.type]).concat(a)))})}function Tc(e){return[...new Set(e)]}function k2(e){const t=[];return e.forEach(a=>{const s=Y0.find(a.value);if(s.length){const n=a.value.replace(s[0].value,"");t.push({types:a.types,value:n}),a.types=["url"].concat(a.types),a.href=s[0].href,a.value=s[0].value}t.push(a)}),t}const kl=["png","jpg","jpeg","webp","svg","gif"],K0=["mp4","video/ogg","webm","quicktime"],T2=["mp3","audio/ogg","wav","mpeg"],R2={name:"FormatMessage",components:{SvgIcon:zt},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=M2(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach(t=>{t.url=this.checkType(t,"url"),t.bold=this.checkType(t,"bold"),t.italic=this.checkType(t,"italic"),t.strike=this.checkType(t,"strike"),t.underline=this.checkType(t,"underline"),t.inline=this.checkType(t,"inline-code"),t.multiline=this.checkType(t,"multiline-code"),t.tag=this.checkType(t,"tag"),t.image=this.checkImageType(t),t.value=this.replaceEmojiByElement(t.value)}),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType(e,t){return e.types&&e.types.indexOf(t)!==-1},checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const s=e.value.substring(t+1,e.value.length),n=t>0&&kl.some(r=>s.toLowerCase().includes(r));return n&&this.setImageSize(e),n},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",a);function a(s){const n=s.path[0].width/150;e.height=Math.round(s.path[0].height/n)+"px",t.removeEventListener("load",a)}},formatTags(e){const t="<usertag>",a="</usertag>",s=[...e.matchAll(new RegExp(t,"gi"))].map(r=>r.index),n=e;return s.forEach(r=>{const o=n.substring(r+t.length,n.indexOf(a,r)),u=this.users.find(b=>b._id===o);e=e.replaceAll(o,`@${(u==null?void 0:u.username)||"unknown"}`)}),e},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find(a=>e.value.indexOf(a.username)!==-1);this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;return this.singleLine?t=16:t=this.containsOnlyEmojis()?28:20,e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,a=>`<span style="font-size: ${t}px">${a}</span>`)},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-ữf]","g"),""),t=this.content.replace(new RegExp(`[
\rs]+|( )+`,"g"),"");return e.length===t.length}}},x2={class:"vac-image-link-container"},O2={class:"vac-image-link-message"},I2=["innerHTML"],C2=["innerHTML"];function B2(e,t,a,s,n,r){const o=Ge("svg-icon");return ee(),ue("div",{class:rt(["vac-format-message-wrapper",{"vac-text-ellipsis":a.singleLine}])},[a.textFormatting.disabled?(ee(),ue("div",{key:1,innerHTML:r.formattedContent},null,8,C2)):(ee(),ue("div",{key:0,class:rt({"vac-text-ellipsis":a.singleLine})},[(ee(!0),ue(ft,null,at(r.linkifiedMessage,(u,b)=>(ee(),ue("div",{key:b,class:"vac-format-container"},[(ee(),gt(Am(u.url?"a":"span"),{class:rt({"vac-text-ellipsis":a.singleLine,"vac-text-bold":u.bold,"vac-text-italic":a.deleted||u.italic,"vac-text-strike":u.strike,"vac-text-underline":u.underline,"vac-text-inline-code":!a.singleLine&&u.inline,"vac-text-multiline-code":!a.singleLine&&u.multiline,"vac-text-tag":!a.singleLine&&!a.reply&&u.tag}),href:u.href,target:u.href?a.linkOptions.target:null,rel:u.href?a.linkOptions.rel:null,onClick:l=>r.openTag(u)},{default:Ze(()=>[a.deleted?(ee(),ue(ft,{key:0},[Le(e.$slots,a.roomList?"deleted-icon-room_"+a.roomId:"deleted-icon_"+a.messageId,{},()=>[Fe(o,{name:"deleted",class:rt(["vac-icon-deleted",{"vac-icon-deleted-room":a.roomList}])},null,8,["class"])]),Ss(" "+$e(a.textMessages.MESSAGE_DELETED),1)],64)):u.url&&u.image?(ee(),ue(ft,{key:1},[Me("div",x2,[Me("div",{class:"vac-image-link",style:Ot({"background-image":`url('${u.value}')`,height:u.height})},null,4)]),Me("div",O2,[Me("span",null,$e(u.value),1)])],64)):(ee(),ue("span",{key:2,innerHTML:u.value},null,8,I2))]),_:2},1032,["class","href","target","rel","onClick"]))]))),128))],2))],2)}var Sn=Tt(R2,[["render",B2]]);const Ds="__v-click-outside",G0=typeof window<"u",L2=typeof navigator<"u",N2=G0&&("ontouchstart"in window||L2&&navigator.msMaxTouchPoints>0),j2=N2?["touchstart"]:["click"],F2=e=>{const t=typeof e=="function";if(!t&&typeof e!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(a=>a),events:e.events||j2,isActive:e.isActive!==!1,detectIframe:e.detectIframe!==!1,capture:!!e.capture}},Z0=({event:e,handler:t,middleware:a})=>{a(e)&&t(e)},H2=({el:e,event:t,handler:a,middleware:s})=>{setTimeout(()=>{const{activeElement:n}=document;n&&n.tagName==="IFRAME"&&!e.contains(n)&&Z0({event:t,handler:a,middleware:s})},0)},P2=({el:e,event:t,handler:a,middleware:s})=>{const n=t.path||t.composedPath&&t.composedPath();(n?n.indexOf(e)<0:!e.contains(t.target))&&Z0({event:t,handler:a,middleware:s})},W0=(e,{value:t})=>{const{events:a,handler:s,middleware:n,isActive:r,detectIframe:o,capture:u}=F2(t);if(r){if(e[Ds]=a.map(b=>({event:b,srcTarget:document.documentElement,handler:l=>P2({el:e,event:l,handler:s,middleware:n}),capture:u})),o){const b={event:"blur",srcTarget:window,handler:l=>H2({el:e,event:l,handler:s,middleware:n}),capture:u};e[Ds]=[...e[Ds],b]}e[Ds].forEach(({event:b,srcTarget:l,handler:p})=>setTimeout(()=>{e[Ds]&&l.addEventListener(b,p,u)},0))}},Q0=e=>{(e[Ds]||[]).forEach(({event:a,srcTarget:s,handler:n,capture:r})=>s.removeEventListener(a,n,r)),delete e[Ds]},U2=(e,{value:t,oldValue:a})=>{JSON.stringify(t)!==JSON.stringify(a)&&(Q0(e),W0(e,{value:t}))},D2={beforeMount:W0,updated:U2,unmounted:Q0};var Bi=G0?D2:{},$0=(e,t,a)=>{if(e.typingUsers&&e.typingUsers.length){const s=e.users.filter(n=>{if(n._id!==t&&e.typingUsers.indexOf(n._id)!==-1&&!(n.status&&n.status.state==="offline"))return!0});return s.length?e.users.length===2?a.IS_TYPING:s.map(n=>n.username).join(", ")+" "+a.IS_TYPING:void 0}};function ln(e,t){if(!(!t||!t.type))return e.some(a=>t.type.toLowerCase().includes(a))}function _r(e){return ln(kl,e)}function Mn(e){return ln(K0,e)}function Rc(e){return ln(kl,e)||ln(K0,e)}function Li(e){return ln(T2,e)}const V2={name:"RoomsContent",components:{SvgIcon:zt,FormatMessage:Sn},directives:{clickOutside:Bi},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const a=this.room.users.find(s=>s._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:!a||a._id===this.currentUserId?t:`${a.username} - ${t}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(t=>t._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return $0(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const a=(t=(e=this.room.lastMessage)==null?void 0:e.files)==null?void 0:t[0];if(a){if(!a.duration)return`${a.name}.${a.extension}`;let s=Math.floor(a.duration);return(s-(s%=60))/60+(s>9?":":":0")+s}return""},isAudio(){return this.room.lastMessage.files?Li(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},q2={class:"vac-room-container"},z2={class:"vac-name-container vac-text-ellipsis"},Y2={class:"vac-title-container"},X2={class:"vac-room-name vac-text-ellipsis"},K2={key:1,class:"vac-text-date"},G2={key:0},Z2={key:1,class:"vac-text-ellipsis"},W2={key:3,class:"vac-text-ellipsis"},Q2={class:"vac-room-options-container"},$2={key:0,class:"vac-badge-counter vac-room-badge"},J2={key:0,class:"vac-menu-options"},ev={class:"vac-menu-list"},tv=["onClick"];function av(e,t,a,s,n,r){const o=Ge("svg-icon"),u=Ge("format-message"),b=yi("click-outside");return ee(),ue("div",q2,[Le(e.$slots,"room-list-item_"+a.room.roomId,{},()=>[Le(e.$slots,"room-list-avatar_"+a.room.roomId,{},()=>[a.room.avatar?(ee(),ue("div",{key:0,class:"vac-avatar",style:Ot({"background-image":`url('${a.room.avatar}')`})},null,4)):Ce("",!0)]),Me("div",z2,[Me("div",Y2,[r.userStatus?(ee(),ue("div",{key:0,class:rt(["vac-state-circle",{"vac-state-online":r.userStatus==="online"}])},null,2)):Ce("",!0),Me("div",X2,$e(a.room.roomName),1),a.room.lastMessage?(ee(),ue("div",K2,$e(a.room.lastMessage.timestamp),1)):Ce("",!0)]),Me("div",{class:rt(["vac-text-last",{"vac-message-new":a.room.lastMessage&&a.room.lastMessage.new&&!r.typingUsers}])},[r.isMessageCheckmarkVisible?(ee(),ue("span",G2,[Le(e.$slots,"checkmark-icon_"+a.room.roomId,{},()=>[Fe(o,{name:a.room.lastMessage.distributed?"double-checkmark":"checkmark",param:a.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ce("",!0),a.room.lastMessage&&!a.room.lastMessage.deleted&&r.isAudio?(ee(),ue("div",Z2,[Le(e.$slots,"microphone-icon_"+a.room.roomId,{},()=>[Fe(o,{name:"microphone",class:"vac-icon-microphone"})]),Ss(" "+$e(r.formattedDuration),1)])):a.room.lastMessage?(ee(),gt(u,{key:2,"message-id":a.room.lastMessage._id,"room-id":a.room.roomId,"room-list":!0,content:r.getLastMessage,deleted:!!a.room.lastMessage.deleted&&!r.typingUsers,users:a.room.users,"text-messages":a.textMessages,linkify:!1,"text-formatting":a.textFormatting,"link-options":a.linkOptions,"single-line":!0},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Ce("",!0),!a.room.lastMessage&&r.typingUsers?(ee(),ue("div",W2,$e(r.typingUsers),1)):Ce("",!0),Me("div",Q2,[a.room.unreadCount?(ee(),ue("div",$2,$e(a.room.unreadCount),1)):Ce("",!0),Le(e.$slots,"room-list-options_"+a.room.roomId,{},()=>[a.roomActions.length?(ee(),ue("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Ya(l=>n.roomMenuOpened=a.room.roomId,["stop"]))},[Le(e.$slots,"room-list-options-icon_"+a.room.roomId,{},()=>[Fe(o,{name:"dropdown",param:"room"})])])):Ce("",!0),a.roomActions.length?(ee(),gt(Ht,{key:1,name:"vac-slide-left"},{default:Ze(()=>[n.roomMenuOpened===a.room.roomId?ts((ee(),ue("div",J2,[Me("div",ev,[(ee(!0),ue(ft,null,at(a.roomActions,l=>(ee(),ue("div",{key:l.name},[Me("div",{class:"vac-menu-item",onClick:Ya(p=>r.roomActionHandler(l),["stop"])},$e(l.title),9,tv)]))),128))])])),[[b,r.closeRoomMenu]]):Ce("",!0)]),_:1})):Ce("",!0)])])],2)])])])}var sv=Tt(V2,[["render",av]]),Po=(e,t,a,s=!1)=>!a||a===""?e:e.filter(n=>s?Bn(n[t]).startsWith(Bn(a)):Bn(n[t]).includes(Bn(a)));function Bn(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const rv={name:"RoomsList",components:{Loader:Ei,RoomsSearch:mh,RoomContent:sv},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(a=>{a[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=Po(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},nv={key:0,class:"vac-rooms-empty"},iv={key:1,id:"rooms-list",class:"vac-room-list"},ov=["id","onClick"],lv={key:0,id:"infinite-loader-rooms"};function cv(e,t,a,s,n,r){const o=Ge("rooms-search"),u=Ge("loader"),b=Ge("room-content");return ts((ee(),ue("div",{class:rt(["vac-rooms-container",{"vac-rooms-container-full":a.isMobile,"vac-app-border-r":!a.isMobile}])},[Le(e.$slots,"rooms-header"),Le(e.$slots,"rooms-list-search",{},()=>[Fe(o,{rooms:a.rooms,"loading-rooms":a.loadingRooms,"text-messages":a.textMessages,"show-search":a.showSearch,"show-add-room":a.showAddRoom,onSearchRoom:r.searchRoom,onAddRoom:t[0]||(t[0]=l=>e.$emit("add-room"))},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Fe(u,{show:a.loadingRooms,type:"rooms"},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["show"]),!a.loadingRooms&&!a.rooms.length?(ee(),ue("div",nv,[Le(e.$slots,"rooms-empty",{},()=>[Ss($e(a.textMessages.ROOMS_EMPTY),1)])])):Ce("",!0),a.loadingRooms?Ce("",!0):(ee(),ue("div",iv,[(ee(!0),ue(ft,null,at(n.filteredRooms,l=>(ee(),ue("div",{id:l.roomId,key:l.roomId,class:rt(["vac-room-item",{"vac-room-selected":n.selectedRoomId===l.roomId}]),onClick:p=>r.openRoom(l)},[Fe(b,{"current-user-id":a.currentUserId,room:l,"text-formatting":a.textFormatting,"link-options":a.linkOptions,"text-messages":a.textMessages,"room-actions":a.roomActions,onRoomActionHandler:t[1]||(t[1]=p=>e.$emit("room-action-handler",p))},Mt({_:2},[at(e.$slots,(p,c)=>({name:c,fn:Ze(E=>[Le(e.$slots,c,St(bt(E)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,ov))),128)),Fe(Ht,{name:"vac-fade-message"},{default:Ze(()=>[a.rooms.length&&!a.loadingRooms?(ee(),ue("div",lv,[Fe(u,{show:n.showLoader,infinite:!0,type:"infinite-rooms"},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["show"])])):Ce("",!0)]),_:3})]))],2)),[[Mi,a.showRoomsList]])}var uv=Tt(rv,[["render",cv]]);const dv={name:"RoomHeader",components:{SvgIcon:zt},directives:{clickOutside:Bi},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return $0(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(a=>a._id!==this.currentUserId);if(!(e!=null&&e.status))return;let t="";return e.status.state==="online"?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},mv={class:"vac-room-header vac-app-border-b"},fv={class:"vac-room-wrapper"},hv={key:0,class:"vac-room-selection"},vv=["id"],_v=["onClick"],pv={class:"vac-selection-button-count"},gv={class:"vac-text-ellipsis"},bv={class:"vac-room-name vac-text-ellipsis"},yv={key:0,class:"vac-room-info vac-text-ellipsis"},wv={key:1,class:"vac-room-info vac-text-ellipsis"},Sv={key:0,class:"vac-menu-options"},Mv={class:"vac-menu-list"},Ev=["onClick"];function Av(e,t,a,s,n,r){const o=Ge("svg-icon"),u=yi("click-outside");return ee(),ue("div",mv,[Le(e.$slots,"room-header",{},()=>[Me("div",fv,[Fe(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.messageSelectionEnabled?(ee(),ue("div",hv,[(ee(!0),ue(ft,null,at(a.messageSelectionActions,b=>(ee(),ue("div",{id:b.name,key:b.name},[Me("div",{class:"vac-selection-button",onClick:l=>r.messageSelectionActionHandler(b)},[Ss($e(b.title)+" ",1),Me("span",pv,$e(a.selectedMessagesTotal),1)],8,_v)],8,vv))),128)),Me("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=b=>e.$emit("cancel-message-selection"))},$e(a.textMessages.CANCEL_SELECT_MESSAGE),1)])):Ce("",!0)]),_:1}),!a.messageSelectionEnabled&&n.messageSelectionAnimationEnded?(ee(),ue(ft,{key:0},[a.singleRoom?Ce("",!0):(ee(),ue("div",{key:0,class:rt(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!a.isMobile,"vac-rotate-icon":!a.showRoomsList&&!a.isMobile}]),onClick:t[1]||(t[1]=b=>e.$emit("toggle-rooms-list"))},[Le(e.$slots,"toggle-icon",{},()=>[Fe(o,{name:"toggle"})])],2)),Me("div",{class:rt(["vac-info-wrapper",{"vac-item-clickable":a.roomInfoEnabled}]),onClick:t[2]||(t[2]=b=>e.$emit("room-info"))},[Le(e.$slots,"room-header-avatar",{},()=>[a.room.avatar?(ee(),ue("div",{key:0,class:"vac-avatar",style:Ot({"background-image":`url('${a.room.avatar}')`})},null,4)):Ce("",!0)]),Le(e.$slots,"room-header-info",{},()=>[Me("div",gv,[Me("div",bv,$e(a.room.roomName),1),r.typingUsers?(ee(),ue("div",yv,$e(r.typingUsers),1)):(ee(),ue("div",wv,$e(r.userStatus),1))])])],2),a.room.roomId?Le(e.$slots,"room-options",{key:1},()=>[a.menuActions.length?(ee(),ue("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=b=>n.menuOpened=!n.menuOpened)},[Le(e.$slots,"menu-icon",{},()=>[Fe(o,{name:"menu"})])])):Ce("",!0),a.menuActions.length?(ee(),gt(Ht,{key:1,name:"vac-slide-left"},{default:Ze(()=>[n.menuOpened?ts((ee(),ue("div",Sv,[Me("div",Mv,[(ee(!0),ue(ft,null,at(a.menuActions,b=>(ee(),ue("div",{key:b.name},[Me("div",{class:"vac-menu-item",onClick:l=>r.menuActionHandler(b)},$e(b.title),9,Ev)]))),128))])])),[[u,r.closeMenu]]):Ce("",!0)]),_:1})):Ce("",!0)]):Ce("",!0)],64)):Ce("",!0)])])])}var kv=Tt(dv,[["render",Av]]);function Ln(e){if(typeof e!="string"||!e)throw new Error("expected a non-empty string, got: "+e)}function ro(e){if(typeof e!="number")throw new Error("expected a number, got: "+e)}const Tv=1,Rv=1,$s="emoji",pr="keyvalue",Tl="favorites",xv="tokens",J0="tokens",Ov="unicode",eu="count",Iv="group",Cv="order",tu="group-order",Uo="eTag",ni="url",xc="skinTone",Sr="readonly",Rl="readwrite",au="skinUnicodes",Bv="skinUnicodes",Lv="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Nv="en";function jv(e,t){const a=new Set,s=[];for(const n of e){const r=t(n);a.has(r)||(a.add(r),s.push(n))}return s}function Oc(e){return jv(e,t=>t.unicode)}function Fv(e){function t(a,s,n){const r=s?e.createObjectStore(a,{keyPath:s}):e.createObjectStore(a);if(n)for(const[o,[u,b]]of Object.entries(n))r.createIndex(o,u,{multiEntry:b});return r}t(pr),t($s,Ov,{[J0]:[xv,!0],[tu]:[[Iv,Cv]],[au]:[Bv,!0]}),t(Tl,void 0,{[eu]:[""]})}const Do={},Qn={},ii={};function su(e,t,a){a.onerror=()=>t(a.error),a.onblocked=()=>t(new Error("IDB blocked")),a.onsuccess=()=>e(a.result)}async function Hv(e){const t=await new Promise((a,s)=>{const n=indexedDB.open(e,Tv);Do[e]=n,n.onupgradeneeded=r=>{r.oldVersion<Rv&&Fv(n.result)},su(a,s,n)});return t.onclose=()=>xl(e),t}function Pv(e){return Qn[e]||(Qn[e]=Hv(e)),Qn[e]}function rs(e,t,a,s){return new Promise((n,r)=>{const o=e.transaction(t,a,{durability:"relaxed"}),u=typeof t=="string"?o.objectStore(t):t.map(l=>o.objectStore(l));let b;s(u,o,l=>{b=l}),o.oncomplete=()=>n(b),o.onerror=()=>r(o.error)})}function xl(e){const t=Do[e],a=t&&t.result;if(a){a.close();const s=ii[e];if(s)for(const n of s)n()}delete Do[e],delete Qn[e],delete ii[e]}function Uv(e){return new Promise((t,a)=>{xl(e);const s=indexedDB.deleteDatabase(e);su(t,a,s)})}function Dv(e,t){let a=ii[e];a||(a=ii[e]=[]),a.push(t)}const Vv=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function mr(e){return e.split(/[\s_]+/).map(t=>!t.match(/\w/)||Vv.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const qv=2;function ru(e){return e.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=qv)}function zv(e){return e.map(({annotation:a,emoticon:s,group:n,order:r,shortcodes:o,skins:u,tags:b,emoji:l,version:p})=>{const c=[...new Set(ru([...(o||[]).map(mr).flat(),...b.map(mr).flat(),...mr(a),s]))].sort(),E={annotation:a,group:n,order:r,tags:b,tokens:c,unicode:l,version:p};if(s&&(E.emoticon=s),o&&(E.shortcodes=o),u){E.skinTones=[],E.skinUnicodes=[],E.skinVersions=[];for(const{tone:A,emoji:i,version:F}of u)E.skinTones.push(A),E.skinUnicodes.push(i),E.skinVersions.push(F)}return E})}function nu(e,t,a,s){e[t](a).onsuccess=n=>s&&s(n.target.result)}function Ws(e,t,a){nu(e,"get",t,a)}function iu(e,t,a){nu(e,"getAll",t,a)}function Ol(e){e.commit&&e.commit()}function Yv(e,t){let a=e[0];for(let s=1;s<e.length;s++){const n=e[s];t(a)>t(n)&&(a=n)}return a}function ou(e,t){const a=Yv(e,n=>n.length),s=[];for(const n of a)e.some(r=>r.findIndex(o=>t(o)===t(n))===-1)||s.push(n);return s}async function Xv(e){return!await Il(e,pr,ni)}async function Kv(e,t,a){const[s,n]=await Promise.all([Uo,ni].map(r=>Il(e,pr,r)));return s===a&&n===t}async function Gv(e,t){return rs(e,$s,Sr,(s,n,r)=>{let o;const u=()=>{s.getAll(o&&IDBKeyRange.lowerBound(o,!0),50).onsuccess=b=>{const l=b.target.result;for(const p of l)if(o=p.unicode,t(p))return r(p);if(l.length<50)return r();u()}};u()})}async function lu(e,t,a,s){try{const n=zv(t);await rs(e,[$s,pr],Rl,([r,o],u)=>{let b,l,p=0;function c(){++p===2&&E()}function E(){if(!(b===s&&l===a)){r.clear();for(const A of n)r.put(A);o.put(s,Uo),o.put(a,ni),Ol(u)}}Ws(o,Uo,A=>{b=A,c()}),Ws(o,ni,A=>{l=A,c()})})}finally{}}async function Zv(e,t){return rs(e,$s,Sr,(a,s,n)=>{const r=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);iu(a.index(tu),r,n)})}async function cu(e,t){const a=ru(mr(t));return a.length?rs(e,$s,Sr,(s,n,r)=>{const o=[],u=()=>{o.length===a.length&&b()},b=()=>{const l=ou(o,p=>p.unicode);r(l.sort((p,c)=>p.order<c.order?-1:1))};for(let l=0;l<a.length;l++){const p=a[l],c=l===a.length-1?IDBKeyRange.bound(p,p+"￿",!1,!0):IDBKeyRange.only(p);iu(s.index(J0),c,E=>{o.push(E),u()})}}):[]}async function Wv(e,t){const a=await cu(e,t);return a.length?a.filter(s=>(s.shortcodes||[]).map(r=>r.toLowerCase()).includes(t.toLowerCase()))[0]||null:await Gv(e,n=>(n.shortcodes||[]).includes(t.toLowerCase()))||null}async function Qv(e,t){return rs(e,$s,Sr,(a,s,n)=>Ws(a,t,r=>{if(r)return n(r);Ws(a.index(au),t,o=>n(o||null))}))}function Il(e,t,a){return rs(e,t,Sr,(s,n,r)=>Ws(s,a,r))}function $v(e,t,a,s){return rs(e,t,Rl,(n,r)=>{n.put(s,a),Ol(r)})}function Jv(e,t){return rs(e,Tl,Rl,(a,s)=>Ws(a,t,n=>{a.put((n||0)+1,t),Ol(s)}))}function e_(e,t,a){return a===0?[]:rs(e,[Tl,$s],Sr,([s,n],r,o)=>{const u=[];s.index(eu).openCursor(void 0,"prev").onsuccess=b=>{const l=b.target.result;if(!l)return o(u);function p(A){if(u.push(A),u.length===a)return o(u);l.continue()}const c=l.primaryKey,E=t.byName(c);if(E)return p(E);Ws(n,c,A=>{if(A)return p(A);l.continue()})}})}const Nn="";function t_(e,t){const a=new Map;for(const n of e){const r=t(n);for(const o of r){let u=a;for(let l=0;l<o.length;l++){const p=o.charAt(l);let c=u.get(p);c||(c=new Map,u.set(p,c)),u=c}let b=u.get(Nn);b||(b=[],u.set(Nn,b)),b.push(n)}}return(n,r)=>{let o=a;for(let l=0;l<n.length;l++){const p=n.charAt(l),c=o.get(p);if(c)o=c;else return[]}if(r)return o.get(Nn)||[];const u=[],b=[o];for(;b.length;){const p=[...b.shift().entries()].sort((c,E)=>c[0]<E[0]?-1:1);for(const[c,E]of p)c===Nn?u.push(...E):b.push(E)}return u}}const a_=["name","url"];function s_(e){const t=e&&Array.isArray(e),a=t&&e.length&&(!e[0]||a_.some(s=>!(s in e[0])));if(!t||a)throw new Error("Custom emojis are in the wrong format")}function Ic(e){s_(e);const t=(E,A)=>E.name.toLowerCase()<A.name.toLowerCase()?-1:1,a=e.sort(t),n=t_(e,E=>[...new Set((E.shortcodes||[]).map(A=>mr(A)).flat())]),r=E=>n(E,!0),o=E=>n(E,!1),u=E=>{const A=mr(E),i=A.map((F,L)=>(L<A.length-1?r:o)(F));return ou(i,F=>F.name).sort(t)},b=new Map,l=new Map;for(const E of e){l.set(E.name.toLowerCase(),E);for(const A of E.shortcodes||[])b.set(A.toLowerCase(),E)}return{all:a,search:u,byShortcode:E=>b.get(E.toLowerCase()),byName:E=>l.get(E.toLowerCase())}}function Ir(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let a=0;a<t;a++)e.skins[a]={tone:e.skinTones[a],unicode:e.skinUnicodes[a],version:e.skinVersions[a]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function uu(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const r_=["annotation","emoji","group","order","tags","version"];function n_(e){if(!e||!Array.isArray(e)||!e[0]||typeof e[0]!="object"||r_.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function du(e,t){if(Math.floor(e.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+e.status)}async function i_(e){const t=await fetch(e,{method:"HEAD"});du(t,e);const a=t.headers.get("etag");return uu(a),a}async function Vo(e){const t=await fetch(e);du(t,e);const a=t.headers.get("etag");uu(a);const s=await t.json();return n_(s),[a,s]}function o_(e){for(var t="",a=new Uint8Array(e),s=a.byteLength,n=-1;++n<s;)t+=String.fromCharCode(a[n]);return t}function l_(e){for(var t=e.length,a=new ArrayBuffer(t),s=new Uint8Array(a),n=-1;++n<t;)s[n]=e.charCodeAt(n);return a}async function mu(e){const t=JSON.stringify(e),a=l_(t),s=await crypto.subtle.digest("SHA-1",a),n=o_(s);return btoa(n)}async function c_(e,t){let a,s=await i_(t);if(!s){const n=await Vo(t);s=n[0],a=n[1],s||(s=await mu(a))}await Kv(e,t,s)||(a||(a=(await Vo(t))[1]),await lu(e,a,t,s))}async function u_(e,t){let[a,s]=await Vo(t);a||(a=await mu(s)),await lu(e,s,t,a)}class fu{constructor({dataSource:t=Lv,locale:a=Nv,customEmoji:s=[]}={}){this.dataSource=t,this.locale=a,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=Ic(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await Pv(this._dbName);Dv(this._dbName,this._clear);const a=this.dataSource;await Xv(t)?await u_(t,a):this._lazyUpdate=c_(t,a)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return ro(t),await this.ready(),Oc(await Zv(this._db,t)).map(Ir)}async getEmojiBySearchQuery(t){Ln(t),await this.ready();const a=this._custom.search(t),s=Oc(await cu(this._db,t)).map(Ir);return[...a,...s]}async getEmojiByShortcode(t){Ln(t),await this.ready();const a=this._custom.byShortcode(t);return a||Ir(await Wv(this._db,t))}async getEmojiByUnicodeOrName(t){Ln(t),await this.ready();const a=this._custom.byName(t);return a||Ir(await Qv(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await Il(this._db,pr,xc)||0}async setPreferredSkinTone(t){return ro(t),await this.ready(),$v(this._db,pr,xc,t)}async incrementFavoriteEmojiCount(t){return Ln(t),await this.ready(),Jv(this._db,t)}async getTopFavoriteEmoji(t){return ro(t),await this.ready(),(await e_(this._db,this._custom,t)).map(Ir)}set customEmoji(t){this._custom=Ic(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await xl(this._dbName)}async delete(){await this._shutdown(),await Uv(this._dbName)}}function cn(){}function hu(e){return e()}function Cc(){return Object.create(null)}function En(e){e.forEach(hu)}function vu(e){return typeof e=="function"}function d_(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let jn;function oi(e,t){return jn||(jn=document.createElement("a")),jn.href=t,e===jn.href}function m_(e){return Object.keys(e).length===0}function f_(e){return e&&vu(e.destroy)?e.destroy:cn}function At(e,t){e.appendChild(t)}function La(e,t,a){e.insertBefore(t,a||null)}function Na(e){e.parentNode.removeChild(e)}function yt(e){return document.createElement(e)}function qa(e){return document.createTextNode(e)}function Ia(e,t,a,s){return e.addEventListener(t,a,s),()=>e.removeEventListener(t,a,s)}function re(e,t,a){a==null?e.removeAttribute(t):e.getAttribute(t)!==a&&e.setAttribute(t,a)}function za(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Bc(e,t){e.value=t??""}function os(e,t,a,s){a===null?e.style.removeProperty(t):e.style.setProperty(t,a,s?"important":"")}let Cl;function Gr(e){Cl=e}const Pr=[],or=[],$n=[],Lc=[],_u=Promise.resolve();let qo=!1;function pu(){qo||(qo=!0,_u.then(gu))}function h_(){return pu(),_u}function zo(e){$n.push(e)}const no=new Set;let Fn=0;function gu(){const e=Cl;do{for(;Fn<Pr.length;){const t=Pr[Fn];Fn++,Gr(t),v_(t.$$)}for(Gr(null),Pr.length=0,Fn=0;or.length;)or.pop()();for(let t=0;t<$n.length;t+=1){const a=$n[t];no.has(a)||(no.add(a),a())}$n.length=0}while(Pr.length);for(;Lc.length;)Lc.pop()();qo=!1,no.clear(),Gr(e)}function v_(e){if(e.fragment!==null){e.update(),En(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(zo)}}const __=new Set;function p_(e,t){e&&e.i&&(__.delete(e),e.i(t))}const g_=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Ur(e,t){e.d(1),t.delete(e.key)}function Dr(e,t,a,s,n,r,o,u,b,l,p,c){let E=e.length,A=r.length,i=E;const F={};for(;i--;)F[e[i].key]=i;const L=[],B=new Map,f=new Map;for(i=A;i--;){const N=c(n,r,i),m=a(N);let k=o.get(m);k?s&&k.p(N,t):(k=l(m,N),k.c()),B.set(m,L[i]=k),m in F&&f.set(m,Math.abs(i-F[m]))}const R=new Set,C=new Set;function T(N){p_(N,1),N.m(u,p),o.set(N.key,N),p=N.first,A--}for(;E&&A;){const N=L[A-1],m=e[E-1],k=N.key,S=m.key;N===m?(p=N.first,E--,A--):B.has(S)?!o.has(k)||R.has(k)?T(N):C.has(S)?E--:f.get(k)>f.get(S)?(C.add(k),T(N)):(R.add(S),E--):(b(m,o),E--)}for(;E--;){const N=e[E];B.has(N.key)||b(N,o)}for(;A;)T(L[A-1]);return L}function b_(e,t,a,s){const{fragment:n,on_mount:r,on_destroy:o,after_update:u}=e.$$;n&&n.m(t,a),s||zo(()=>{const b=r.map(hu).filter(vu);o?o.push(...b):En(b),e.$$.on_mount=[]}),u.forEach(zo)}function y_(e,t){const a=e.$$;a.fragment!==null&&(En(a.on_destroy),a.fragment&&a.fragment.d(t),a.on_destroy=a.fragment=null,a.ctx=[])}function w_(e,t){e.$$.dirty[0]===-1&&(Pr.push(e),pu(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function S_(e,t,a,s,n,r,o,u=[-1]){const b=Cl;Gr(e);const l=e.$$={fragment:null,ctx:null,props:r,update:cn,not_equal:n,bound:Cc(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(b?b.$$.context:[]),callbacks:Cc(),dirty:u,skip_bound:!1,root:t.target||b.$$.root};o&&o(l.root);let p=!1;l.ctx=a?a(e,t.props||{},(c,E,...A)=>{const i=A.length?A[0]:E;return l.ctx&&n(l.ctx[c],l.ctx[c]=i)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](i),p&&w_(e,c)),E}):[],l.update(),p=!0,En(l.before_update),l.fragment=s?s(l.ctx):!1,t.target&&(l.fragment&&l.fragment.c(),b_(e,t.target,void 0,void 0),gu()),Gr(b)}class M_{$destroy(){y_(this,1),this.$destroy=cn}$on(t,a){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(a),()=>{const n=s.indexOf(a);n!==-1&&s.splice(n,1)}}$set(t){this.$$set&&!m_(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const bu=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map(([e,t,a])=>({id:e,emoji:t,name:a})),Hn=bu.slice(1),E_=bu[0],A_=2,Nc=6,yu=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function jc(e){return e.unicode.includes("‍")}const k_={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},T_=1e3,R_="🖐️",x_=8,O_=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],wu='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',I_=(e,t)=>e<t?-1:e>t?1:0,Fc=(e,t)=>{const a=document.createElement("canvas");a.width=a.height=1;const s=a.getContext("2d");return s.textBaseline="top",s.font=`100px ${wu}`,s.fillStyle=t,s.scale(.01,.01),s.fillText(e,0,0),s.getImageData(0,0,1,1).data},C_=(e,t)=>{const a=[...e].join(","),s=[...t].join(",");return a===s&&!a.startsWith("0,0,0,")};function B_(e){const t=Fc(e,"#000"),a=Fc(e,"#fff");return t&&a&&C_(t,a)}function L_(){const e=Object.entries(k_);try{for(const[t,a]of e)if(B_(t))return a}catch{}finally{}return e[0][1]}const io=new Promise(e=>yu(()=>e(L_()))),Yo=new Map,N_="️",j_="\uD83C",F_="‍",H_=127995,P_=57339;function U_(e,t){if(t===0)return e;const a=e.indexOf(F_);return a!==-1?e.substring(0,a)+String.fromCodePoint(H_+t-1)+e.substring(a):(e.endsWith(N_)&&(e=e.substring(0,e.length-1)),e+j_+String.fromCodePoint(P_+t-1))}function ls(e){e.preventDefault(),e.stopPropagation()}function oo(e,t,a){return t+=e?-1:1,t<0?t=a.length-1:t>=a.length&&(t=0),t}function Su(e,t){const a=new Set,s=[];for(const n of e){const r=t(n);a.has(r)||(a.add(r),s.push(n))}return s}function D_(e,t){const a=s=>{const n={};for(const r of s)typeof r.tone=="number"&&r.version<=t&&(n[r.tone]=r.unicode);return n};return e.map(({unicode:s,skins:n,shortcodes:r,url:o,name:u,category:b})=>({unicode:s,name:u,shortcodes:r,url:o,category:b,id:s||u,skins:n&&a(n),title:(r||[]).join(", ")}))}const Jn=requestAnimationFrame;let V_=typeof ResizeObserver=="function";function q_(e,t){let a;return V_?(a=new ResizeObserver(s=>t(s[0].contentRect.width)),a.observe(e)):Jn(()=>t(e.getBoundingClientRect().width)),{destroy(){a&&a.disconnect()}}}function Hc(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}let lo;function z_(e,t,a){for(const s of e){const n=a(s),r=Hc(n);typeof lo>"u"&&(lo=Hc(t));const o=r/1.8<lo;Yo.set(s.unicode,o)}}function Y_(e){return Su(e,t=>t)}const{Map:Vr}=g_;function Pc(e,t,a){const s=e.slice();return s[63]=t[a],s[65]=a,s}function Uc(e,t,a){const s=e.slice();return s[66]=t[a],s[65]=a,s}function Dc(e,t,a){const s=e.slice();return s[63]=t[a],s[65]=a,s}function Vc(e,t,a){const s=e.slice();return s[69]=t[a],s}function qc(e,t,a){const s=e.slice();return s[72]=t[a],s[65]=a,s}function zc(e,t){let a,s=t[72]+"",n,r,o,u,b,l;return{key:e,first:null,c(){a=yt("div"),n=qa(s),re(a,"id",r="skintone-"+t[65]),re(a,"class",o="emoji hide-focus "+(t[65]===t[20]?"active":"")),re(a,"aria-selected",u=t[65]===t[20]),re(a,"role","option"),re(a,"title",b=t[0].skinTones[t[65]]),re(a,"tabindex","-1"),re(a,"aria-label",l=t[0].skinTones[t[65]]),this.first=a},m(p,c){La(p,a,c),At(a,n)},p(p,c){t=p,c[0]&512&&s!==(s=t[72]+"")&&za(n,s),c[0]&512&&r!==(r="skintone-"+t[65])&&re(a,"id",r),c[0]&1049088&&o!==(o="emoji hide-focus "+(t[65]===t[20]?"active":""))&&re(a,"class",o),c[0]&1049088&&u!==(u=t[65]===t[20])&&re(a,"aria-selected",u),c[0]&513&&b!==(b=t[0].skinTones[t[65]])&&re(a,"title",b),c[0]&513&&l!==(l=t[0].skinTones[t[65]])&&re(a,"aria-label",l)},d(p){p&&Na(a)}}}function Yc(e,t){let a,s,n=t[69].emoji+"",r,o,u,b,l,p,c;function E(){return t[49](t[69])}return{key:e,first:null,c(){a=yt("button"),s=yt("div"),r=qa(n),re(s,"class","nav-emoji emoji"),re(a,"role","tab"),re(a,"class","nav-button"),re(a,"aria-controls",o="tab-"+t[69].id),re(a,"aria-label",u=t[0].categories[t[69].name]),re(a,"aria-selected",b=!t[4]&&t[13].id===t[69].id),re(a,"title",l=t[0].categories[t[69].name]),this.first=a},m(A,i){La(A,a,i),At(a,s),At(s,r),p||(c=Ia(a,"click",E),p=!0)},p(A,i){t=A,i[0]&4096&&n!==(n=t[69].emoji+"")&&za(r,n),i[0]&4096&&o!==(o="tab-"+t[69].id)&&re(a,"aria-controls",o),i[0]&4097&&u!==(u=t[0].categories[t[69].name])&&re(a,"aria-label",u),i[0]&12304&&b!==(b=!t[4]&&t[13].id===t[69].id)&&re(a,"aria-selected",b),i[0]&4097&&l!==(l=t[0].categories[t[69].name])&&re(a,"title",l)},d(A){A&&Na(a),p=!1,c()}}}function X_(e){let t,a;return{c(){t=yt("img"),re(t,"class","custom-emoji"),oi(t.src,a=e[63].url)||re(t,"src",a),re(t,"alt",""),re(t,"loading","lazy")},m(s,n){La(s,t,n)},p(s,n){n[0]&32768&&!oi(t.src,a=s[63].url)&&re(t,"src",a)},d(s){s&&Na(t)}}}function K_(e){let t=e[27](e[63],e[8])+"",a;return{c(){a=qa(t)},m(s,n){La(s,a,n)},p(s,n){n[0]&33024&&t!==(t=s[27](s[63],s[8])+"")&&za(a,t)},d(s){s&&Na(a)}}}function Xc(e,t){let a,s,n,r,o,u,b;function l(E,A){return E[63].unicode?K_:X_}let p=l(t),c=p(t);return{key:e,first:null,c(){a=yt("button"),c.c(),re(a,"role",s=t[4]?"option":"menuitem"),re(a,"aria-selected",n=t[4]?t[65]==t[5]:""),re(a,"aria-label",r=t[28](t[63],t[8])),re(a,"title",o=t[63].title),re(a,"class",u="emoji "+(t[4]&&t[65]===t[5]?"active":"")),re(a,"id",b="emo-"+t[63].id),this.first=a},m(E,A){La(E,a,A),c.m(a,null)},p(E,A){t=E,p===(p=l(t))&&c?c.p(t,A):(c.d(1),c=p(t),c&&(c.c(),c.m(a,null))),A[0]&16&&s!==(s=t[4]?"option":"menuitem")&&re(a,"role",s),A[0]&32816&&n!==(n=t[4]?t[65]==t[5]:"")&&re(a,"aria-selected",n),A[0]&33024&&r!==(r=t[28](t[63],t[8]))&&re(a,"aria-label",r),A[0]&32768&&o!==(o=t[63].title)&&re(a,"title",o),A[0]&32816&&u!==(u="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&re(a,"class",u),A[0]&32768&&b!==(b="emo-"+t[63].id)&&re(a,"id",b)},d(E){E&&Na(a),c.d()}}}function Kc(e,t){let a,s=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",n,r,o,u,b=[],l=new Vr,p,c,E,A=t[66].emojis;const i=F=>F[63].id;for(let F=0;F<A.length;F+=1){let L=Dc(t,A,F),B=i(L);l.set(B,b[F]=Xc(B,L))}return{key:e,first:null,c(){a=yt("div"),n=qa(s),u=yt("div");for(let F=0;F<b.length;F+=1)b[F].c();re(a,"id",r="menu-label-"+t[65]),re(a,"class",o="category "+(t[15].length===1&&t[15][0].category===""?"gone":"")),re(a,"aria-hidden","true"),re(u,"class","emoji-menu"),re(u,"role",p=t[4]?"listbox":"menu"),re(u,"aria-labelledby",c="menu-label-"+t[65]),re(u,"id",E=t[4]?"search-results":""),this.first=a},m(F,L){La(F,a,L),At(a,n),La(F,u,L);for(let B=0;B<b.length;B+=1)b[B].m(u,null)},p(F,L){t=F,L[0]&40977&&s!==(s=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&za(n,s),L[0]&32768&&r!==(r="menu-label-"+t[65])&&re(a,"id",r),L[0]&32768&&o!==(o="category "+(t[15].length===1&&t[15][0].category===""?"gone":""))&&re(a,"class",o),L[0]&402686256&&(A=t[66].emojis,b=Dr(b,L,i,1,t,A,l,u,Ur,Xc,null,Dc)),L[0]&16&&p!==(p=t[4]?"listbox":"menu")&&re(u,"role",p),L[0]&32768&&c!==(c="menu-label-"+t[65])&&re(u,"aria-labelledby",c),L[0]&16&&E!==(E=t[4]?"search-results":"")&&re(u,"id",E)},d(F){F&&Na(a),F&&Na(u);for(let L=0;L<b.length;L+=1)b[L].d()}}}function G_(e){let t,a;return{c(){t=yt("img"),re(t,"class","custom-emoji"),oi(t.src,a=e[63].url)||re(t,"src",a),re(t,"alt",""),re(t,"loading","lazy")},m(s,n){La(s,t,n)},p(s,n){n[0]&1024&&!oi(t.src,a=s[63].url)&&re(t,"src",a)},d(s){s&&Na(t)}}}function Z_(e){let t=e[27](e[63],e[8])+"",a;return{c(){a=qa(t)},m(s,n){La(s,a,n)},p(s,n){n[0]&1280&&t!==(t=s[27](s[63],s[8])+"")&&za(a,t)},d(s){s&&Na(a)}}}function Gc(e,t){let a,s,n,r;function o(l,p){return l[63].unicode?Z_:G_}let u=o(t),b=u(t);return{key:e,first:null,c(){a=yt("button"),b.c(),re(a,"role","menuitem"),re(a,"aria-label",s=t[28](t[63],t[8])),re(a,"title",n=t[63].title),re(a,"class","emoji"),re(a,"id",r="fav-"+t[63].id),this.first=a},m(l,p){La(l,a,p),b.m(a,null)},p(l,p){t=l,u===(u=o(t))&&b?b.p(t,p):(b.d(1),b=u(t),b&&(b.c(),b.m(a,null))),p[0]&1280&&s!==(s=t[28](t[63],t[8]))&&re(a,"aria-label",s),p[0]&1024&&n!==(n=t[63].title)&&re(a,"title",n),p[0]&1024&&r!==(r="fav-"+t[63].id)&&re(a,"id",r)},d(l){l&&Na(a),b.d()}}}function W_(e){let t,a,s,n,r,o,u,b,l,p=e[0].searchLabel+"",c,E,A=e[0].searchDescription+"",i,F,L,B,f,R,C,T=e[0].skinToneDescription+"",N,m,k=[],S=new Vr,h,g,_,v,y,w=[],j=new Vr,K,P,z,d,M,W,$,_e,Ae=[],Re=new Vr,ge,Ve,Ne,he,Ke,it=[],U=new Vr,Y,te,de,me,Ee,xe,be=e[9];const ke=se=>se[72];for(let se=0;se<be.length;se+=1){let le=qc(e,be,se),Q=ke(le);S.set(Q,k[se]=zc(Q,le))}let pe=e[12];const De=se=>se[69].id;for(let se=0;se<pe.length;se+=1){let le=Vc(e,pe,se),Q=De(le);j.set(Q,w[se]=Yc(Q,le))}let He=e[15];const fe=se=>se[66].category;for(let se=0;se<He.length;se+=1){let le=Uc(e,He,se),Q=fe(le);Re.set(Q,Ae[se]=Kc(Q,le))}let ae=e[10];const ve=se=>se[63].id;for(let se=0;se<ae.length;se+=1){let le=Pc(e,ae,se),Q=ve(le);U.set(Q,it[se]=Gc(Q,le))}return{c(){t=yt("section"),a=yt("div"),s=yt("div"),n=yt("div"),r=yt("input"),l=yt("label"),c=qa(p),E=yt("span"),i=qa(A),F=yt("div"),L=yt("button"),B=qa(e[21]),C=yt("span"),N=qa(T),m=yt("div");for(let se=0;se<k.length;se+=1)k[se].c();y=yt("div");for(let se=0;se<w.length;se+=1)w[se].c();P=yt("div"),z=yt("div"),d=yt("div"),M=qa(e[18]),$=yt("div"),_e=yt("div");for(let se=0;se<Ae.length;se+=1)Ae[se].c();Ke=yt("div");for(let se=0;se<it.length;se+=1)it[se].c();de=yt("button"),de.textContent="😀",re(a,"class","pad-top"),re(r,"id","search"),re(r,"class","search"),re(r,"type","search"),re(r,"role","combobox"),re(r,"enterkeyhint","search"),re(r,"placeholder",o=e[0].searchLabel),re(r,"autocapitalize","none"),re(r,"autocomplete","off"),re(r,"spellcheck","true"),re(r,"aria-expanded",u=!!(e[4]&&e[1].length)),re(r,"aria-controls","search-results"),re(r,"aria-describedby","search-description"),re(r,"aria-autocomplete","list"),re(r,"aria-activedescendant",b=e[26]?`emo-${e[26]}`:""),re(l,"class","sr-only"),re(l,"for","search"),re(E,"id","search-description"),re(E,"class","sr-only"),re(n,"class","search-wrapper"),re(L,"id","skintone-button"),re(L,"class",f="emoji "+(e[6]?"hide-focus":"")),re(L,"aria-label",e[23]),re(L,"title",e[23]),re(L,"aria-describedby","skintone-description"),re(L,"aria-haspopup","listbox"),re(L,"aria-expanded",e[6]),re(L,"aria-controls","skintone-list"),re(F,"class",R="skintone-button-wrapper "+(e[19]?"expanded":"")),re(C,"id","skintone-description"),re(C,"class","sr-only"),re(m,"id","skintone-list"),re(m,"class",h="skintone-list "+(e[6]?"":"hidden no-animate")),os(m,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),re(m,"role","listbox"),re(m,"aria-label",g=e[0].skinTonesLabel),re(m,"aria-activedescendant",_="skintone-"+e[20]),re(m,"aria-hidden",v=!e[6]),re(s,"class","search-row"),re(y,"class","nav"),re(y,"role","tablist"),os(y,"grid-template-columns","repeat("+e[12].length+", 1fr)"),re(y,"aria-label",K=e[0].categoriesLabel),re(z,"class","indicator"),os(z,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),re(P,"class","indicator-wrapper"),re(d,"class",W="message "+(e[18]?"":"gone")),re(d,"role","alert"),re(d,"aria-live","polite"),re($,"class",ge="tabpanel "+(!e[14]||e[18]?"gone":"")),re($,"role",Ve=e[4]?"region":"tabpanel"),re($,"aria-label",Ne=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),re($,"id",he=e[4]?"":`tab-${e[13].id}`),re($,"tabindex","0"),re(Ke,"class",Y="favorites emoji-menu "+(e[18]?"gone":"")),re(Ke,"role","menu"),re(Ke,"aria-label",te=e[0].favoritesLabel),os(Ke,"padding-inline-end",e[25]+"px"),re(de,"aria-hidden","true"),re(de,"tabindex","-1"),re(de,"class","abs-pos hidden emoji"),re(t,"class","picker"),re(t,"aria-label",me=e[0].regionLabel),re(t,"style",e[22])},m(se,le){La(se,t,le),At(t,a),At(t,s),At(s,n),At(n,r),Bc(r,e[2]),At(n,l),At(l,c),At(n,E),At(E,i),At(s,F),At(F,L),At(L,B),At(s,C),At(C,N),At(s,m);for(let Q=0;Q<k.length;Q+=1)k[Q].m(m,null);e[48](m),At(t,y);for(let Q=0;Q<w.length;Q+=1)w[Q].m(y,null);At(t,P),At(P,z),At(t,d),At(d,M),At(t,$),At($,_e);for(let Q=0;Q<Ae.length;Q+=1)Ae[Q].m(_e,null);e[50]($),At(t,Ke);for(let Q=0;Q<it.length;Q+=1)it[Q].m(Ke,null);At(t,de),e[51](de),e[52](t),Ee||(xe=[Ia(r,"input",e[47]),Ia(r,"keydown",e[30]),Ia(L,"click",e[35]),Ia(m,"focusout",e[38]),Ia(m,"click",e[34]),Ia(m,"keydown",e[36]),Ia(m,"keyup",e[37]),Ia(y,"keydown",e[32]),f_(e[29].call(null,_e)),Ia($,"click",e[33]),Ia(Ke,"click",e[33])],Ee=!0)},p(se,le){le[0]&1&&o!==(o=se[0].searchLabel)&&re(r,"placeholder",o),le[0]&18&&u!==(u=!!(se[4]&&se[1].length))&&re(r,"aria-expanded",u),le[0]&67108864&&b!==(b=se[26]?`emo-${se[26]}`:"")&&re(r,"aria-activedescendant",b),le[0]&4&&Bc(r,se[2]),le[0]&1&&p!==(p=se[0].searchLabel+"")&&za(c,p),le[0]&1&&A!==(A=se[0].searchDescription+"")&&za(i,A),le[0]&2097152&&za(B,se[21]),le[0]&64&&f!==(f="emoji "+(se[6]?"hide-focus":""))&&re(L,"class",f),le[0]&8388608&&re(L,"aria-label",se[23]),le[0]&8388608&&re(L,"title",se[23]),le[0]&64&&re(L,"aria-expanded",se[6]),le[0]&524288&&R!==(R="skintone-button-wrapper "+(se[19]?"expanded":""))&&re(F,"class",R),le[0]&1&&T!==(T=se[0].skinToneDescription+"")&&za(N,T),le[0]&1049089&&(be=se[9],k=Dr(k,le,ke,1,se,be,S,m,Ur,zc,null,qc)),le[0]&64&&h!==(h="skintone-list "+(se[6]?"":"hidden no-animate"))&&re(m,"class",h),le[0]&64&&os(m,"transform","translateY("+(se[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),le[0]&1&&g!==(g=se[0].skinTonesLabel)&&re(m,"aria-label",g),le[0]&1048576&&_!==(_="skintone-"+se[20])&&re(m,"aria-activedescendant",_),le[0]&64&&v!==(v=!se[6])&&re(m,"aria-hidden",v),le[0]&12305|le[1]&1&&(pe=se[12],w=Dr(w,le,De,1,se,pe,j,y,Ur,Yc,null,Vc)),le[0]&4096&&os(y,"grid-template-columns","repeat("+se[12].length+", 1fr)"),le[0]&1&&K!==(K=se[0].categoriesLabel)&&re(y,"aria-label",K),le[0]&16779264&&os(z,"transform","translateX("+(se[24]?-1:1)*se[11]*100+"%)"),le[0]&262144&&za(M,se[18]),le[0]&262144&&W!==(W="message "+(se[18]?"":"gone"))&&re(d,"class",W),le[0]&402694449&&(He=se[15],Ae=Dr(Ae,le,fe,1,se,He,Re,_e,Ur,Kc,null,Uc)),le[0]&278528&&ge!==(ge="tabpanel "+(!se[14]||se[18]?"gone":""))&&re($,"class",ge),le[0]&16&&Ve!==(Ve=se[4]?"region":"tabpanel")&&re($,"role",Ve),le[0]&8209&&Ne!==(Ne=se[4]?se[0].searchResultsLabel:se[0].categories[se[13].name])&&re($,"aria-label",Ne),le[0]&8208&&he!==(he=se[4]?"":`tab-${se[13].id}`)&&re($,"id",he),le[0]&402654464&&(ae=se[10],it=Dr(it,le,ve,1,se,ae,U,Ke,Ur,Gc,null,Pc)),le[0]&262144&&Y!==(Y="favorites emoji-menu "+(se[18]?"gone":""))&&re(Ke,"class",Y),le[0]&1&&te!==(te=se[0].favoritesLabel)&&re(Ke,"aria-label",te),le[0]&33554432&&os(Ke,"padding-inline-end",se[25]+"px"),le[0]&1&&me!==(me=se[0].regionLabel)&&re(t,"aria-label",me),le[0]&4194304&&re(t,"style",se[22])},i:cn,o:cn,d(se){se&&Na(t);for(let le=0;le<k.length;le+=1)k[le].d();e[48](null);for(let le=0;le<w.length;le+=1)w[le].d();for(let le=0;le<Ae.length;le+=1)Ae[le].d();e[50](null);for(let le=0;le<it.length;le+=1)it[le].d();e[51](null),e[52](null),Ee=!1,En(xe)}}}function Q_(e,t,a){let{skinToneEmoji:s}=t,{i18n:n}=t,{database:r}=t,{customEmoji:o}=t,{customCategorySorting:u}=t,b=!0,l=[],p=[],c="",E="",A,i,F,L=!1,B=-1,f,R=!1,C=!1,T,N=0,m=0,k,S,h="",g=[],_=[],v,y=x_,w=!1,j=0,K=0,P=Hn,z,d=!1,M;const W=Q=>{A.getRootNode().getElementById(Q).focus()},$=(Q,Oe)=>{A.dispatchEvent(new CustomEvent(Q,{detail:Oe,bubbles:!0,composed:!0}))},_e=(Q,Oe)=>Oe&&Q.skins&&Q.skins[Oe]||Q.unicode,Ae=(Q,Oe)=>Y_([Q.name||_e(Q,Oe),...Q.shortcodes||[]]).join(", "),Re=Q=>/^skintone-/.test(Q.id);io.then(Q=>{Q||a(18,f=n.emojiUnsupportedMessage)});function ge(Q){return q_(Q,Oe=>{{const x=getComputedStyle(A),I=parseInt(x.getPropertyValue("--num-columns"),10),D=x.getPropertyValue("direction")==="rtl",X=Q.parentElement.getBoundingClientRect().width-Oe;a(46,y=I),a(25,j=X),a(24,w=D)}})}function Ve(Q){const Oe=A.getRootNode();z_(Q,i,I=>Oe.getElementById(`emo-${I.id}`)),a(1,l=l)}function Ne(Q){return!Q.unicode||!jc(Q)||Yo.get(Q.unicode)}async function he(Q){const Oe=await io;return Q.filter(({version:x})=>!x||x<=Oe)}async function Ke(Q){return D_(Q,await io)}async function it(Q){if(typeof Q>"u")return[];const Oe=Q===-1?o:await r.getEmojiByGroup(Q);return Ke(await he(Oe))}async function U(Q){return Ke(await he(await r.getEmojiBySearchQuery(Q)))}function Y(Q){if(!L||!l.length)return;const Oe=x=>{ls(Q),a(5,B=oo(x,B,l))};switch(Q.key){case"ArrowDown":return Oe(!1);case"ArrowUp":return Oe(!0);case"Enter":if(B!==-1)return ls(Q),me(l[B].id);l.length&&a(5,B=0)}}function te(Q){a(2,c=""),a(44,E=""),a(5,B=-1),a(11,K=P.findIndex(Oe=>Oe.id===Q.id))}function de(Q){const{target:Oe,key:x}=Q,I=D=>{D&&(ls(Q),D.focus())};switch(x){case"ArrowLeft":return I(Oe.previousSibling);case"ArrowRight":return I(Oe.nextSibling);case"Home":return I(Oe.parentElement.firstChild);case"End":return I(Oe.parentElement.lastChild)}}async function me(Q){const Oe=await r.getEmojiByUnicodeOrName(Q),x=[...l,..._].find(D=>D.id===Q),I=x.unicode&&_e(x,N);await r.incrementFavoriteEmojiCount(Q),$("emoji-click",{emoji:Oe,skinTone:N,...I&&{unicode:I},...x.name&&{name:x.name}})}async function Ee(Q){const{target:Oe}=Q;if(!Oe.classList.contains("emoji"))return;ls(Q);const x=Oe.id.substring(4);me(x)}async function xe(Q){const{target:Oe}=Q;if(!Re(Oe))return;ls(Q);const x=parseInt(Oe.id.slice(9),10);a(8,N=x),a(6,R=!1),W("skintone-button"),$("skin-tone-change",{skinTone:x}),r.setPreferredSkinTone(x)}async function be(Q){a(6,R=!R),a(20,m=N),R&&(ls(Q),Jn(()=>W(`skintone-${m}`)))}function ke(Q){if(!R)return;const Oe=async x=>{ls(Q),a(20,m=x),await h_(),W(`skintone-${m}`)};switch(Q.key){case"ArrowUp":return Oe(oo(!0,m,g));case"ArrowDown":return Oe(oo(!1,m,g));case"Home":return Oe(0);case"End":return Oe(g.length-1);case"Enter":return xe(Q);case"Escape":return ls(Q),a(6,R=!1),W("skintone-button")}}function pe(Q){if(R)switch(Q.key){case" ":return xe(Q)}}async function De(Q){const{relatedTarget:Oe}=Q;(!Oe||!Re(Oe))&&a(6,R=!1)}function He(){c=this.value,a(2,c)}function fe(Q){or[Q?"unshift":"push"](()=>{T=Q,a(7,T)})}const ae=Q=>te(Q);function ve(Q){or[Q?"unshift":"push"](()=>{F=Q,a(3,F)})}function se(Q){or[Q?"unshift":"push"](()=>{i=Q,a(17,i)})}function le(Q){or[Q?"unshift":"push"](()=>{A=Q,a(16,A)})}return e.$$set=Q=>{"skinToneEmoji"in Q&&a(40,s=Q.skinToneEmoji),"i18n"in Q&&a(0,n=Q.i18n),"database"in Q&&a(39,r=Q.database),"customEmoji"in Q&&a(41,o=Q.customEmoji),"customCategorySorting"in Q&&a(42,u=Q.customCategorySorting)},e.$$.update=()=>{if(e.$$.dirty[1]&1280&&o&&r&&a(39,r.customEmoji=o,r),e.$$.dirty[0]&1|e.$$.dirty[1]&256){async function Q(){let Oe=!1;const x=setTimeout(()=>{Oe=!0,a(18,f=n.loadingMessage)},T_);try{await r.ready(),a(14,d=!0)}catch(I){console.error(I),a(18,f=n.networkErrorMessage)}finally{clearTimeout(x),Oe&&(Oe=!1,a(18,f=""))}}r&&Q()}if(e.$$.dirty[0]&6144|e.$$.dirty[1]&1024&&(o&&o.length?a(12,P=[E_,...Hn]):P!==Hn&&(K&&a(11,K--,K),a(12,P=Hn))),e.$$.dirty[0]&4&&yu(()=>{a(44,E=(c||"").trim()),a(5,B=-1)}),e.$$.dirty[0]&6144&&a(13,z=P[K]),e.$$.dirty[0]&24576|e.$$.dirty[1]&8192){async function Q(){if(!d)a(1,l=[]),a(4,L=!1);else if(E.length>=A_){const Oe=E,x=await U(Oe);Oe===E&&(a(1,l=x),a(4,L=!0))}else if(z){const Oe=z.id,x=await it(Oe);Oe===z.id&&(a(1,l=x),a(4,L=!1))}}Q()}if(e.$$.dirty[0]&4112&&a(22,S=`
  --font-family: ${wu};
  --num-groups: ${P.length}; 
  --indicator-opacity: ${L?0:1}; 
  --num-skintones: ${Nc};`),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function Q(){d&&a(8,N=await r.getPreferredSkinTone())}Q()}if(e.$$.dirty[1]&512&&a(9,g=Array(Nc).fill().map((Q,Oe)=>U_(s,Oe))),e.$$.dirty[0]&768&&a(21,k=g[N]),e.$$.dirty[0]&257&&a(23,h=n.skinToneLabel.replace("{skinTone}",n.skinTones[N])),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function Q(){a(45,v=(await Promise.all(O_.map(Oe=>r.getEmojiByUnicodeOrName(Oe)))).filter(Boolean))}d&&Q()}if(e.$$.dirty[0]&16384|e.$$.dirty[1]&49408){async function Q(){const Oe=await r.getTopFavoriteEmoji(y),x=await Ke(Su([...Oe,...v],I=>I.unicode||I.name).slice(0,y));a(10,_=x)}d&&v&&Q()}if(e.$$.dirty[0]&10){const Q=l.filter(Oe=>Oe.unicode).filter(Oe=>jc(Oe)&&!Yo.has(Oe.unicode));Q.length?Jn(()=>Ve(Q)):(a(1,l=l.filter(Ne)),Jn(()=>{(F||{}).scrollTop=0}))}e.$$.dirty[0]&1026|e.$$.dirty[1]&4096,e.$$.dirty[0]&18|e.$$.dirty[1]&2048&&a(15,p=function(){if(L)return[{category:"",emojis:l}];const Oe=new Map;for(const x of l){const I=x.category||"";let D=Oe.get(I);D||(D=[],Oe.set(I,D)),D.push(x)}return[...Oe.entries()].map(([x,I])=>({category:x,emojis:I})).sort((x,I)=>u(x.category,I.category))}()),e.$$.dirty[0]&34&&a(26,M=B!==-1&&l[B].id),e.$$.dirty[0]&192&&(R?T.addEventListener("transitionend",()=>{a(19,C=!0)},{once:!0}):a(19,C=!1))},[n,l,c,F,L,B,R,T,N,g,_,K,P,z,d,p,A,i,f,C,m,k,S,h,w,j,M,_e,Ae,ge,Y,te,de,Ee,xe,be,ke,pe,De,r,s,o,u,b,E,v,y,He,fe,ae,ve,se,le]}class $_ extends M_{constructor(t){super(),S_(this,t,Q_,W_,d_,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const J_="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",e3="en";var t3={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Mu=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Eu extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const a=document.createElement("style");a.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(a),this._ctx={locale:e3,dataSource:J_,skinToneEmoji:R_,customCategorySorting:I_,customEmoji:null,i18n:t3,...t};for(const s of Mu)s!=="database"&&Object.prototype.hasOwnProperty.call(this,s)&&(this._ctx[s]=this[s],delete this[s]);this._dbFlush()}connectedCallback(){this._cmp=new $_({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t&&t.close().catch(a=>console.error(a))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(t,a,s){this._set(t.replace(/-([a-z])/g,(n,r)=>r.toUpperCase()),s)}_set(t,a){this._ctx[t]=a,this._cmp&&this._cmp.$set({[t]:a}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:a,database:s}=this._ctx;(!s||s.locale!==t||s.dataSource!==a)&&this._set("database",new fu({locale:t,dataSource:a}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const Au={};for(const e of Mu)Au[e]={get(){return e==="database"&&this._dbCreate(),this._ctx[e]},set(t){if(e==="database")throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(Eu.prototype,Au);customElements.get("emoji-picker")||customElements.define("emoji-picker",Eu);function ku(e,t){for(;e&&!e.querySelector(t);){e=e.parentNode;const a=e.querySelector(t);if(a)return a}return null}const a3={name:"EmojiPickerContainer",components:{SvgIcon:zt},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:t})=>{this.$emit("add-emoji",{unicode:t.unicode})})},0)}},methods:{addCustomStyling(){const e=`.picker {
				border: none;
			}`,t=`.nav {
				overflow-x: auto;
			}`,a=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,s=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,n=document.createElement("style");n.textContent=e+t+a+s,this.$refs.emojiPicker.shadowRoot.appendChild(n)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,a){const s=t<500||a<700,n=ku(this.$el,"#room-footer");if(!n){s&&(this.emojiPickerRight="-50px");return}s?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=a-200):(n.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},s3={class:"vac-emoji-wrapper"};function r3(e,t,a,s,n,r){const o=Ge("svg-icon"),u=Ge("emoji-picker");return ee(),ue("div",s3,[Me("div",{class:rt(["vac-svg-button",{"vac-emoji-reaction":a.emojiReaction}]),onClick:t[0]||(t[0]=(...b)=>r.openEmoji&&r.openEmoji(...b))},[Le(e.$slots,a.messageId?"emoji-picker-reaction-icon_"+a.messageId:"emoji-picker-icon",{},()=>[Fe(o,{name:"emoji",param:a.emojiReaction?"reaction":""},null,8,["param"])])],2),a.emojiOpened?(ee(),gt(Ht,{key:0,name:"vac-slide-up",appear:""},{default:Ze(()=>[Me("div",{class:rt(["vac-emoji-picker",{"vac-picker-reaction":a.emojiReaction}]),style:Ot({height:`${n.emojiPickerHeight}px`,top:a.positionTop?n.emojiPickerHeight:`${n.emojiPickerTop}px`,right:n.emojiPickerRight,display:n.emojiPickerTop||!a.emojiReaction?"initial":"none"})},[a.emojiOpened?(ee(),gt(u,{key:0,ref:"emojiPicker","data-source":a.emojiDataSource},null,8,["data-source"])):Ce("",!0)],6)]),_:1})):Ce("",!0)])}var Tu=Tt(a3,[["render",r3]]);const n3={name:"RoomFiles",components:{Loader:Ei,SvgIcon:zt},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return _r(this.file)},isVideo(){return Mn(this.file)}}},i3={class:"vac-room-file-container"},o3=["src"],l3={class:"vac-text-ellipsis"},c3={key:0,class:"vac-text-ellipsis vac-text-extension"};function u3(e,t,a,s,n,r){const o=Ge("loader"),u=Ge("svg-icon");return ee(),ue("div",i3,[Fe(o,{show:a.file.loading,type:"room-file"},Mt({_:2},[at(e.$slots,(b,l)=>({name:l,fn:Ze(p=>[Le(e.$slots,l,St(bt(p)))])}))]),1032,["show"]),Me("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=b=>e.$emit("remove-file",a.index))},[Le(e.$slots,"image-close-icon",{},()=>[Fe(u,{name:"close",param:"image"})])]),r.isImage?(ee(),ue("div",{key:0,class:rt(["vac-message-image",{"vac-blur-loading":a.file.loading}]),style:Ot({"background-image":`url('${a.file.localUrl||a.file.url}')`})},null,6)):r.isVideo?(ee(),ue("video",{key:1,controls:"",class:rt({"vac-blur-loading":a.file.loading})},[Me("source",{src:a.file.localUrl||a.file.url},null,8,o3)],2)):(ee(),ue("div",{key:2,class:rt(["vac-file-container",{"vac-blur-loading":a.file.loading}])},[Me("div",null,[Le(e.$slots,"file-icon",{},()=>[Fe(u,{name:"file"})])]),Me("div",l3,$e(a.file.name),1),a.file.extension?(ee(),ue("div",c3,$e(a.file.extension),1)):Ce("",!0)],2))])}var d3=Tt(n3,[["render",u3]]);const m3={name:"RoomFiles",components:{SvgIcon:zt,RoomFile:d3},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},f3={key:0,class:"vac-room-files-container"},h3={class:"vac-files-box"},v3={class:"vac-icon-close"};function _3(e,t,a,s,n,r){const o=Ge("room-file"),u=Ge("svg-icon");return ee(),gt(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.files.length?(ee(),ue("div",f3,[Me("div",h3,[(ee(!0),ue(ft,null,at(a.files,(b,l)=>(ee(),ue("div",{key:l},[Fe(o,{file:b,index:l,onRemoveFile:t[0]||(t[0]=p=>e.$emit("remove-file",p))},Mt({_:2},[at(e.$slots,(p,c)=>({name:c,fn:Ze(E=>[Le(e.$slots,c,St(bt(E)))])}))]),1032,["file","index"])]))),128))]),Me("div",v3,[Me("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=b=>e.$emit("reset-message"))},[Le(e.$slots,"files-close-icon",{},()=>[Fe(u,{name:"close-outline"})])])])])):Ce("",!0)]),_:3})}var p3=Tt(m3,[["render",_3]]);const g3={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const a=t.getBoundingClientRect().width,s=t.getBoundingClientRect().left;let n=(e.clientX-s)/a;return n=n<0?0:n,n=n>1?1:n,n}}},b3={class:"vac-player-progress"},y3={class:"vac-line-container"};function w3(e,t,a,s,n,r){return ee(),ue("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...o)=>r.onMouseDown&&r.onMouseDown(...o)),onMouseover:t[1]||(t[1]=o=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=o=>e.$emit("hover-audio-progress",!1))},[Me("div",b3,[Me("div",y3,[Me("div",{class:"vac-line-progress",style:Ot({width:`${a.percentage}%`})},null,4),Me("div",{class:rt(["vac-line-dot",{"vac-line-dot__active":n.isMouseDown}]),style:Ot({left:`${a.percentage}%`})},null,6)])])],544)}var S3=Tt(g3,[["render",w3]]);const M3={name:"AudioPlayer",components:{SvgIcon:zt,AudioControl:S3},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(e*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},E3={class:"vac-audio-player"},A3=["id","src"];function k3(e,t,a,s,n,r){const o=Ge("svg-icon"),u=Ge("audio-control");return ee(),ue("div",null,[Me("div",E3,[Me("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...b)=>r.playback&&r.playback(...b))},[n.isPlaying?Le(e.$slots,"audio-pause-icon_"+a.messageId,{key:0},()=>[Fe(o,{name:"audio-pause"})]):Le(e.$slots,"audio-play-icon_"+a.messageId,{key:1},()=>[Fe(o,{name:"audio-play"})])]),Fe(u,{percentage:n.progress,"message-selection-enabled":a.messageSelectionEnabled,onChangeLinehead:r.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=b=>e.$emit("hover-audio-progress",b))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Me("audio",{id:r.playerUniqId,src:r.audioSource},null,8,A3)])])}var Bl=Tt(M3,[["render",k3]]);const T3={name:"RoomMessageReply",components:{SvgIcon:zt,FormatMessage:Sn,AudioPlayer:Bl},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(t=(e=this.messageReply)==null?void 0:e.files)!=null&&t.length?this.messageReply.files[0]:{}},isImage(){return _r(this.firstFile)},isVideo(){return Mn(this.firstFile)},isAudio(){return Li(this.firstFile)},isOtherFile(){var e,t;return((t=(e=this.messageReply)==null?void 0:e.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},R3={key:0,class:"vac-reply-container"},x3={class:"vac-reply-box"},O3={class:"vac-reply-info"},I3={class:"vac-reply-username"},C3={class:"vac-reply-content"},B3=["src"],L3={key:1,controls:"",class:"vac-image-reply"},N3=["src"],j3={key:3,class:"vac-image-reply vac-file-container"},F3={class:"vac-text-ellipsis"},H3={key:0,class:"vac-text-ellipsis vac-text-extension"},P3={class:"vac-icon-reply"};function U3(e,t,a,s,n,r){const o=Ge("format-message"),u=Ge("audio-player"),b=Ge("svg-icon");return ee(),gt(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.messageReply?(ee(),ue("div",R3,[Me("div",x3,[Me("div",O3,[Me("div",I3,$e(a.messageReply.username),1),Me("div",C3,[Fe(o,{"message-id":a.messageReply._id,content:a.messageReply.content,users:a.room.users,"text-formatting":a.textFormatting,"link-options":a.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),r.isImage?(ee(),ue("img",{key:0,src:r.firstFile.url,class:"vac-image-reply"},null,8,B3)):r.isVideo?(ee(),ue("video",L3,[Me("source",{src:r.firstFile.url},null,8,N3)])):r.isAudio?(ee(),gt(u,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["src"])):r.isOtherFile?(ee(),ue("div",j3,[Me("div",null,[Le(e.$slots,"file-icon",{},()=>[Fe(b,{name:"file"})])]),Me("div",F3,$e(r.firstFile.name),1),r.firstFile.extension?(ee(),ue("div",H3,$e(r.firstFile.extension),1)):Ce("",!0)])):Ce("",!0)]),Me("div",P3,[Me("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=l=>e.$emit("reset-message"))},[Le(e.$slots,"reply-close-icon",{},()=>[Fe(b,{name:"close-outline"})])])])])):Ce("",!0)]),_:3})}var D3=Tt(T3,[["render",U3]]);const V3={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},q3={key:0,class:"vac-tags-container"},z3=["onMouseover","onClick"],Y3={class:"vac-tags-info"},X3={class:"vac-tags-username"};function K3(e,t,a,s,n,r){return ee(),gt(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.filteredUsersTag.length?(ee(),ue("div",q3,[(ee(!0),ue(ft,null,at(a.filteredUsersTag,(o,u)=>(ee(),ue("div",{key:o._id,class:rt(["vac-tags-box",{"vac-tags-box-active":u===n.activeItem}]),onMouseover:b=>n.activeItem=u,onClick:b=>e.$emit("select-user-tag",o)},[Me("div",Y3,[o.avatar?(ee(),ue("div",{key:0,class:"vac-avatar vac-tags-avatar",style:Ot({"background-image":`url('${o.avatar}')`})},null,4)):Ce("",!0),Me("div",X3,$e(o.username),1)])],42,z3))),128))])):Ce("",!0)]),_:1})}var G3=Tt(V3,[["render",K3]]);const Z3={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},W3={key:0,class:"vac-emojis-container"},Q3=["onMouseover","onClick"];function $3(e,t,a,s,n,r){return ee(),gt(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.filteredEmojis.length?(ee(),ue("div",W3,[(ee(!0),ue(ft,null,at(a.filteredEmojis,(o,u)=>(ee(),ue("div",{key:o,class:rt(["vac-emoji-element",{"vac-emoji-element-active":u===n.activeItem}]),onMouseover:b=>n.activeItem=u,onClick:b=>e.$emit("select-emoji",o)},$e(o),43,Q3))),128))])):Ce("",!0)]),_:1})}var J3=Tt(Z3,[["render",$3]]);const ep={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},tp={key:0,class:"vac-template-container vac-app-box-shadow"},ap=["onMouseover","onClick"],sp={class:"vac-template-info"},rp={class:"vac-template-tag"},np={class:"vac-template-text"};function ip(e,t,a,s,n,r){return ee(),gt(Ht,{name:"vac-slide-up"},{default:Ze(()=>[a.filteredTemplatesText.length?(ee(),ue("div",tp,[(ee(!0),ue(ft,null,at(a.filteredTemplatesText,(o,u)=>(ee(),ue("div",{key:u,class:rt(["vac-template-box",{"vac-template-active":u===n.activeItem}]),onMouseover:b=>n.activeItem=u,onClick:b=>e.$emit("select-template-text",o)},[Me("div",sp,[Me("div",rp," /"+$e(o.tag),1),Me("div",np,$e(o.text),1)])],42,ap))),128))])):Ce("",!0)]),_:1})}var op=Tt(ep,[["render",ip]]);function lp(e){return new Int8Array(e)}function Ru(e){return new Int16Array(e)}function xu(e){return new Int32Array(e)}function Ou(e){return new Float32Array(e)}function cp(e){return new Float64Array(e)}function Iu(e){if(e.length==1)return Ou(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(Iu(e));return a}function Cu(e){if(e.length==1)return xu(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(Cu(e));return a}function Bu(e){if(e.length==1)return Ru(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(Bu(e));return a}function Lu(e){if(e.length==1)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(Lu(e));return a}var Nu={};Nu.fill=function(e,t,a,s){if(arguments.length==2)for(var n=0;n<e.length;n++)e[n]=arguments[1];else for(var n=t;n<a;n++)e[n]=s};var An={};An.arraycopy=function(e,t,a,s,n){for(var r=t+n;t<r;)a[s++]=e[t++]};An.out={};An.out.println=function(e){console.log(e)};An.out.printf=function(){console.log.apply(console,arguments)};var Ni={};Ni.SQRT2=1.4142135623730951;Ni.FAST_LOG10=function(e){return Math.log10(e)};Ni.FAST_LOG10_X=function(e,t){return Math.log10(e)*t};function as(e){this.ordinal=e}as.short_block_allowed=new as(0);as.short_block_coupled=new as(1);as.short_block_dispensed=new as(2);as.short_block_forced=new as(3);var ju={};ju.MAX_VALUE=34028235e31;function ba(e){this.ordinal=e}ba.vbr_off=new ba(0);ba.vbr_mt=new ba(1);ba.vbr_rh=new ba(2);ba.vbr_abr=new ba(3);ba.vbr_mtrh=new ba(4);ba.vbr_default=ba.vbr_mtrh;var up=function(e){},Ie={System:An,VbrMode:ba,Float:ju,ShortBlock:as,Util:Ni,Arrays:Nu,new_array_n:Lu,new_byte:lp,new_double:cp,new_float:Ou,new_float_n:Iu,new_int:xu,new_int_n:Cu,new_short:Ru,new_short_n:Bu,assert:up},dp=Ie.System,Nt=Ie.Util,mp=Ie.Arrays,fp=Ie.new_float;function hp(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Nt.SQRT2*.5/2384e-9,.017876148*Nt.SQRT2*.5/2384e-9,.003134727*Nt.SQRT2*.5/2384e-9,.002457142*Nt.SQRT2*.5/2384e-9,971317e-9*Nt.SQRT2*.5/2384e-9,218868e-9*Nt.SQRT2*.5/2384e-9,101566e-9*Nt.SQRT2*.5/2384e-9,13828e-9*Nt.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,a=36,s=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],n=s[O.SHORT_TYPE],r=s[O.SHORT_TYPE],o=s[O.SHORT_TYPE],u=s[O.SHORT_TYPE],b=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function l(E,A,i){for(var F=10,L=A+238-14-286,B=-15;B<0;B++){var f,R,C;f=e[F+-10],R=E[L+-224]*f,C=E[A+224]*f,f=e[F+-9],R+=E[L+-160]*f,C+=E[A+160]*f,f=e[F+-8],R+=E[L+-96]*f,C+=E[A+96]*f,f=e[F+-7],R+=E[L+-32]*f,C+=E[A+32]*f,f=e[F+-6],R+=E[L+32]*f,C+=E[A+-32]*f,f=e[F+-5],R+=E[L+96]*f,C+=E[A+-96]*f,f=e[F+-4],R+=E[L+160]*f,C+=E[A+-160]*f,f=e[F+-3],R+=E[L+224]*f,C+=E[A+-224]*f,f=e[F+-2],R+=E[A+-256]*f,C-=E[L+256]*f,f=e[F+-1],R+=E[A+-192]*f,C-=E[L+192]*f,f=e[F+0],R+=E[A+-128]*f,C-=E[L+128]*f,f=e[F+1],R+=E[A+-64]*f,C-=E[L+64]*f,f=e[F+2],R+=E[A+0]*f,C-=E[L+0]*f,f=e[F+3],R+=E[A+64]*f,C-=E[L+-64]*f,f=e[F+4],R+=E[A+128]*f,C-=E[L+-128]*f,f=e[F+5],R+=E[A+192]*f,C-=E[L+-192]*f,R*=e[F+6],f=C-R,i[30+B*2]=C+R,i[31+B*2]=e[F+7]*f,F+=18,A--,L++}{var R,C,T,N;C=E[A+-16]*e[F+-10],R=E[A+-32]*e[F+-2],C+=(E[A+-48]-E[A+16])*e[F+-9],R+=E[A+-96]*e[F+-1],C+=(E[A+-80]+E[A+48])*e[F+-8],R+=E[A+-160]*e[F+0],C+=(E[A+-112]-E[A+80])*e[F+-7],R+=E[A+-224]*e[F+1],C+=(E[A+-144]+E[A+112])*e[F+-6],R-=E[A+32]*e[F+2],C+=(E[A+-176]-E[A+144])*e[F+-5],R-=E[A+96]*e[F+3],C+=(E[A+-208]+E[A+176])*e[F+-4],R-=E[A+160]*e[F+4],C+=(E[A+-240]-E[A+208])*e[F+-3],R-=E[A+224],T=R-C,N=R+C,C=i[14],R=i[15]-C,i[31]=N+C,i[30]=T+R,i[15]=T-R,i[14]=N-C}{var m;m=i[28]-i[0],i[0]+=i[28],i[28]=m*e[F+-2*18+7],m=i[29]-i[1],i[1]+=i[29],i[29]=m*e[F+-2*18+7],m=i[26]-i[2],i[2]+=i[26],i[26]=m*e[F+-4*18+7],m=i[27]-i[3],i[3]+=i[27],i[27]=m*e[F+-4*18+7],m=i[24]-i[4],i[4]+=i[24],i[24]=m*e[F+-6*18+7],m=i[25]-i[5],i[5]+=i[25],i[25]=m*e[F+-6*18+7],m=i[22]-i[6],i[6]+=i[22],i[22]=m*Nt.SQRT2,m=i[23]-i[7],i[7]+=i[23],i[23]=m*Nt.SQRT2-i[7],i[7]-=i[6],i[22]-=i[7],i[23]-=i[22],m=i[6],i[6]=i[31]-m,i[31]=i[31]+m,m=i[7],i[7]=i[30]-m,i[30]=i[30]+m,m=i[22],i[22]=i[15]-m,i[15]=i[15]+m,m=i[23],i[23]=i[14]-m,i[14]=i[14]+m,m=i[20]-i[8],i[8]+=i[20],i[20]=m*e[F+-10*18+7],m=i[21]-i[9],i[9]+=i[21],i[21]=m*e[F+-10*18+7],m=i[18]-i[10],i[10]+=i[18],i[18]=m*e[F+-12*18+7],m=i[19]-i[11],i[11]+=i[19],i[19]=m*e[F+-12*18+7],m=i[16]-i[12],i[12]+=i[16],i[16]=m*e[F+-14*18+7],m=i[17]-i[13],i[13]+=i[17],i[17]=m*e[F+-14*18+7],m=-i[20]+i[24],i[20]+=i[24],i[24]=m*e[F+-12*18+7],m=-i[21]+i[25],i[21]+=i[25],i[25]=m*e[F+-12*18+7],m=i[4]-i[8],i[4]+=i[8],i[8]=m*e[F+-12*18+7],m=i[5]-i[9],i[5]+=i[9],i[9]=m*e[F+-12*18+7],m=i[0]-i[12],i[0]+=i[12],i[12]=m*e[F+-4*18+7],m=i[1]-i[13],i[1]+=i[13],i[13]=m*e[F+-4*18+7],m=i[16]-i[28],i[16]+=i[28],i[28]=m*e[F+-4*18+7],m=-i[17]+i[29],i[17]+=i[29],i[29]=m*e[F+-4*18+7],m=Nt.SQRT2*(i[2]-i[10]),i[2]+=i[10],i[10]=m,m=Nt.SQRT2*(i[3]-i[11]),i[3]+=i[11],i[11]=m,m=Nt.SQRT2*(-i[18]+i[26]),i[18]+=i[26],i[26]=m-i[18],m=Nt.SQRT2*(-i[19]+i[27]),i[19]+=i[27],i[27]=m-i[19],m=i[2],i[19]-=i[3],i[3]-=m,i[2]=i[31]-m,i[31]+=m,m=i[3],i[11]-=i[19],i[18]-=m,i[3]=i[30]-m,i[30]+=m,m=i[18],i[27]-=i[11],i[19]-=m,i[18]=i[15]-m,i[15]+=m,m=i[19],i[10]-=m,i[19]=i[14]-m,i[14]+=m,m=i[10],i[11]-=m,i[10]=i[23]-m,i[23]+=m,m=i[11],i[26]-=m,i[11]=i[22]-m,i[22]+=m,m=i[26],i[27]-=m,i[26]=i[7]-m,i[7]+=m,m=i[27],i[27]=i[6]-m,i[6]+=m,m=Nt.SQRT2*(i[0]-i[4]),i[0]+=i[4],i[4]=m,m=Nt.SQRT2*(i[1]-i[5]),i[1]+=i[5],i[5]=m,m=Nt.SQRT2*(i[16]-i[20]),i[16]+=i[20],i[20]=m,m=Nt.SQRT2*(i[17]-i[21]),i[17]+=i[21],i[21]=m,m=-Nt.SQRT2*(i[8]-i[12]),i[8]+=i[12],i[12]=m-i[8],m=-Nt.SQRT2*(i[9]-i[13]),i[9]+=i[13],i[13]=m-i[9],m=-Nt.SQRT2*(i[25]-i[29]),i[25]+=i[29],i[29]=m-i[25],m=-Nt.SQRT2*(i[24]+i[28]),i[24]-=i[28],i[28]=m-i[24],m=i[24]-i[16],i[24]=m,m=i[20]-m,i[20]=m,m=i[28]-m,i[28]=m,m=i[25]-i[17],i[25]=m,m=i[21]-m,i[21]=m,m=i[29]-m,i[29]=m,m=i[17]-i[1],i[17]=m,m=i[9]-m,i[9]=m,m=i[25]-m,i[25]=m,m=i[5]-m,i[5]=m,m=i[21]-m,i[21]=m,m=i[13]-m,i[13]=m,m=i[29]-m,i[29]=m,m=i[1]-i[0],i[1]=m,m=i[16]-m,i[16]=m,m=i[17]-m,i[17]=m,m=i[8]-m,i[8]=m,m=i[9]-m,i[9]=m,m=i[24]-m,i[24]=m,m=i[25]-m,i[25]=m,m=i[4]-m,i[4]=m,m=i[5]-m,i[5]=m,m=i[20]-m,i[20]=m,m=i[21]-m,i[21]=m,m=i[12]-m,i[12]=m,m=i[13]-m,i[13]=m,m=i[28]-m,i[28]=m,m=i[29]-m,i[29]=m,m=i[0],i[0]+=i[31],i[31]-=m,m=i[1],i[1]+=i[30],i[30]-=m,m=i[16],i[16]+=i[15],i[15]-=m,m=i[17],i[17]+=i[14],i[14]-=m,m=i[8],i[8]+=i[23],i[23]-=m,m=i[9],i[9]+=i[22],i[22]-=m,m=i[24],i[24]+=i[7],i[7]-=m,m=i[25],i[25]+=i[6],i[6]-=m,m=i[4],i[4]+=i[27],i[27]-=m,m=i[5],i[5]+=i[26],i[26]-=m,m=i[20],i[20]+=i[11],i[11]-=m,m=i[21],i[21]+=i[10],i[10]-=m,m=i[12],i[12]+=i[19],i[19]-=m,m=i[13],i[13]+=i[18],i[18]-=m,m=i[28],i[28]+=i[3],i[3]-=m,m=i[29],i[29]+=i[2],i[2]-=m}}function p(E,A){for(var i=0;i<3;i++){var F,L,B,f,R,C;f=E[A+2*3]*s[O.SHORT_TYPE][0]-E[A+5*3],F=E[A+0*3]*s[O.SHORT_TYPE][2]-E[A+3*3],L=f+F,B=f-F,f=E[A+5*3]*s[O.SHORT_TYPE][0]+E[A+2*3],F=E[A+3*3]*s[O.SHORT_TYPE][2]+E[A+0*3],R=f+F,C=-f+F,F=(E[A+1*3]*s[O.SHORT_TYPE][1]-E[A+4*3])*2069978111953089e-26,f=(E[A+4*3]*s[O.SHORT_TYPE][1]+E[A+1*3])*2069978111953089e-26,E[A+3*0]=L*190752519173728e-25+F,E[A+3*5]=-R*190752519173728e-25+f,B=B*.8660254037844387*1907525191737281e-26,R=R*.5*1907525191737281e-26+f,E[A+3*1]=B-R,E[A+3*2]=B+R,L=L*.5*1907525191737281e-26-F,C=C*.8660254037844387*1907525191737281e-26,E[A+3*3]=L+C,E[A+3*4]=L-C,A++}}function c(E,A,i){var F,L;{var B,f,R,C,T,N,m,k;B=i[17]-i[9],R=i[15]-i[11],C=i[14]-i[12],T=i[0]+i[8],N=i[1]+i[7],m=i[2]+i[6],k=i[3]+i[5],E[A+17]=T+m-k-(N-i[4]),L=(T+m-k)*r[12+7]+(N-i[4]),F=(B-R-C)*r[12+6],E[A+5]=F+L,E[A+6]=F-L,f=(i[16]-i[10])*r[12+6],N=N*r[12+7]+i[4],F=B*r[12+0]+f+R*r[12+1]+C*r[12+2],L=-T*r[12+4]+N-m*r[12+5]+k*r[12+3],E[A+1]=F+L,E[A+2]=F-L,F=B*r[12+1]-f-R*r[12+2]+C*r[12+0],L=-T*r[12+5]+N-m*r[12+3]+k*r[12+4],E[A+9]=F+L,E[A+10]=F-L,F=B*r[12+2]-f+R*r[12+0]-C*r[12+1],L=T*r[12+3]-N+m*r[12+4]-k*r[12+5],E[A+13]=F+L,E[A+14]=F-L}{var S,h,g,_,v,y,w,j;S=i[8]-i[0],g=i[6]-i[2],_=i[5]-i[3],v=i[17]+i[9],y=i[16]+i[10],w=i[15]+i[11],j=i[14]+i[12],E[A+0]=v+w+j+(y+i[13]),F=(v+w+j)*r[12+7]-(y+i[13]),L=(S-g+_)*r[12+6],E[A+11]=F+L,E[A+12]=F-L,h=(i[7]-i[1])*r[12+6],y=i[13]-y*r[12+7],F=v*r[12+3]-y+w*r[12+4]+j*r[12+5],L=S*r[12+2]+h+g*r[12+0]+_*r[12+1],E[A+3]=F+L,E[A+4]=F-L,F=-v*r[12+5]+y-w*r[12+3]-j*r[12+4],L=S*r[12+1]+h-g*r[12+2]-_*r[12+0],E[A+7]=F+L,E[A+8]=F-L,F=-v*r[12+4]+y-w*r[12+5]-j*r[12+3],L=S*r[12+0]-h+g*r[12+1]-_*r[12+2],E[A+15]=F+L,E[A+16]=F-L}}this.mdct_sub48=function(E,A,i){for(var F=A,L=286,B=0;B<E.channels_out;B++){for(var f=0;f<E.mode_gr;f++){for(var R,C=E.l3_side.tt[f][B],T=C.xr,N=0,m=E.sb_sample[B][1-f],k=0,S=0;S<18/2;S++)for(l(F,L,m[k]),l(F,L+32,m[k+1]),k+=2,L+=64,R=1;R<32;R+=2)m[k-1][R]*=-1;for(R=0;R<32;R++,N+=18){var h=C.block_type,g=E.sb_sample[B][f],_=E.sb_sample[B][1-f];if(C.mixed_block_flag!=0&&R<2&&(h=0),E.amp_filter[R]<1e-12)mp.fill(T,N+0,N+18,0);else{if(E.amp_filter[R]<1)for(var S=0;S<18;S++)_[S][b[R]]*=E.amp_filter[R];if(h==O.SHORT_TYPE){for(var S=-t/4;S<0;S++){var v=s[O.SHORT_TYPE][S+3];T[N+S*3+9]=g[9+S][b[R]]*v-g[8-S][b[R]],T[N+S*3+18]=g[14-S][b[R]]*v+g[15+S][b[R]],T[N+S*3+10]=g[15+S][b[R]]*v-g[14-S][b[R]],T[N+S*3+19]=_[2-S][b[R]]*v+_[3+S][b[R]],T[N+S*3+11]=_[3+S][b[R]]*v-_[2-S][b[R]],T[N+S*3+20]=_[8-S][b[R]]*v+_[9+S][b[R]]}p(T,N)}else{for(var y=fp(18),S=-a/4;S<0;S++){var w,j;w=s[h][S+27]*_[S+9][b[R]]+s[h][S+36]*_[8-S][b[R]],j=s[h][S+9]*g[S+9][b[R]]-s[h][S+18]*g[8-S][b[R]],y[S+9]=w-j*n[3+S+9],y[S+18]=w*n[3+S+9]+j}c(T,N,y)}}if(h!=O.SHORT_TYPE&&R!=0)for(var S=7;S>=0;--S){var K,P;K=T[N+S]*o[20+S]+T[N+-1-S]*u[28+S],P=T[N+S]*u[28+S]-T[N+-1-S]*o[20+S],T[N+-1-S]=K,T[N+S]=P}}}if(F=i,L=286,E.mode_gr==1)for(var z=0;z<18;z++)dp.arraycopy(E.sb_sample[B][1][z],0,E.sb_sample[B][0][z],0,32)}}}var vp=Ie.System,_p=Ie.new_float,pp=Ie.new_float_n;function li(){this.l=_p(O.SBMAX_l),this.s=pp([O.SBMAX_s,3]);var e=this;this.assign=function(t){vp.arraycopy(t.l,0,e.l,0,O.SBMAX_l);for(var a=0;a<O.SBMAX_s;a++)for(var s=0;s<3;s++)e.s[a][s]=t.s[a][s]}}function cs(){this.thm=new li,this.en=new li}function vt(e){var t=e;this.ordinal=function(){return t}}vt.STEREO=new vt(0);vt.JOINT_STEREO=new vt(1);vt.DUAL_CHANNEL=new vt(2);vt.MONO=new vt(3);vt.NOT_SET=new vt(4);var Zc=Ie.System,Pn=Ie.VbrMode,Wc=Ie.new_array_n,Qc=Ie.new_float,gp=Ie.new_float_n,bp=Ie.new_int,Un=Ie.assert;O.ENCDELAY=576;O.POSTDELAY=1152;O.MDCTDELAY=48;O.FFTOFFSET=224+O.MDCTDELAY;O.DECDELAY=528;O.SBLIMIT=32;O.CBANDS=64;O.SBPSY_l=21;O.SBPSY_s=12;O.SBMAX_l=22;O.SBMAX_s=13;O.PSFB21=6;O.PSFB12=6;O.BLKSIZE=1024;O.HBLKSIZE=O.BLKSIZE/2+1;O.BLKSIZE_s=256;O.HBLKSIZE_s=O.BLKSIZE_s/2+1;O.NORM_TYPE=0;O.START_TYPE=1;O.SHORT_TYPE=2;O.STOP_TYPE=3;O.MPG_MD_LR_LR=0;O.MPG_MD_LR_I=1;O.MPG_MD_MS_LR=2;O.MPG_MD_MS_I=3;O.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function O(){var e=O.FFTOFFSET,t=O.MPG_MD_MS_LR,a=null;this.psy=null;var s=null,n=null,r=null;this.setModules=function(p,c,E,A){a=p,this.psy=c,s=c,n=A,r=E};var o=new hp;function u(p){var c,E;if(p.ATH.useAdjust==0){p.ATH.adjust=1;return}if(E=p.loudness_sq[0][0],c=p.loudness_sq[1][0],p.channels_out==2?(E+=p.loudness_sq[0][1],c+=p.loudness_sq[1][1]):(E+=E,c+=c),p.mode_gr==2&&(E=Math.max(E,c)),E*=.5,E*=p.ATH.aaSensitivityP,E>.03125)p.ATH.adjust>=1?p.ATH.adjust=1:p.ATH.adjust<p.ATH.adjustLimit&&(p.ATH.adjust=p.ATH.adjustLimit),p.ATH.adjustLimit=1;else{var A=31.98*E+625e-6;p.ATH.adjust>=A?(p.ATH.adjust*=A*.075+.925,p.ATH.adjust<A&&(p.ATH.adjust=A)):p.ATH.adjustLimit>=A?p.ATH.adjust=A:p.ATH.adjust<p.ATH.adjustLimit&&(p.ATH.adjust=p.ATH.adjustLimit),p.ATH.adjustLimit=A}}function b(p){var c,E;for(Un(p.bitrate_index>=0&&p.bitrate_index<16),Un(p.mode_ext>=0&&p.mode_ext<4),p.bitrate_stereoMode_Hist[p.bitrate_index][4]++,p.bitrate_stereoMode_Hist[15][4]++,p.channels_out==2&&(p.bitrate_stereoMode_Hist[p.bitrate_index][p.mode_ext]++,p.bitrate_stereoMode_Hist[15][p.mode_ext]++),c=0;c<p.mode_gr;++c)for(E=0;E<p.channels_out;++E){var A=p.l3_side.tt[c][E].block_type|0;p.l3_side.tt[c][E].mixed_block_flag!=0&&(A=4),p.bitrate_blockType_Hist[p.bitrate_index][A]++,p.bitrate_blockType_Hist[p.bitrate_index][5]++,p.bitrate_blockType_Hist[15][A]++,p.bitrate_blockType_Hist[15][5]++}}function l(p,c){var E=p.internal_flags,A,i;if(E.lame_encode_frame_init==0){var F,L,B=Qc(2014),f=Qc(286+1152+576);for(E.lame_encode_frame_init=1,F=0,L=0;F<286+576*(1+E.mode_gr);++F)F<576*E.mode_gr?(B[F]=0,E.channels_out==2&&(f[F]=0)):(B[F]=c[0][L],E.channels_out==2&&(f[F]=c[1][L]),++L);for(i=0;i<E.mode_gr;i++)for(A=0;A<E.channels_out;A++)E.l3_side.tt[i][A].block_type=O.SHORT_TYPE;o.mdct_sub48(E,B,f),Un(E.mf_size>=O.BLKSIZE+p.framesize-O.FFTOFFSET),Un(E.mf_size>=512+p.framesize-32)}}this.lame_encode_mp3_frame=function(p,c,E,A,i,F){var L,B=Wc([2,2]);B[0][0]=new cs,B[0][1]=new cs,B[1][0]=new cs,B[1][1]=new cs;var f=Wc([2,2]);f[0][0]=new cs,f[0][1]=new cs,f[1][0]=new cs,f[1][1]=new cs;var R,C=[null,null],T=p.internal_flags,N=gp([2,4]),m=[.5,.5],k=[[0,0],[0,0]],S=[[0,0],[0,0]],h,g,_;if(C[0]=c,C[1]=E,T.lame_encode_frame_init==0&&l(p,C),T.padding=0,(T.slot_lag-=T.frac_SpF)<0&&(T.slot_lag+=p.out_samplerate,T.padding=1),T.psymodel!=0){var v,y=[null,null],w=0,j=bp(2);for(_=0;_<T.mode_gr;_++){for(g=0;g<T.channels_out;g++)y[g]=C[g],w=576+_*576-O.FFTOFFSET;if(p.VBR==Pn.vbr_mtrh||p.VBR==Pn.vbr_mt?v=s.L3psycho_anal_vbr(p,y,w,_,B,f,k[_],S[_],N[_],j):v=s.L3psycho_anal_ns(p,y,w,_,B,f,k[_],S[_],N[_],j),v!=0)return-4;for(p.mode==vt.JOINT_STEREO&&(m[_]=N[_][2]+N[_][3],m[_]>0&&(m[_]=N[_][3]/m[_])),g=0;g<T.channels_out;g++){var K=T.l3_side.tt[_][g];K.block_type=j[g],K.mixed_block_flag=0}}}else for(_=0;_<T.mode_gr;_++)for(g=0;g<T.channels_out;g++)T.l3_side.tt[_][g].block_type=O.NORM_TYPE,T.l3_side.tt[_][g].mixed_block_flag=0,S[_][g]=k[_][g]=700;if(u(T),o.mdct_sub48(T,C[0],C[1]),T.mode_ext=O.MPG_MD_LR_LR,p.force_ms)T.mode_ext=O.MPG_MD_MS_LR;else if(p.mode==vt.JOINT_STEREO){var P=0,z=0;for(_=0;_<T.mode_gr;_++)for(g=0;g<T.channels_out;g++)P+=S[_][g],z+=k[_][g];if(P<=1*z){var d=T.l3_side.tt[0],M=T.l3_side.tt[T.mode_gr-1];d[0].block_type==d[1].block_type&&M[0].block_type==M[1].block_type&&(T.mode_ext=O.MPG_MD_MS_LR)}}if(T.mode_ext==t?(R=f,h=S):(R=B,h=k),p.analysis&&T.pinfo!=null)for(_=0;_<T.mode_gr;_++)for(g=0;g<T.channels_out;g++)T.pinfo.ms_ratio[_]=T.ms_ratio[_],T.pinfo.ms_ener_ratio[_]=m[_],T.pinfo.blocktype[_][g]=T.l3_side.tt[_][g].block_type,T.pinfo.pe[_][g]=h[_][g],Zc.arraycopy(T.l3_side.tt[_][g].xr,0,T.pinfo.xr[_][g],0,576),T.mode_ext==t&&(T.pinfo.ers[_][g]=T.pinfo.ers[_][g+2],Zc.arraycopy(T.pinfo.energy[_][g+2],0,T.pinfo.energy[_][g],0,T.pinfo.energy[_][g].length));if(p.VBR==Pn.vbr_off||p.VBR==Pn.vbr_abr){var W,$;for(W=0;W<18;W++)T.nsPsy.pefirbuf[W]=T.nsPsy.pefirbuf[W+1];for($=0,_=0;_<T.mode_gr;_++)for(g=0;g<T.channels_out;g++)$+=h[_][g];for(T.nsPsy.pefirbuf[18]=$,$=T.nsPsy.pefirbuf[9],W=0;W<9;W++)$+=(T.nsPsy.pefirbuf[W]+T.nsPsy.pefirbuf[18-W])*O.fircoef[W];for($=670*5*T.mode_gr*T.channels_out/$,_=0;_<T.mode_gr;_++)for(g=0;g<T.channels_out;g++)h[_][g]*=$}if(T.iteration_loop.iteration_loop(p,h,m,R),a.format_bitstream(p),L=a.copy_buffer(T,A,i,F,1),p.bWriteVbrTag&&n.addVbrFrame(p),p.analysis&&T.pinfo!=null){for(g=0;g<T.channels_out;g++){var _e;for(_e=0;_e<e;_e++)T.pinfo.pcmdata[g][_e]=T.pinfo.pcmdata[g][_e+p.framesize];for(_e=e;_e<1600;_e++)T.pinfo.pcmdata[g][_e]=C[g][_e-e]}r.set_frame_pinfo(p,R)}return b(T),L}}var $c=Ie.Util,Jc=Ie.new_float;function yp(){var e=Jc(O.BLKSIZE),t=Jc(O.BLKSIZE_s/2),a=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function s(r,o,u){var b=0,l,p,c;u<<=1;var E=o+u;l=4;do{var A,i,F,L,B,f,R;R=l>>1,L=l,B=l<<1,f=B+L,l=B<<1,p=o,c=p+R;do{var C,T,N,m;T=r[p+0]-r[p+L],C=r[p+0]+r[p+L],m=r[p+B]-r[p+f],N=r[p+B]+r[p+f],r[p+B]=C-N,r[p+0]=C+N,r[p+f]=T-m,r[p+L]=T+m,T=r[c+0]-r[c+L],C=r[c+0]+r[c+L],m=$c.SQRT2*r[c+f],N=$c.SQRT2*r[c+B],r[c+B]=C-N,r[c+0]=C+N,r[c+f]=T-m,r[c+L]=T+m,c+=l,p+=l}while(p<E);for(i=a[b+0],A=a[b+1],F=1;F<R;F++){var k,S;k=1-2*A*A,S=2*A*i,p=o+F,c=o+L-F;do{var h,g,_,C,T,v,N,y,m,w;g=S*r[p+L]-k*r[c+L],h=k*r[p+L]+S*r[c+L],T=r[p+0]-h,C=r[p+0]+h,v=r[c+0]-g,_=r[c+0]+g,g=S*r[p+f]-k*r[c+f],h=k*r[p+f]+S*r[c+f],m=r[p+B]-h,N=r[p+B]+h,w=r[c+B]-g,y=r[c+B]+g,g=A*N-i*w,h=i*N+A*w,r[p+B]=C-h,r[p+0]=C+h,r[c+f]=v-g,r[c+L]=v+g,g=i*y-A*m,h=A*y+i*m,r[c+B]=_-h,r[c+0]=_+h,r[p+f]=T-g,r[p+L]=T+g,c+=l,p+=l}while(p<E);k=i,i=k*a[b+0]-A*a[b+1],A=k*a[b+1]+A*a[b+0]}b+=2}while(l<u)}var n=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(r,o,u,b,l){for(var p=0;p<3;p++){var c=O.BLKSIZE_s/2,E=65535&576/3*(p+1),A=O.BLKSIZE_s/8-1;do{var i,F,L,B,f,R=n[A<<2]&255;i=t[R]*b[u][l+R+E],f=t[127-R]*b[u][l+R+E+128],F=i-f,i=i+f,L=t[R+64]*b[u][l+R+E+64],f=t[63-R]*b[u][l+R+E+192],B=L-f,L=L+f,c-=4,o[p][c+0]=i+L,o[p][c+2]=i-L,o[p][c+1]=F+B,o[p][c+3]=F-B,i=t[R+1]*b[u][l+R+E+1],f=t[126-R]*b[u][l+R+E+129],F=i-f,i=i+f,L=t[R+65]*b[u][l+R+E+65],f=t[62-R]*b[u][l+R+E+193],B=L-f,L=L+f,o[p][c+O.BLKSIZE_s/2+0]=i+L,o[p][c+O.BLKSIZE_s/2+2]=i-L,o[p][c+O.BLKSIZE_s/2+1]=F+B,o[p][c+O.BLKSIZE_s/2+3]=F-B}while(--A>=0);s(o[p],c,O.BLKSIZE_s/2)}},this.fft_long=function(r,o,u,b,l){var p=O.BLKSIZE/8-1,c=O.BLKSIZE/2;do{var E,A,i,F,L,B=n[p]&255;E=e[B]*b[u][l+B],L=e[B+512]*b[u][l+B+512],A=E-L,E=E+L,i=e[B+256]*b[u][l+B+256],L=e[B+768]*b[u][l+B+768],F=i-L,i=i+L,c-=4,o[c+0]=E+i,o[c+2]=E-i,o[c+1]=A+F,o[c+3]=A-F,E=e[B+1]*b[u][l+B+1],L=e[B+513]*b[u][l+B+513],A=E-L,E=E+L,i=e[B+257]*b[u][l+B+257],L=e[B+769]*b[u][l+B+769],F=i-L,i=i+L,o[c+O.BLKSIZE/2+0]=E+i,o[c+O.BLKSIZE/2+2]=E-i,o[c+O.BLKSIZE/2+1]=A+F,o[c+O.BLKSIZE/2+3]=A-F}while(--p>=0);s(o,c,O.BLKSIZE/2)},this.init_fft=function(r){for(var o=0;o<O.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/O.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/O.BLKSIZE);for(var o=0;o<O.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/O.BLKSIZE_s))}}var tr=Ie.VbrMode,e1=Ie.Float,ar=Ie.ShortBlock,ia=Ie.Util,wp=Ie.Arrays,Pt=Ie.new_float,Sa=Ie.new_float_n,Os=Ie.new_int,et=Ie.assert;function co(){var e=new yp,t=2.302585092994046,a=2,s=16,n=2,r=16,o=.34,u=1/(14752*14752)/(O.BLKSIZE/2),b=.01,l=.8,p=.6,c=.3,E=3.5,A=21,i=.2302585093;function F(x){return x}function L(x,I){for(var D=0,V=0;V<O.BLKSIZE/2;++V)D+=x[V]*I.ATH.eql_w[V];return D*=u,D}function B(x,I,D,V,X,H,Z,J,G,ie,q){var ce=x.internal_flags;if(G<2)e.fft_long(ce,V[X],G,ie,q),e.fft_short(ce,H[Z],G,ie,q);else if(G==2){for(var Be=O.BLKSIZE-1;Be>=0;--Be){var Ye=V[X+0][Be],ye=V[X+1][Be];V[X+0][Be]=(Ye+ye)*ia.SQRT2*.5,V[X+1][Be]=(Ye-ye)*ia.SQRT2*.5}for(var qe=2;qe>=0;--qe)for(var Be=O.BLKSIZE_s-1;Be>=0;--Be){var Ye=H[Z+0][qe][Be],ye=H[Z+1][qe][Be];H[Z+0][qe][Be]=(Ye+ye)*ia.SQRT2*.5,H[Z+1][qe][Be]=(Ye-ye)*ia.SQRT2*.5}}I[0]=V[X+0][0],I[0]*=I[0];for(var Be=O.BLKSIZE/2-1;Be>=0;--Be){var ne=V[X+0][O.BLKSIZE/2-Be],Pe=V[X+0][O.BLKSIZE/2+Be];I[O.BLKSIZE/2-Be]=(ne*ne+Pe*Pe)*.5}for(var qe=2;qe>=0;--qe){D[qe][0]=H[Z+0][qe][0],D[qe][0]*=D[qe][0];for(var Be=O.BLKSIZE_s/2-1;Be>=0;--Be){var ne=H[Z+0][qe][O.BLKSIZE_s/2-Be],Pe=H[Z+0][qe][O.BLKSIZE_s/2+Be];D[qe][O.BLKSIZE_s/2-Be]=(ne*ne+Pe*Pe)*.5}}{for(var Je=0,Be=11;Be<O.HBLKSIZE;Be++)Je+=I[Be];ce.tot_ener[G]=Je}if(x.analysis){for(var Be=0;Be<O.HBLKSIZE;Be++)ce.pinfo.energy[J][G][Be]=ce.pinfo.energy_save[G][Be],ce.pinfo.energy_save[G][Be]=I[Be];ce.pinfo.pe[J][G]=ce.pe[G]}x.athaa_loudapprox==2&&G<2&&(ce.loudness_sq[J][G]=ce.loudness_sq_save[G],ce.loudness_sq_save[G]=L(I,ce))}var f=8,R=23,C=15,T,N,m,k=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){T=Math.pow(10,(f+1)/16),N=Math.pow(10,(R+1)/16),m=Math.pow(10,C/10)}var h=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],g=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],_=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function v(x,I,D,V,X,H){var Z;if(I>x)if(I<x*N)Z=I/x;else return x+I;else{if(x>=I*N)return x+I;Z=x/I}if(x+=I,V+3<=3+3){if(Z>=T)return x;var J=0|ia.FAST_LOG10_X(Z,16);return x*g[J]}var J=0|ia.FAST_LOG10_X(Z,16);if(H!=0?I=X.ATH.cb_s[D]*X.ATH.adjust:I=X.ATH.cb_l[D]*X.ATH.adjust,x<m*I){if(x>I){var G,ie;return G=1,J<=13&&(G=_[J]),ie=ia.FAST_LOG10_X(x/I,10/15),x*((h[J]-G)*ie+G)}return J>13?x:x*_[J]}return x*h[J]}var y=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function w(x,I,D){var V;if(x<0&&(x=0),I<0&&(I=0),x<=0)return I;if(I<=0)return x;if(I>x?V=I/x:V=x/I,D>=-2&&D<=2){if(V>=T)return x+I;var X=0|ia.FAST_LOG10_X(V,16);return(x+I)*y[X]}return V<N?x+I:(x<I&&(x=I),x)}function j(x,I){var D=x.internal_flags;if(D.channels_out>1){for(var V=0;V<O.SBMAX_l;V++){var X=D.thm[0].l[V],H=D.thm[1].l[V];D.thm[0].l[V]+=H*I,D.thm[1].l[V]+=X*I}for(var V=0;V<O.SBMAX_s;V++)for(var Z=0;Z<3;Z++){var X=D.thm[0].s[V][Z],H=D.thm[1].s[V][Z];D.thm[0].s[V][Z]+=H*I,D.thm[1].s[V][Z]+=X*I}}}function K(x){for(var I=0;I<O.SBMAX_l;I++)if(!(x.thm[0].l[I]>1.58*x.thm[1].l[I]||x.thm[1].l[I]>1.58*x.thm[0].l[I])){var D=x.mld_l[I]*x.en[3].l[I],V=Math.max(x.thm[2].l[I],Math.min(x.thm[3].l[I],D));D=x.mld_l[I]*x.en[2].l[I];var X=Math.max(x.thm[3].l[I],Math.min(x.thm[2].l[I],D));x.thm[2].l[I]=V,x.thm[3].l[I]=X}for(var I=0;I<O.SBMAX_s;I++)for(var H=0;H<3;H++)if(!(x.thm[0].s[I][H]>1.58*x.thm[1].s[I][H]||x.thm[1].s[I][H]>1.58*x.thm[0].s[I][H])){var D=x.mld_s[I]*x.en[3].s[I][H],V=Math.max(x.thm[2].s[I][H],Math.min(x.thm[3].s[I][H],D));D=x.mld_s[I]*x.en[2].s[I][H];var X=Math.max(x.thm[3].s[I][H],Math.min(x.thm[2].s[I][H],D));x.thm[2].s[I][H]=V,x.thm[3].s[I][H]=X}}function P(x,I,D){var V=I,X=Math.pow(10,D);I*=2,V*=2;for(var H=0;H<O.SBMAX_l;H++){var Z,J,G,ie;if(ie=x.ATH.cb_l[x.bm_l[H]]*X,Z=Math.min(Math.max(x.thm[0].l[H],ie),Math.max(x.thm[1].l[H],ie)),J=Math.max(x.thm[2].l[H],ie),G=Math.max(x.thm[3].l[H],ie),Z*I<J+G){var q=Z*V/(J+G);J*=q,G*=q}x.thm[2].l[H]=Math.min(J,x.thm[2].l[H]),x.thm[3].l[H]=Math.min(G,x.thm[3].l[H])}X*=O.BLKSIZE_s/O.BLKSIZE;for(var H=0;H<O.SBMAX_s;H++)for(var ce=0;ce<3;ce++){var Z,J,G,ie;if(ie=x.ATH.cb_s[x.bm_s[H]]*X,Z=Math.min(Math.max(x.thm[0].s[H][ce],ie),Math.max(x.thm[1].s[H][ce],ie)),J=Math.max(x.thm[2].s[H][ce],ie),G=Math.max(x.thm[3].s[H][ce],ie),Z*I<J+G){var q=Z*I/(J+G);J*=q,G*=q}x.thm[2].s[H][ce]=Math.min(x.thm[2].s[H][ce],J),x.thm[3].s[H][ce]=Math.min(x.thm[3].s[H][ce],G)}}function z(x,I,D,V,X){var H,Z,J=0,G=0;for(H=Z=0;H<O.SBMAX_s;++Z,++H){for(var ie=x.bo_s[H],q=x.npart_s,ce=ie<q?ie:q;Z<ce;)et(I[Z]>=0),et(D[Z]>=0),J+=I[Z],G+=D[Z],Z++;if(x.en[V].s[H][X]=J,x.thm[V].s[H][X]=G,Z>=q){++H;break}et(I[Z]>=0),et(D[Z]>=0);{var Be=x.PSY.bo_s_weight[H],Ye=1-Be;J=Be*I[Z],G=Be*D[Z],x.en[V].s[H][X]+=J,x.thm[V].s[H][X]+=G,J=Ye*I[Z],G=Ye*D[Z]}}for(;H<O.SBMAX_s;++H)x.en[V].s[H][X]=0,x.thm[V].s[H][X]=0}function d(x,I,D,V){var X,H,Z=0,J=0;for(X=H=0;X<O.SBMAX_l;++H,++X){for(var G=x.bo_l[X],ie=x.npart_l,q=G<ie?G:ie;H<q;)et(I[H]>=0),et(D[H]>=0),Z+=I[H],J+=D[H],H++;if(x.en[V].l[X]=Z,x.thm[V].l[X]=J,H>=ie){++X;break}et(I[H]>=0),et(D[H]>=0);{var ce=x.PSY.bo_l_weight[X],Be=1-ce;Z=ce*I[H],J=ce*D[H],x.en[V].l[X]+=Z,x.thm[V].l[X]+=J,Z=Be*I[H],J=Be*D[H]}}for(;X<O.SBMAX_l;++X)x.en[V].l[X]=0,x.thm[V].l[X]=0}function M(x,I,D,V,X,H){var Z=x.internal_flags,J,G;for(G=J=0;G<Z.npart_s;++G){for(var ie=0,q=Z.numlines_s[G],ce=0;ce<q;++ce,++J){var Be=I[H][J];ie+=Be}D[G]=ie}for(et(G==Z.npart_s),J=G=0;G<Z.npart_s;G++){var Ye=Z.s3ind_s[G][0],ye=Z.s3_ss[J++]*D[Ye];for(++Ye;Ye<=Z.s3ind_s[G][1];)ye+=Z.s3_ss[J]*D[Ye],++J,++Ye;{var qe=n*Z.nb_s1[X][G];V[G]=Math.min(ye,qe)}if(Z.blocktype_old[X&1]==O.SHORT_TYPE){var qe=r*Z.nb_s2[X][G],ne=V[G];V[G]=Math.min(qe,ne)}Z.nb_s2[X][G]=Z.nb_s1[X][G],Z.nb_s1[X][G]=ye,et(V[G]>=0)}for(;G<=O.CBANDS;++G)D[G]=0,V[G]=0}function W(x,I,D,V){var X=x.internal_flags;x.short_blocks==ar.short_block_coupled&&!(I[0]!=0&&I[1]!=0)&&(I[0]=I[1]=0);for(var H=0;H<X.channels_out;H++)V[H]=O.NORM_TYPE,x.short_blocks==ar.short_block_dispensed&&(I[H]=1),x.short_blocks==ar.short_block_forced&&(I[H]=0),I[H]!=0?(et(X.blocktype_old[H]!=O.START_TYPE),X.blocktype_old[H]==O.SHORT_TYPE&&(V[H]=O.STOP_TYPE)):(V[H]=O.SHORT_TYPE,X.blocktype_old[H]==O.NORM_TYPE&&(X.blocktype_old[H]=O.START_TYPE),X.blocktype_old[H]==O.STOP_TYPE&&(X.blocktype_old[H]=O.SHORT_TYPE)),D[H]=X.blocktype_old[H],X.blocktype_old[H]=V[H]}function $(x,I,D){return D>=1?x:D<=0?I:I>0?Math.pow(x/I,D)*I:0}var _e=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Ae(x,I){for(var D=309.07,V=0;V<O.SBMAX_s-1;V++)for(var X=0;X<3;X++){var H=x.thm.s[V][X];if(H>0){var Z=H*I,J=x.en.s[V][X];J>Z&&(J>Z*1e10?D+=_e[V]*(10*t):D+=_e[V]*ia.FAST_LOG10(J/Z))}}return D}var Re=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function ge(x,I){for(var D=281.0575,V=0;V<O.SBMAX_l-1;V++){var X=x.thm.l[V];if(X>0){var H=X*I,Z=x.en.l[V];Z>H&&(Z>H*1e10?D+=Re[V]*(10*t):D+=Re[V]*ia.FAST_LOG10(Z/H))}}return D}function Ve(x,I,D,V,X){var H,Z;for(H=Z=0;H<x.npart_l;++H){var J=0,G=0,ie;for(ie=0;ie<x.numlines_l[H];++ie,++Z){var q=I[Z];J+=q,G<q&&(G=q)}D[H]=J,V[H]=G,X[H]=J*x.rnumlines_l[H],et(x.rnumlines_l[H]>=0),et(D[H]>=0),et(V[H]>=0),et(X[H]>=0)}}function Ne(x,I,D,V){var X=k.length-1,H=0,Z=D[H]+D[H+1];if(Z>0){var J=I[H];J<I[H+1]&&(J=I[H+1]),et(x.numlines_l[H]+x.numlines_l[H+1]-1>0),Z=20*(J*2-Z)/(Z*(x.numlines_l[H]+x.numlines_l[H+1]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;for(H=1;H<x.npart_l-1;H++)if(Z=D[H-1]+D[H]+D[H+1],Z>0){var J=I[H-1];J<I[H]&&(J=I[H]),J<I[H+1]&&(J=I[H+1]),et(x.numlines_l[H-1]+x.numlines_l[H]+x.numlines_l[H+1]-1>0),Z=20*(J*3-Z)/(Z*(x.numlines_l[H-1]+x.numlines_l[H]+x.numlines_l[H+1]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;if(et(H==x.npart_l-1),Z=D[H-1]+D[H],Z>0){var J=I[H-1];J<I[H]&&(J=I[H]),et(x.numlines_l[H-1]+x.numlines_l[H]-1>0),Z=20*(J*2-Z)/(Z*(x.numlines_l[H-1]+x.numlines_l[H]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;et(H==x.npart_l-1)}var he=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(x,I,D,V,X,H,Z,J,G,ie){var q=x.internal_flags,ce=Sa([2,O.BLKSIZE]),Be=Sa([2,3,O.BLKSIZE_s]),Ye=Pt(O.CBANDS+1),ye=Pt(O.CBANDS+1),qe=Pt(O.CBANDS+2),ne=Os(2),Pe=Os(2),Je,we,Ue,Se,Xe,xt,je,We,tt=Sa([2,576]),It,ma=Os(O.CBANDS+2),Ft=Os(O.CBANDS+2);for(wp.fill(Ft,0),Je=q.channels_out,x.mode==vt.JOINT_STEREO&&(Je=4),x.VBR==tr.vbr_off?It=q.ResvMax==0?0:q.ResvSize/q.ResvMax*.5:x.VBR==tr.vbr_rh||x.VBR==tr.vbr_mtrh||x.VBR==tr.vbr_mt?It=.6:It=1,we=0;we<q.channels_out;we++){var Ct=I[we],ra=D+576-350-A+192;for(Se=0;Se<576;Se++){var fa,ha;for(fa=Ct[ra+Se+10],ha=0,Xe=0;Xe<(A-1)/2-1;Xe+=2)fa+=he[Xe]*(Ct[ra+Se+Xe]+Ct[ra+Se+A-Xe]),ha+=he[Xe+1]*(Ct[ra+Se+Xe+1]+Ct[ra+Se+A-Xe-1]);tt[we][Se]=fa+ha}X[V][we].en.assign(q.en[we]),X[V][we].thm.assign(q.thm[we]),Je>2&&(H[V][we].en.assign(q.en[we+2]),H[V][we].thm.assign(q.thm[we+2]))}for(we=0;we<Je;we++){var Ra,xa,Yt=Pt(12),ja=[0,0,0,0],Js=Pt(12),Fi=1,jl,Fl=Pt(O.CBANDS),Hl=Pt(O.CBANDS),Bt=[0,0,0,0],Pl=Pt(O.HBLKSIZE),Ul=Sa([3,O.HBLKSIZE_s]);for(et(q.npart_s<=O.CBANDS),et(q.npart_l<=O.CBANDS),Se=0;Se<3;Se++)Yt[Se]=q.nsPsy.last_en_subshort[we][Se+6],et(q.nsPsy.last_en_subshort[we][Se+4]>0),Js[Se]=Yt[Se]/q.nsPsy.last_en_subshort[we][Se+4],ja[0]+=Yt[Se];if(we==2)for(Se=0;Se<576;Se++){var Hi,Pi;Hi=tt[0][Se],Pi=tt[1][Se],tt[0][Se]=Hi+Pi,tt[1][Se]=Hi-Pi}{var Dl=tt[we&1],Mr=0;for(Se=0;Se<9;Se++){for(var Uu=Mr+64,Vt=1;Mr<Uu;Mr++)Vt<Math.abs(Dl[Mr])&&(Vt=Math.abs(Dl[Mr]));q.nsPsy.last_en_subshort[we][Se]=Yt[Se+3]=Vt,ja[1+Se/3]+=Vt,Vt>Yt[Se+3-2]?(et(Yt[Se+3-2]>0),Vt=Vt/Yt[Se+3-2]):Yt[Se+3-2]>Vt*10?Vt=Yt[Se+3-2]/(Vt*10):Vt=0,Js[Se+3]=Vt}}if(x.analysis){var Ui=Js[0];for(Se=1;Se<12;Se++)Ui<Js[Se]&&(Ui=Js[Se]);q.pinfo.ers[V][we]=q.pinfo.ers_save[we],q.pinfo.ers_save[we]=Ui}for(jl=we==3?q.nsPsy.attackthre_s:q.nsPsy.attackthre,Se=0;Se<12;Se++)Bt[Se/3]==0&&Js[Se]>jl&&(Bt[Se/3]=Se%3+1);for(Se=1;Se<4;Se++){var Di;ja[Se-1]>ja[Se]?(et(ja[Se]>0),Di=ja[Se-1]/ja[Se]):(et(ja[Se-1]>0),Di=ja[Se]/ja[Se-1]),Di<1.7&&(Bt[Se]=0,Se==1&&(Bt[0]=0))}for(Bt[0]!=0&&q.nsPsy.lastAttacks[we]!=0&&(Bt[0]=0),(q.nsPsy.lastAttacks[we]==3||Bt[0]+Bt[1]+Bt[2]+Bt[3]!=0)&&(Fi=0,Bt[1]!=0&&Bt[0]!=0&&(Bt[1]=0),Bt[2]!=0&&Bt[1]!=0&&(Bt[2]=0),Bt[3]!=0&&Bt[2]!=0&&(Bt[3]=0)),we<2?Pe[we]=Fi:Fi==0&&(Pe[0]=Pe[1]=0),G[we]=q.tot_ener[we],xa=Be,Ra=ce,B(x,Pl,Ul,Ra,we&1,xa,we&1,V,we,I,D),Ve(q,Pl,Ye,Fl,Hl),Ne(q,Fl,Hl,ma),We=0;We<3;We++){var Vi,na;for(M(x,Ul,ye,qe,we,We),z(q,ye,qe,we,We),je=0;je<O.SBMAX_s;je++){if(na=q.thm[we].s[je][We],na*=l,Bt[We]>=2||Bt[We+1]==1){var Er=We!=0?We-1:2,Vt=$(q.thm[we].s[je][Er],na,p*It);na=Math.min(na,Vt)}if(Bt[We]==1){var Er=We!=0?We-1:2,Vt=$(q.thm[we].s[je][Er],na,c*It);na=Math.min(na,Vt)}else if(We!=0&&Bt[We-1]==3||We==0&&q.nsPsy.lastAttacks[we]==3){var Er=We!=2?We+1:0,Vt=$(q.thm[we].s[je][Er],na,c*It);na=Math.min(na,Vt)}Vi=Yt[We*3+3]+Yt[We*3+4]+Yt[We*3+5],Yt[We*3+5]*6<Vi&&(na*=.5,Yt[We*3+4]*6<Vi&&(na*=.5)),q.thm[we].s[je][We]=na}}for(q.nsPsy.lastAttacks[we]=Bt[2],xt=0,Ue=0;Ue<q.npart_l;Ue++){for(var Es=q.s3ind[Ue][0],qi=Ye[Es]*k[ma[Es]],As=q.s3_ll[xt++]*qi;++Es<=q.s3ind[Ue][1];)qi=Ye[Es]*k[ma[Es]],As=v(As,q.s3_ll[xt++]*qi,Es,Es-Ue,q,0);As*=.158489319246111,q.blocktype_old[we&1]==O.SHORT_TYPE?qe[Ue]=As:qe[Ue]=$(Math.min(As,Math.min(a*q.nb_1[we][Ue],s*q.nb_2[we][Ue])),As,It),q.nb_2[we][Ue]=q.nb_1[we][Ue],q.nb_1[we][Ue]=As}for(;Ue<=O.CBANDS;++Ue)Ye[Ue]=0,qe[Ue]=0;d(q,Ye,qe,we)}if((x.mode==vt.STEREO||x.mode==vt.JOINT_STEREO)&&x.interChRatio>0&&j(x,x.interChRatio),x.mode==vt.JOINT_STEREO){var zi;K(q),zi=x.msfix,Math.abs(zi)>0&&P(q,zi,x.ATHlower*q.ATH.adjust)}for(W(x,Pe,ie,ne),we=0;we<Je;we++){var Ar,kr=0,kn,Tn;we>1?(Ar=J,kr=-2,kn=O.NORM_TYPE,(ie[0]==O.SHORT_TYPE||ie[1]==O.SHORT_TYPE)&&(kn=O.SHORT_TYPE),Tn=H[V][we-2]):(Ar=Z,kr=0,kn=ie[we],Tn=X[V][we]),kn==O.SHORT_TYPE?Ar[kr+we]=Ae(Tn,q.masking_lower):Ar[kr+we]=ge(Tn,q.masking_lower),x.analysis&&(q.pinfo.pe[V][we]=Ar[kr+we])}return 0};function Ke(x,I,D,V,X,H,Z,J){var G=x.internal_flags;if(V<2)e.fft_long(G,Z[J],V,I,D);else if(V==2)for(var ie=O.BLKSIZE-1;ie>=0;--ie){var q=Z[J+0][ie],ce=Z[J+1][ie];Z[J+0][ie]=(q+ce)*ia.SQRT2*.5,Z[J+1][ie]=(q-ce)*ia.SQRT2*.5}H[0]=Z[J+0][0],H[0]*=H[0];for(var ie=O.BLKSIZE/2-1;ie>=0;--ie){var Be=Z[J+0][O.BLKSIZE/2-ie],Ye=Z[J+0][O.BLKSIZE/2+ie];H[O.BLKSIZE/2-ie]=(Be*Be+Ye*Ye)*.5}{for(var ye=0,ie=11;ie<O.HBLKSIZE;ie++)ye+=H[ie];G.tot_ener[V]=ye}if(x.analysis){for(var ie=0;ie<O.HBLKSIZE;ie++)G.pinfo.energy[X][V][ie]=G.pinfo.energy_save[V][ie],G.pinfo.energy_save[V][ie]=H[ie];G.pinfo.pe[X][V]=G.pe[V]}}function it(x,I,D,V,X,H,Z,J){var G=x.internal_flags;if(X==0&&V<2&&e.fft_short(G,Z[J],V,I,D),V==2)for(var ie=O.BLKSIZE_s-1;ie>=0;--ie){var q=Z[J+0][X][ie],ce=Z[J+1][X][ie];Z[J+0][X][ie]=(q+ce)*ia.SQRT2*.5,Z[J+1][X][ie]=(q-ce)*ia.SQRT2*.5}H[X][0]=Z[J+0][X][0],H[X][0]*=H[X][0];for(var ie=O.BLKSIZE_s/2-1;ie>=0;--ie){var Be=Z[J+0][X][O.BLKSIZE_s/2-ie],Ye=Z[J+0][X][O.BLKSIZE_s/2+ie];H[X][O.BLKSIZE_s/2-ie]=(Be*Be+Ye*Ye)*.5}}function U(x,I,D,V){var X=x.internal_flags;x.athaa_loudapprox==2&&D<2&&(X.loudness_sq[I][D]=X.loudness_sq_save[D],X.loudness_sq_save[D]=L(V,X))}var Y=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function te(x,I,D,V,X,H,Z,J,G,ie){for(var q=Sa([2,576]),ce=x.internal_flags,Be=ce.channels_out,Ye=x.mode==vt.JOINT_STEREO?4:Be,ye=0;ye<Be;ye++){firbuf=I[ye];for(var qe=D+576-350-A+192,ne=0;ne<576;ne++){var Pe,Je;Pe=firbuf[qe+ne+10],Je=0;for(var we=0;we<(A-1)/2-1;we+=2)Pe+=Y[we]*(firbuf[qe+ne+we]+firbuf[qe+ne+A-we]),Je+=Y[we+1]*(firbuf[qe+ne+we+1]+firbuf[qe+ne+A-we-1]);q[ye][ne]=Pe+Je}X[V][ye].en.assign(ce.en[ye]),X[V][ye].thm.assign(ce.thm[ye]),Ye>2&&(H[V][ye].en.assign(ce.en[ye+2]),H[V][ye].thm.assign(ce.thm[ye+2]))}for(var ye=0;ye<Ye;ye++){var Ue=Pt(12),Se=Pt(12),Xe=[0,0,0,0],xt=q[ye&1],je=0,We=ye==3?ce.nsPsy.attackthre_s:ce.nsPsy.attackthre,tt=1;if(ye==2)for(var ne=0,we=576;we>0;++ne,--we){var It=q[0][ne],ma=q[1][ne];q[0][ne]=It+ma,q[1][ne]=It-ma}for(var ne=0;ne<3;ne++)Se[ne]=ce.nsPsy.last_en_subshort[ye][ne+6],et(ce.nsPsy.last_en_subshort[ye][ne+4]>0),Ue[ne]=Se[ne]/ce.nsPsy.last_en_subshort[ye][ne+4],Xe[0]+=Se[ne];for(var ne=0;ne<9;ne++){for(var Ft=je+64,Ct=1;je<Ft;je++)Ct<Math.abs(xt[je])&&(Ct=Math.abs(xt[je]));ce.nsPsy.last_en_subshort[ye][ne]=Se[ne+3]=Ct,Xe[1+ne/3]+=Ct,Ct>Se[ne+3-2]?(et(Se[ne+3-2]>0),Ct=Ct/Se[ne+3-2]):Se[ne+3-2]>Ct*10?Ct=Se[ne+3-2]/(Ct*10):Ct=0,Ue[ne+3]=Ct}for(var ne=0;ne<3;++ne){var ra=Se[ne*3+3]+Se[ne*3+4]+Se[ne*3+5],fa=1;Se[ne*3+5]*6<ra&&(fa*=.5,Se[ne*3+4]*6<ra&&(fa*=.5)),J[ye][ne]=fa}if(x.analysis){for(var ha=Ue[0],ne=1;ne<12;ne++)ha<Ue[ne]&&(ha=Ue[ne]);ce.pinfo.ers[V][ye]=ce.pinfo.ers_save[ye],ce.pinfo.ers_save[ye]=ha}for(var ne=0;ne<12;ne++)G[ye][ne/3]==0&&Ue[ne]>We&&(G[ye][ne/3]=ne%3+1);for(var ne=1;ne<4;ne++){var Ra=Xe[ne-1],xa=Xe[ne],Yt=Math.max(Ra,xa);Yt<4e4&&Ra<1.7*xa&&xa<1.7*Ra&&(ne==1&&G[ye][0]<=G[ye][ne]&&(G[ye][0]=0),G[ye][ne]=0)}G[ye][0]<=ce.nsPsy.lastAttacks[ye]&&(G[ye][0]=0),(ce.nsPsy.lastAttacks[ye]==3||G[ye][0]+G[ye][1]+G[ye][2]+G[ye][3]!=0)&&(tt=0,G[ye][1]!=0&&G[ye][0]!=0&&(G[ye][1]=0),G[ye][2]!=0&&G[ye][1]!=0&&(G[ye][2]=0),G[ye][3]!=0&&G[ye][2]!=0&&(G[ye][3]=0)),ye<2?ie[ye]=tt:tt==0&&(ie[0]=ie[1]=0),Z[ye]=ce.tot_ener[ye]}}function de(x,I,D){if(D==0)for(var V=0;V<x.npart_s;V++)x.nb_s2[I][V]=x.nb_s1[I][V],x.nb_s1[I][V]=0}function me(x,I){for(var D=0;D<x.npart_l;D++)x.nb_2[I][D]=x.nb_1[I][D],x.nb_1[I][D]=0}function Ee(x,I,D,V){var X=k.length-1,H=0,Z=D[H]+D[H+1];if(Z>0){var J=I[H];J<I[H+1]&&(J=I[H+1]),et(x.numlines_s[H]+x.numlines_s[H+1]-1>0),Z=20*(J*2-Z)/(Z*(x.numlines_s[H]+x.numlines_s[H+1]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;for(H=1;H<x.npart_s-1;H++)if(Z=D[H-1]+D[H]+D[H+1],et(H+1<x.npart_s),Z>0){var J=I[H-1];J<I[H]&&(J=I[H]),J<I[H+1]&&(J=I[H+1]),et(x.numlines_s[H-1]+x.numlines_s[H]+x.numlines_s[H+1]-1>0),Z=20*(J*3-Z)/(Z*(x.numlines_s[H-1]+x.numlines_s[H]+x.numlines_s[H+1]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;if(et(H==x.npart_s-1),Z=D[H-1]+D[H],Z>0){var J=I[H-1];J<I[H]&&(J=I[H]),et(x.numlines_s[H-1]+x.numlines_s[H]-1>0),Z=20*(J*2-Z)/(Z*(x.numlines_s[H-1]+x.numlines_s[H]-1));var G=0|Z;G>X&&(G=X),V[H]=G}else V[H]=0;et(H==x.npart_s-1)}function xe(x,I,D,V,X,H){var Z=x.internal_flags,J=new float[O.CBANDS],G=Pt(O.CBANDS),ie,q,ce,Be=new int[O.CBANDS];for(ce=q=0;ce<Z.npart_s;++ce){var Ye=0,ye=0,qe=Z.numlines_s[ce];for(ie=0;ie<qe;++ie,++q){var ne=I[H][q];Ye+=ne,ye<ne&&(ye=ne)}D[ce]=Ye,J[ce]=ye,G[ce]=Ye/qe,et(G[ce]>=0)}for(et(ce==Z.npart_s);ce<O.CBANDS;++ce)J[ce]=0,G[ce]=0;for(Ee(Z,J,G,Be),q=ce=0;ce<Z.npart_s;ce++){var Pe=Z.s3ind_s[ce][0],Je=Z.s3ind_s[ce][1],we,Ue,Se,Xe,xt;for(we=Be[Pe],Ue=1,Xe=Z.s3_ss[q]*D[Pe]*k[Be[Pe]],++q,++Pe;Pe<=Je;)we+=Be[Pe],Ue+=1,Se=Z.s3_ss[q]*D[Pe]*k[Be[Pe]],Xe=w(Xe,Se,Pe-ce),++q,++Pe;we=(1+2*we)/(2*Ue),xt=k[we]*.5,Xe*=xt,V[ce]=Xe,Z.nb_s2[X][ce]=Z.nb_s1[X][ce],Z.nb_s1[X][ce]=Xe,Se=J[ce],Se*=Z.minval_s[ce],Se*=xt,V[ce]>Se&&(V[ce]=Se),Z.masking_lower>1&&(V[ce]*=Z.masking_lower),V[ce]>D[ce]&&(V[ce]=D[ce]),Z.masking_lower<1&&(V[ce]*=Z.masking_lower),et(V[ce]>=0)}for(;ce<O.CBANDS;++ce)D[ce]=0,V[ce]=0}function be(x,I,D,V,X){var H=Pt(O.CBANDS),Z=Pt(O.CBANDS),J=Os(O.CBANDS+2),G;Ve(x,I,D,H,Z),Ne(x,H,Z,J);var ie=0;for(G=0;G<x.npart_l;G++){var q,ce,Be,Ye,ye=x.s3ind[G][0],qe=x.s3ind[G][1],ne=0,Pe=0;for(ne=J[ye],Pe+=1,ce=x.s3_ll[ie]*D[ye]*k[J[ye]],++ie,++ye;ye<=qe;)ne+=J[ye],Pe+=1,q=x.s3_ll[ie]*D[ye]*k[J[ye]],Ye=w(ce,q,ye-G),ce=Ye,++ie,++ye;if(ne=(1+2*ne)/(2*Pe),Be=k[ne]*.5,ce*=Be,x.blocktype_old[X&1]==O.SHORT_TYPE){var Je=a*x.nb_1[X][G];Je>0?V[G]=Math.min(ce,Je):V[G]=Math.min(ce,D[G]*c)}else{var we=s*x.nb_2[X][G],Ue=a*x.nb_1[X][G],Je;we<=0&&(we=ce),Ue<=0&&(Ue=ce),x.blocktype_old[X&1]==O.NORM_TYPE?Je=Math.min(Ue,we):Je=Ue,V[G]=Math.min(ce,Je)}x.nb_2[X][G]=x.nb_1[X][G],x.nb_1[X][G]=ce,q=H[G],q*=x.minval_l[G],q*=Be,V[G]>q&&(V[G]=q),x.masking_lower>1&&(V[G]*=x.masking_lower),V[G]>D[G]&&(V[G]=D[G]),x.masking_lower<1&&(V[G]*=x.masking_lower),et(V[G]>=0)}for(;G<O.CBANDS;++G)D[G]=0,V[G]=0}function ke(x,I){var D=x.internal_flags;x.short_blocks==ar.short_block_coupled&&!(I[0]!=0&&I[1]!=0)&&(I[0]=I[1]=0);for(var V=0;V<D.channels_out;V++)x.short_blocks==ar.short_block_dispensed&&(I[V]=1),x.short_blocks==ar.short_block_forced&&(I[V]=0)}function pe(x,I,D){for(var V=x.internal_flags,X=0;X<V.channels_out;X++){var H=O.NORM_TYPE;I[X]!=0?(et(V.blocktype_old[X]!=O.START_TYPE),V.blocktype_old[X]==O.SHORT_TYPE&&(H=O.STOP_TYPE)):(H=O.SHORT_TYPE,V.blocktype_old[X]==O.NORM_TYPE&&(V.blocktype_old[X]=O.START_TYPE),V.blocktype_old[X]==O.STOP_TYPE&&(V.blocktype_old[X]=O.SHORT_TYPE)),D[X]=V.blocktype_old[X],V.blocktype_old[X]=H}}function De(x,I,D,V,X,H,Z){for(var J=H*2,G=H>0?Math.pow(10,X):1,ie,q,ce=0;ce<Z;++ce){var Be=x[2][ce],Ye=x[3][ce],ye=I[0][ce],qe=I[1][ce],ne=I[2][ce],Pe=I[3][ce];if(ye<=1.58*qe&&qe<=1.58*ye){var Je=D[ce]*Ye,we=D[ce]*Be;q=Math.max(ne,Math.min(Pe,Je)),ie=Math.max(Pe,Math.min(ne,we))}else q=ne,ie=Pe;if(H>0){var Ue,Se,Xe=V[ce]*G;if(Ue=Math.min(Math.max(ye,Xe),Math.max(qe,Xe)),ne=Math.max(q,Xe),Pe=Math.max(ie,Xe),Se=ne+Pe,Se>0&&Ue*J<Se){var xt=Ue*J/Se;ne*=xt,Pe*=xt}q=Math.min(ne,q),ie=Math.min(Pe,ie)}q>Be&&(q=Be),ie>Ye&&(ie=Ye),I[2][ce]=q,I[3][ce]=ie}}this.L3psycho_anal_vbr=function(x,I,D,V,X,H,Z,J,G,ie){var q=x.internal_flags,ce,Be,Ye=Pt(O.HBLKSIZE),ye=Sa([3,O.HBLKSIZE_s]),qe=Sa([2,O.BLKSIZE]),ne=Sa([2,3,O.BLKSIZE_s]),Pe=Sa([4,O.CBANDS]),Je=Sa([4,O.CBANDS]),we=Sa([4,3]),Ue=.6,Se=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Xe=Os(2),xt=x.mode==vt.JOINT_STEREO?4:q.channels_out;te(x,I,D,V,X,H,G,we,Se,Xe),ke(x,Xe);{for(var je=0;je<xt;je++){var We=je&1;ce=qe,Ke(x,I,D,je,V,Ye,ce,We),U(x,V,je,Ye),Xe[We]!=0?be(q,Ye,Pe[je],Je[je],je):me(q,je)}Xe[0]+Xe[1]==2&&x.mode==vt.JOINT_STEREO&&De(Pe,Je,q.mld_cb_l,q.ATH.cb_l,x.ATHlower*q.ATH.adjust,x.msfix,q.npart_l);for(var je=0;je<xt;je++){var We=je&1;Xe[We]!=0&&d(q,Pe[je],Je[je],je)}}{for(var tt=0;tt<3;tt++){for(var je=0;je<xt;++je){var We=je&1;Xe[We]!=0?de(q,je,tt):(Be=ne,it(x,I,D,je,tt,ye,Be,We),xe(x,ye,Pe[je],Je[je],je,tt))}Xe[0]+Xe[1]==0&&x.mode==vt.JOINT_STEREO&&De(Pe,Je,q.mld_cb_s,q.ATH.cb_s,x.ATHlower*q.ATH.adjust,x.msfix,q.npart_s);for(var je=0;je<xt;++je){var We=je&1;Xe[We]==0&&z(q,Pe[je],Je[je],je,tt)}}for(var je=0;je<xt;je++){var We=je&1;if(Xe[We]==0)for(var It=0;It<O.SBMAX_s;It++){for(var ma=Pt(3),tt=0;tt<3;tt++){var Ft=q.thm[je].s[It][tt];if(Ft*=l,Se[je][tt]>=2||Se[je][tt+1]==1){var Ct=tt!=0?tt-1:2,ra=$(q.thm[je].s[It][Ct],Ft,p*Ue);Ft=Math.min(Ft,ra)}else if(Se[je][tt]==1){var Ct=tt!=0?tt-1:2,ra=$(q.thm[je].s[It][Ct],Ft,c*Ue);Ft=Math.min(Ft,ra)}else if(tt!=0&&Se[je][tt-1]==3||tt==0&&q.nsPsy.lastAttacks[je]==3){var Ct=tt!=2?tt+1:0,ra=$(q.thm[je].s[It][Ct],Ft,c*Ue);Ft=Math.min(Ft,ra)}Ft*=we[je][tt],ma[tt]=Ft}for(var tt=0;tt<3;tt++)q.thm[je].s[It][tt]=ma[tt]}}}for(var je=0;je<xt;je++)q.nsPsy.lastAttacks[je]=Se[je][2];pe(x,Xe,ie);for(var je=0;je<xt;je++){var fa,ha,Ra,xa;je>1?(fa=J,ha=-2,Ra=O.NORM_TYPE,(ie[0]==O.SHORT_TYPE||ie[1]==O.SHORT_TYPE)&&(Ra=O.SHORT_TYPE),xa=H[V][je-2]):(fa=Z,ha=0,Ra=ie[je],xa=X[V][je]),Ra==O.SHORT_TYPE?fa[ha+je]=Ae(xa,q.masking_lower):fa[ha+je]=ge(xa,q.masking_lower),x.analysis&&(q.pinfo.pe[V][je]=fa[ha+je])}return 0};function He(x,I){var D=x,V;return D>=0?V=-D*27:V=D*I,V<=-72?0:Math.exp(V*i)}function fe(x){var I=0,D=0;{var V=0,X,H;for(V=0;He(V,x)>1e-20;V-=1);for(X=V,H=0;Math.abs(H-X)>1e-12;)V=(H+X)/2,He(V,x)>0?H=V:X=V;I=X}{var V=0,X,H;for(V=0;He(V,x)>1e-20;V+=1);for(X=0,H=V;Math.abs(H-X)>1e-12;)V=(H+X)/2,He(V,x)>0?X=V:H=V;D=H}{var Z=0,J=1e3,G;for(G=0;G<=J;++G){var V=I+G*(D-I)/J,ie=He(V,x);Z+=ie}{var q=(J+1)/(Z*(D-I));return q}}}function ae(x){var I,D,V,X;return I=x,I>=0?I*=3:I*=1.5,I>=.5&&I<=2.5?(X=I-.5,D=8*(X*X-2*X)):D=0,I+=.474,V=15.811389+7.5*I-17.5*Math.sqrt(1+I*I),V<=-60?0:(I=Math.exp((D+V)*i),I/=.6609193,I)}function ve(x){return x<0&&(x=0),x=x*.001,13*Math.atan(.76*x)+3.5*Math.atan(x*x/(7.5*7.5))}function se(x,I,D,V,X,H,Z,J,G,ie,q,ce){var Be=Pt(O.CBANDS+1),Ye=J/(ce>15?2*576:2*192),ye=Os(O.HBLKSIZE),qe;J/=G;var ne=0,Pe=0;for(qe=0;qe<O.CBANDS;qe++){var Je,we;for(Je=ve(J*ne),Be[qe]=J*ne,we=ne;ve(J*we)-Je<o&&we<=G/2;we++);for(x[qe]=we-ne,Pe=qe+1;ne<we;)ye[ne++]=qe;if(ne>G/2){ne=G/2,++qe;break}}Be[qe]=J*ne;for(var Ue=0;Ue<ce;Ue++){var Se,Xe,xt,je,We;xt=ie[Ue],je=ie[Ue+1],Se=0|Math.floor(.5+q*(xt-.5)),Se<0&&(Se=0),Xe=0|Math.floor(.5+q*(je-.5)),Xe>G/2&&(Xe=G/2),D[Ue]=(ye[Se]+ye[Xe])/2,I[Ue]=ye[Xe];var tt=Ye*je;Z[Ue]=(tt-Be[I[Ue]])/(Be[I[Ue]+1]-Be[I[Ue]]),Z[Ue]<0?Z[Ue]=0:Z[Ue]>1&&(Z[Ue]=1),We=ve(J*ie[Ue]*q),We=Math.min(We,15.5)/15.5,H[Ue]=Math.pow(10,1.25*(1-Math.cos(Math.PI*We))-2.5)}ne=0;for(var It=0;It<Pe;It++){var ma=x[It],Je,Ft;Je=ve(J*ne),Ft=ve(J*(ne+ma-1)),V[It]=.5*(Je+Ft),Je=ve(J*(ne-.5)),Ft=ve(J*(ne+ma-.5)),X[It]=Ft-Je,ne+=ma}return Pe}function le(x,I,D,V,X,H){var Z=Sa([O.CBANDS,O.CBANDS]),J,G=0;if(H)for(var ie=0;ie<I;ie++)for(J=0;J<I;J++){var q=ae(D[ie]-D[J])*V[J];Z[ie][J]=q*X[ie]}else for(J=0;J<I;J++)for(var ce=15+Math.min(21/D[J],12),Be=fe(ce),ie=0;ie<I;ie++){var q=Be*He(D[ie]-D[J],ce)*V[J];Z[ie][J]=q*X[ie]}for(var ie=0;ie<I;ie++){for(J=0;J<I&&!(Z[ie][J]>0);J++);for(x[ie][0]=J,J=I-1;J>0&&!(Z[ie][J]>0);J--);x[ie][1]=J,G+=x[ie][1]-x[ie][0]+1}for(var Ye=Pt(G),ye=0,ie=0;ie<I;ie++)for(J=x[ie][0];J<=x[ie][1];J++)Ye[ye++]=Z[ie][J];return Ye}function Q(x){var I=ve(x);return I=Math.min(I,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*I))-2.5)}this.psymodel_init=function(x){var I=x.internal_flags,D,V=!0,X=13,H=24,Z=0,J=0,G=-8.25,ie=-4.5,q=Pt(O.CBANDS),ce=Pt(O.CBANDS),Be=Pt(O.CBANDS),Ye=x.out_samplerate;switch(x.experimentalZ){default:case 0:V=!0;break;case 1:V=!(x.VBR==tr.vbr_mtrh||x.VBR==tr.vbr_mt);break;case 2:V=!1;break;case 3:X=8,Z=-1.75,J=-.0125,G=-8.25,ie=-2.25;break}for(I.ms_ener_ratio_old=.25,I.blocktype_old[0]=I.blocktype_old[1]=O.NORM_TYPE,D=0;D<4;++D){for(var ne=0;ne<O.CBANDS;++ne)I.nb_1[D][ne]=1e20,I.nb_2[D][ne]=1e20,I.nb_s1[D][ne]=I.nb_s2[D][ne]=1;for(var ye=0;ye<O.SBMAX_l;ye++)I.en[D].l[ye]=1e20,I.thm[D].l[ye]=1e20;for(var ne=0;ne<3;++ne){for(var ye=0;ye<O.SBMAX_s;ye++)I.en[D].s[ye][ne]=1e20,I.thm[D].s[ye][ne]=1e20;I.nsPsy.lastAttacks[D]=0}for(var ne=0;ne<9;ne++)I.nsPsy.last_en_subshort[D][ne]=10}for(I.loudness_sq_save[0]=I.loudness_sq_save[1]=0,I.npart_l=se(I.numlines_l,I.bo_l,I.bm_l,q,ce,I.mld_l,I.PSY.bo_l_weight,Ye,O.BLKSIZE,I.scalefac_band.l,O.BLKSIZE/(2*576),O.SBMAX_l),et(I.npart_l<O.CBANDS),D=0;D<I.npart_l;D++){var qe=Z;q[D]>=X&&(qe=J*(q[D]-X)/(H-X)+Z*(H-q[D])/(H-X)),Be[D]=Math.pow(10,qe/10),I.numlines_l[D]>0?I.rnumlines_l[D]=1/I.numlines_l[D]:I.rnumlines_l[D]=0}I.s3_ll=le(I.s3ind,I.npart_l,q,ce,Be,V);var ne=0;for(D=0;D<I.npart_l;D++){var Pe;Pe=e1.MAX_VALUE;for(var Je=0;Je<I.numlines_l[D];Je++,ne++){var we=Ye*ne/(1e3*O.BLKSIZE),Ue;Ue=this.ATHformula(we*1e3,x)-20,Ue=Math.pow(10,.1*Ue),Ue*=I.numlines_l[D],Pe>Ue&&(Pe=Ue)}I.ATH.cb_l[D]=Pe,Pe=-20+q[D]*20/10,Pe>6&&(Pe=100),Pe<-15&&(Pe=-15),Pe-=8,I.minval_l[D]=Math.pow(10,Pe/10)*I.numlines_l[D]}for(I.npart_s=se(I.numlines_s,I.bo_s,I.bm_s,q,ce,I.mld_s,I.PSY.bo_s_weight,Ye,O.BLKSIZE_s,I.scalefac_band.s,O.BLKSIZE_s/(2*192),O.SBMAX_s),et(I.npart_s<O.CBANDS),ne=0,D=0;D<I.npart_s;D++){var Pe,qe=G;q[D]>=X&&(qe=ie*(q[D]-X)/(H-X)+G*(H-q[D])/(H-X)),Be[D]=Math.pow(10,qe/10),Pe=e1.MAX_VALUE;for(var Je=0;Je<I.numlines_s[D];Je++,ne++){var we=Ye*ne/(1e3*O.BLKSIZE_s),Ue;Ue=this.ATHformula(we*1e3,x)-20,Ue=Math.pow(10,.1*Ue),Ue*=I.numlines_s[D],Pe>Ue&&(Pe=Ue)}I.ATH.cb_s[D]=Pe,Pe=-7+q[D]*7/12,q[D]>12&&(Pe*=1+Math.log(1+Pe)*3.1),q[D]<12&&(Pe*=1+Math.log(1-Pe)*2.3),Pe<-15&&(Pe=-15),Pe-=8,I.minval_s[D]=Math.pow(10,Pe/10)*I.numlines_s[D]}I.s3_ss=le(I.s3ind_s,I.npart_s,q,ce,Be,V),S(),e.init_fft(I),I.decay=Math.exp(-1*t/(b*Ye/192));{var Se;Se=E,x.exp_nspsytune&2&&(Se=1),Math.abs(x.msfix)>0&&(Se=x.msfix),x.msfix=Se;for(var Xe=0;Xe<I.npart_l;Xe++)I.s3ind[Xe][1]>I.npart_l-1&&(I.s3ind[Xe][1]=I.npart_l-1)}var xt=576*I.mode_gr/Ye;if(I.ATH.decay=Math.pow(10,-12/10*xt),I.ATH.adjust=.01,I.ATH.adjustLimit=1,et(I.bo_l[O.SBMAX_l-1]<=I.npart_l),et(I.bo_s[O.SBMAX_s-1]<=I.npart_s),x.ATHtype!=-1){var we,je=x.out_samplerate/O.BLKSIZE,We=0;for(we=0,D=0;D<O.BLKSIZE/2;++D)we+=je,I.ATH.eql_w[D]=1/Math.pow(10,this.ATHformula(we,x)/10),We+=I.ATH.eql_w[D];for(We=1/We,D=O.BLKSIZE/2;--D>=0;)I.ATH.eql_w[D]*=We}{for(var Xe=ne=0;Xe<I.npart_s;++Xe)for(D=0;D<I.numlines_s[Xe];++D)++ne;for(var Xe=ne=0;Xe<I.npart_l;++Xe)for(D=0;D<I.numlines_l[Xe];++D)++ne}for(ne=0,D=0;D<I.npart_l;D++){var we=Ye*(ne+I.numlines_l[D]/2)/(1*O.BLKSIZE);I.mld_cb_l[D]=Q(we),ne+=I.numlines_l[D]}for(;D<O.CBANDS;++D)I.mld_cb_l[D]=1;for(ne=0,D=0;D<I.npart_s;D++){var we=Ye*(ne+I.numlines_s[D]/2)/(1*O.BLKSIZE_s);I.mld_cb_s[D]=Q(we),ne+=I.numlines_s[D]}for(;D<O.CBANDS;++D)I.mld_cb_s[D]=1;return 0};function Oe(x,I){x<-.3&&(x=3410),x/=1e3,x=Math.max(.1,x);var D=3.64*Math.pow(x,-.8)-6.8*Math.exp(-.6*Math.pow(x-3.4,2))+6*Math.exp(-.15*Math.pow(x-8.7,2))+(.6+.04*I)*.001*Math.pow(x,4);return D}this.ATHformula=function(x,I){var D;switch(I.ATHtype){case 0:D=Oe(x,9);break;case 1:D=Oe(x,-1);break;case 2:D=Oe(x,0);break;case 3:D=Oe(x,1)+6;break;case 4:D=Oe(x,I.ATHcurve);break;default:D=Oe(x,0);break}return D}}function Sp(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=vt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var bs={};bs.SFBMAX=O.SBMAX_s*3;var Mp=Ie.new_float,Is=Ie.new_int;function ci(){this.xr=Mp(576),this.l3_enc=Is(576),this.scalefac=Is(bs.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Is(3),this.subblock_gain=Is(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Is(bs.SFBMAX),this.window=Is(bs.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Is(4),this.max_nonzero_coeff=0;var e=this;function t(s){return new Int32Array(s)}function a(s){return new Float32Array(s)}this.assign=function(s){e.xr=a(s.xr),e.l3_enc=t(s.l3_enc),e.scalefac=t(s.scalefac),e.xrpow_max=s.xrpow_max,e.part2_3_length=s.part2_3_length,e.big_values=s.big_values,e.count1=s.count1,e.global_gain=s.global_gain,e.scalefac_compress=s.scalefac_compress,e.block_type=s.block_type,e.mixed_block_flag=s.mixed_block_flag,e.table_select=t(s.table_select),e.subblock_gain=t(s.subblock_gain),e.region0_count=s.region0_count,e.region1_count=s.region1_count,e.preflag=s.preflag,e.scalefac_scale=s.scalefac_scale,e.count1table_select=s.count1table_select,e.part2_length=s.part2_length,e.sfb_lmax=s.sfb_lmax,e.sfb_smin=s.sfb_smin,e.psy_lmax=s.psy_lmax,e.sfbmax=s.sfbmax,e.psymax=s.psymax,e.sfbdivide=s.sfbdivide,e.width=t(s.width),e.window=t(s.window),e.count1bits=s.count1bits,e.sfb_partition_table=s.sfb_partition_table.slice(0),e.slen=t(s.slen),e.max_nonzero_coeff=s.max_nonzero_coeff}}var t1=Ie.new_int;function Ep(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[t1(4),t1(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new ci}var Dn=Ie.System,Vn=Ie.new_int;function Da(e,t,a,s){this.l=Vn(1+O.SBMAX_l),this.s=Vn(1+O.SBMAX_s),this.psfb21=Vn(1+O.PSFB21),this.psfb12=Vn(1+O.PSFB12);var n=this.l,r=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Dn.arraycopy(this.arrL,0,n,0,Math.min(this.arrL.length,this.l.length)),Dn.arraycopy(this.arrS,0,r,0,Math.min(this.arrS.length,this.s.length)),Dn.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Dn.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var uo=Ie.new_float,Ap=Ie.new_float_n,kp=Ie.new_int;function Tp(){this.last_en_subshort=Ap([4,9]),this.lastAttacks=kp(4),this.pefirbuf=uo(19),this.longfact=uo(O.SBMAX_l),this.shortfact=uo(O.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Rp(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var xp=Ie.new_byte,Op=Ie.new_double,Ma=Ie.new_float,Cs=Ie.new_float_n,Oa=Ie.new_int,qn=Ie.new_int_n;mt.MFSIZE=3*1152+O.ENCDELAY-O.MDCTDELAY;mt.MAX_HEADER_BUF=256;mt.MAX_BITS_PER_CHANNEL=4095;mt.MAX_BITS_PER_GRANULE=7680;mt.BPC=320;function mt(){var e=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Cs([2,mt.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Ep,this.ms_ratio=Ma(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Oa(2),this.CurrentStep=Oa(2),this.masking_lower=0,this.bv_scf=Oa(576),this.pseudohalf=Oa(bs.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*mt.BPC+1),this.itime=Op(2),this.sideinfo_len=0,this.sb_sample=Cs([2,2,18,O.SBLIMIT]),this.amp_filter=Ma(32);function t(){this.write_timing=0,this.ptr=0,this.buf=xp(e)}this.header=new Array(mt.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Da,this.minval_l=Ma(O.CBANDS),this.minval_s=Ma(O.CBANDS),this.nb_1=Cs([4,O.CBANDS]),this.nb_2=Cs([4,O.CBANDS]),this.nb_s1=Cs([4,O.CBANDS]),this.nb_s2=Cs([4,O.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Ma(4),this.loudness_sq=Cs([2,2]),this.loudness_sq_save=Ma(2),this.mld_l=Ma(O.SBMAX_l),this.mld_s=Ma(O.SBMAX_s),this.bm_l=Oa(O.SBMAX_l),this.bo_l=Oa(O.SBMAX_l),this.bm_s=Oa(O.SBMAX_s),this.bo_s=Oa(O.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=qn([O.CBANDS,2]),this.s3ind_s=qn([O.CBANDS,2]),this.numlines_s=Oa(O.CBANDS),this.numlines_l=Oa(O.CBANDS),this.rnumlines_l=Ma(O.CBANDS),this.mld_cb_l=Ma(O.CBANDS),this.mld_cb_s=Ma(O.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Ma(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Oa(2),this.nsPsy=new Tp,this.VBR_seek_table=new Rp,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=qn([16,4+1]),this.bitrate_blockType_Hist=qn([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var a=0;a<this.en.length;a++)this.en[a]=new li;for(var a=0;a<this.thm.length;a++)this.thm[a]=new li;for(var a=0;a<this.header.length;a++)this.header[a]=new t}var Bs=Ie.new_float;function Ip(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Bs(O.SBMAX_l),this.s=Bs(O.SBMAX_s),this.psfb21=Bs(O.PSFB21),this.psfb12=Bs(O.PSFB12),this.cb_l=Bs(O.CBANDS),this.cb_s=Bs(O.CBANDS),this.eql_w=Bs(O.BLKSIZE/2)}var oa=Ie.System,a1=Ie.Arrays;jt.STEPS_per_dB=100;jt.MAX_dB=120;jt.GAIN_NOT_ENOUGH_SAMPLES=-24601;jt.GAIN_ANALYSIS_ERROR=0;jt.GAIN_ANALYSIS_OK=1;jt.INIT_GAIN_ANALYSIS_ERROR=0;jt.INIT_GAIN_ANALYSIS_OK=1;jt.YULE_ORDER=10;jt.MAX_ORDER=jt.YULE_ORDER;jt.MAX_SAMP_FREQ=48e3;jt.RMS_WINDOW_TIME_NUMERATOR=1;jt.RMS_WINDOW_TIME_DENOMINATOR=20;jt.MAX_SAMPLES_PER_WINDOW=jt.MAX_SAMP_FREQ*jt.RMS_WINDOW_TIME_NUMERATOR/jt.RMS_WINDOW_TIME_DENOMINATOR+1;function jt(){var e=64.82,t=.95,a=jt.RMS_WINDOW_TIME_NUMERATOR,s=jt.RMS_WINDOW_TIME_DENOMINATOR,n=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],r=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(c,E,A,i,F,L){for(;F--!=0;)A[i]=1e-10+c[E+0]*L[0]-A[i-1]*L[1]+c[E-1]*L[2]-A[i-2]*L[3]+c[E-2]*L[4]-A[i-3]*L[5]+c[E-3]*L[6]-A[i-4]*L[7]+c[E-4]*L[8]-A[i-5]*L[9]+c[E-5]*L[10]-A[i-6]*L[11]+c[E-6]*L[12]-A[i-7]*L[13]+c[E-7]*L[14]-A[i-8]*L[15]+c[E-8]*L[16]-A[i-9]*L[17]+c[E-9]*L[18]-A[i-10]*L[19]+c[E-10]*L[20],++i,++E}function u(c,E,A,i,F,L){for(;F--!=0;)A[i]=c[E+0]*L[0]-A[i-1]*L[1]+c[E-1]*L[2]-A[i-2]*L[3]+c[E-2]*L[4],++i,++E}function b(c,E){for(var A=0;A<MAX_ORDER;A++)c.linprebuf[A]=c.lstepbuf[A]=c.loutbuf[A]=c.rinprebuf[A]=c.rstepbuf[A]=c.routbuf[A]=0;switch(0|E){case 48e3:c.reqindex=0;break;case 44100:c.reqindex=1;break;case 32e3:c.reqindex=2;break;case 24e3:c.reqindex=3;break;case 22050:c.reqindex=4;break;case 16e3:c.reqindex=5;break;case 12e3:c.reqindex=6;break;case 11025:c.reqindex=7;break;case 8e3:c.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return c.sampleWindow=0|(E*a+s-1)/s,c.lsum=0,c.rsum=0,c.totsamp=0,a1.ill(c.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(c,E){return b(c,E)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(c.linpre=MAX_ORDER,c.rinpre=MAX_ORDER,c.lstep=MAX_ORDER,c.rstep=MAX_ORDER,c.lout=MAX_ORDER,c.rout=MAX_ORDER,a1.fill(c.B,0),INIT_GAIN_ANALYSIS_OK)};function l(c){return c*c}this.AnalyzeSamples=function(c,E,A,i,F,L,B){var f,R,C,T,N,m,k;if(L==0)return GAIN_ANALYSIS_OK;switch(k=0,N=L,B){case 1:i=E,F=A;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(L<MAX_ORDER?(oa.arraycopy(E,A,c.linprebuf,MAX_ORDER,L),oa.arraycopy(i,F,c.rinprebuf,MAX_ORDER,L)):(oa.arraycopy(E,A,c.linprebuf,MAX_ORDER,MAX_ORDER),oa.arraycopy(i,F,c.rinprebuf,MAX_ORDER,MAX_ORDER));N>0;){m=N>c.sampleWindow-c.totsamp?c.sampleWindow-c.totsamp:N,k<MAX_ORDER?(f=c.linpre+k,R=c.linprebuf,C=c.rinpre+k,T=c.rinprebuf,m>MAX_ORDER-k&&(m=MAX_ORDER-k)):(f=A+k,R=E,C=F+k,T=i),o(R,f,c.lstepbuf,c.lstep+c.totsamp,m,n[c.reqindex]),o(T,C,c.rstepbuf,c.rstep+c.totsamp,m,n[c.reqindex]),u(c.lstepbuf,c.lstep+c.totsamp,c.loutbuf,c.lout+c.totsamp,m,r[c.reqindex]),u(c.rstepbuf,c.rstep+c.totsamp,c.routbuf,c.rout+c.totsamp,m,r[c.reqindex]),f=c.lout+c.totsamp,R=c.loutbuf,C=c.rout+c.totsamp,T=c.routbuf;for(var S=m%8;S--!=0;)c.lsum+=l(R[f++]),c.rsum+=l(T[C++]);for(S=m/8;S--!=0;)c.lsum+=l(R[f+0])+l(R[f+1])+l(R[f+2])+l(R[f+3])+l(R[f+4])+l(R[f+5])+l(R[f+6])+l(R[f+7]),f+=8,c.rsum+=l(T[C+0])+l(T[C+1])+l(T[C+2])+l(T[C+3])+l(T[C+4])+l(T[C+5])+l(T[C+6])+l(T[C+7]),C+=8;if(N-=m,k+=m,c.totsamp+=m,c.totsamp==c.sampleWindow){var h=jt.STEPS_per_dB*10*Math.log10((c.lsum+c.rsum)/c.totsamp*.5+1e-37),g=h<=0?0:0|h;g>=c.A.length&&(g=c.A.length-1),c.A[g]++,c.lsum=c.rsum=0,oa.arraycopy(c.loutbuf,c.totsamp,c.loutbuf,0,MAX_ORDER),oa.arraycopy(c.routbuf,c.totsamp,c.routbuf,0,MAX_ORDER),oa.arraycopy(c.lstepbuf,c.totsamp,c.lstepbuf,0,MAX_ORDER),oa.arraycopy(c.rstepbuf,c.totsamp,c.rstepbuf,0,MAX_ORDER),c.totsamp=0}if(c.totsamp>c.sampleWindow)return GAIN_ANALYSIS_ERROR}return L<MAX_ORDER?(oa.arraycopy(c.linprebuf,L,c.linprebuf,0,MAX_ORDER-L),oa.arraycopy(c.rinprebuf,L,c.rinprebuf,0,MAX_ORDER-L),oa.arraycopy(E,A,c.linprebuf,MAX_ORDER-L,L),oa.arraycopy(i,F,c.rinprebuf,MAX_ORDER-L,L)):(oa.arraycopy(E,A+L-MAX_ORDER,c.linprebuf,0,MAX_ORDER),oa.arraycopy(i,F+L-MAX_ORDER,c.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function p(c,E){var A,i=0;for(A=0;A<E;A++)i+=c[A];if(i==0)return GAIN_NOT_ENOUGH_SAMPLES;var F=0|Math.ceil(i*(1-t));for(A=E;A-- >0&&!((F-=c[A])<=0););return e-A/jt.STEPS_per_dB}this.GetTitleGain=function(c){for(var E=p(c.A,c.A.length),A=0;A<c.A.length;A++)c.B[A]+=c.A[A],c.A[A]=0;for(var A=0;A<MAX_ORDER;A++)c.linprebuf[A]=c.lstepbuf[A]=c.loutbuf[A]=c.rinprebuf[A]=c.rstepbuf[A]=c.routbuf[A]=0;return c.totsamp=0,c.lsum=c.rsum=0,E}}var sr=Ie.new_float,s1=Ie.new_int;function Cp(){this.linprebuf=sr(void 0*2),this.linpre=0,this.lstepbuf=sr(void 0+void 0),this.lstep=0,this.loutbuf=sr(void 0+void 0),this.lout=0,this.rinprebuf=sr(void 0*2),this.rinpre=0,this.rstepbuf=sr(void 0+void 0),this.rstep=0,this.routbuf=sr(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=s1(0|void 0*void 0),this.B=s1(0|void 0*void 0)}function Fu(e){this.bits=e}var r1=Ie.new_float,Bp=Ie.new_int,n1=Ie.assert;function Lp(e){var t=e;this.quantize=t,this.iteration_loop=function(a,s,n,r){var o=a.internal_flags,u=r1(bs.SFBMAX),b=r1(576),l=Bp(2),p=0,c,E=o.l3_side,A=new Fu(p);this.quantize.rv.ResvFrameBegin(a,A),p=A.bits;for(var i=0;i<o.mode_gr;i++){c=this.quantize.qupvt.on_pe(a,s,l,p,i,i),o.mode_ext==O.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,i),this.quantize.qupvt.reduce_side(l,n[i],p,c));for(var F=0;F<o.channels_out;F++){var L,B,f=E.tt[i][F];f.block_type!=O.SHORT_TYPE?(L=0,B=o.PSY.mask_adjust-L):(L=0,B=o.PSY.mask_adjust_short-L),o.masking_lower=Math.pow(10,B*.1),this.quantize.init_outer_loop(o,f),this.quantize.init_xrpow(o,f,b)&&(this.quantize.qupvt.calc_xmin(a,r[i][F],f,u),this.quantize.outer_loop(a,f,u,b,F,l[F])),this.quantize.iteration_finish_one(o,i,F),n1(f.part2_3_length<=mt.MAX_BITS_PER_CHANNEL),n1(f.part2_3_length<=l[F])}}this.quantize.rv.ResvFrameEnd(o,p)}}function ut(e,t,a,s){this.xlen=e,this.linmax=t,this.table=a,this.hlen=s}var oe={};oe.t1HB=[1,1,1,0];oe.t2HB=[1,2,1,3,1,1,3,2,0];oe.t3HB=[3,2,1,1,1,1,3,2,0];oe.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];oe.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];oe.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];oe.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];oe.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];oe.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];oe.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];oe.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];oe.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];oe.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];oe.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];oe.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];oe.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];oe.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];oe.t1l=[1,4,3,5];oe.t2l=[1,4,7,4,5,7,6,7,8];oe.t3l=[2,3,7,4,4,7,6,7,8];oe.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];oe.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];oe.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];oe.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];oe.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];oe.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];oe.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];oe.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];oe.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];oe.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];oe.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];oe.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];oe.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];oe.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4];oe.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4];oe.ht=[new ut(0,0,null,null),new ut(2,0,oe.t1HB,oe.t1l),new ut(3,0,oe.t2HB,oe.t2l),new ut(3,0,oe.t3HB,oe.t3l),new ut(0,0,null,null),new ut(4,0,oe.t5HB,oe.t5l),new ut(4,0,oe.t6HB,oe.t6l),new ut(6,0,oe.t7HB,oe.t7l),new ut(6,0,oe.t8HB,oe.t8l),new ut(6,0,oe.t9HB,oe.t9l),new ut(8,0,oe.t10HB,oe.t10l),new ut(8,0,oe.t11HB,oe.t11l),new ut(8,0,oe.t12HB,oe.t12l),new ut(16,0,oe.t13HB,oe.t13l),new ut(0,0,null,oe.t16_5l),new ut(16,0,oe.t15HB,oe.t15l),new ut(1,1,oe.t16HB,oe.t16l),new ut(2,3,oe.t16HB,oe.t16l),new ut(3,7,oe.t16HB,oe.t16l),new ut(4,15,oe.t16HB,oe.t16l),new ut(6,63,oe.t16HB,oe.t16l),new ut(8,255,oe.t16HB,oe.t16l),new ut(10,1023,oe.t16HB,oe.t16l),new ut(13,8191,oe.t16HB,oe.t16l),new ut(4,15,oe.t24HB,oe.t24l),new ut(5,31,oe.t24HB,oe.t24l),new ut(6,63,oe.t24HB,oe.t24l),new ut(7,127,oe.t24HB,oe.t24l),new ut(8,255,oe.t24HB,oe.t24l),new ut(9,511,oe.t24HB,oe.t24l),new ut(11,2047,oe.t24HB,oe.t24l),new ut(13,8191,oe.t24HB,oe.t24l),new ut(0,0,oe.t32HB,oe.t32l),new ut(0,0,oe.t33HB,oe.t33l)];oe.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];oe.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];oe.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];oe.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];oe.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];oe.scfsi_band=[0,6,11,16,21];var Ls=Ie.VbrMode,zn=Ie.Float,mo=Ie.Util,Ns=Ie.new_float,Np=Ie.new_int,Cr=Ie.assert;Gt.Q_MAX=256+1;Gt.Q_MAX2=116;Gt.LARGE_BITS=1e5;Gt.IXMAX_VAL=8206;function Gt(){var e=null,t=null,a=null;this.setModules=function(f,R,C){e=f,t=R,a=C};function s(f){return c[f+Gt.Q_MAX2]}this.IPOW20=function(f){return E[f]};var n=2220446049250313e-31,r=Gt.IXMAX_VAL,o=r+2,u=Gt.Q_MAX,b=Gt.Q_MAX2,l=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var p=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=p,this.sfBandIndex=[new Da([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Da([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var c=Ns(u+b+1),E=Ns(u),A=Ns(o),i=Ns(o);this.adj43=i;function F(f,R){var C=a.ATHformula(R,f);return C-=l,C=Math.pow(10,C/10+f.ATHlower),C}function L(f){for(var R=f.internal_flags.ATH.l,C=f.internal_flags.ATH.psfb21,T=f.internal_flags.ATH.s,N=f.internal_flags.ATH.psfb12,m=f.internal_flags,k=f.out_samplerate,S=0;S<O.SBMAX_l;S++){var h=m.scalefac_band.l[S],g=m.scalefac_band.l[S+1];R[S]=zn.MAX_VALUE;for(var _=h;_<g;_++){var v=_*k/1152,y=F(f,v);R[S]=Math.min(R[S],y)}}for(var S=0;S<O.PSFB21;S++){var h=m.scalefac_band.psfb21[S],g=m.scalefac_band.psfb21[S+1];C[S]=zn.MAX_VALUE;for(var _=h;_<g;_++){var v=_*k/1152,y=F(f,v);C[S]=Math.min(C[S],y)}}for(var S=0;S<O.SBMAX_s;S++){var h=m.scalefac_band.s[S],g=m.scalefac_band.s[S+1];T[S]=zn.MAX_VALUE;for(var _=h;_<g;_++){var v=_*k/384,y=F(f,v);T[S]=Math.min(T[S],y)}T[S]*=m.scalefac_band.s[S+1]-m.scalefac_band.s[S]}for(var S=0;S<O.PSFB12;S++){var h=m.scalefac_band.psfb12[S],g=m.scalefac_band.psfb12[S+1];N[S]=zn.MAX_VALUE;for(var _=h;_<g;_++){var v=_*k/384,y=F(f,v);N[S]=Math.min(N[S],y)}N[S]*=m.scalefac_band.s[13]-m.scalefac_band.s[12]}if(f.noATH){for(var S=0;S<O.SBMAX_l;S++)R[S]=1e-20;for(var S=0;S<O.PSFB21;S++)C[S]=1e-20;for(var S=0;S<O.SBMAX_s;S++)T[S]=1e-20;for(var S=0;S<O.PSFB12;S++)N[S]=1e-20}m.ATH.floor=10*Math.log10(F(f,-1))}this.iteration_init=function(f){var R=f.internal_flags,C=R.l3_side,T;if(R.iteration_init_init==0){for(R.iteration_init_init=1,C.main_data_begin=0,L(f),A[0]=0,T=1;T<o;T++)A[T]=Math.pow(T,4/3);for(T=0;T<o-1;T++)i[T]=T+1-Math.pow(.5*(A[T]+A[T+1]),.75);for(i[T]=.5,T=0;T<u;T++)E[T]=Math.pow(2,(T-210)*-.1875);for(T=0;T<=u+b;T++)c[T]=Math.pow(2,(T-210-b)*.25);e.huffman_init(R);{var N,m,k,S;for(T=f.exp_nspsytune>>2&63,T>=32&&(T-=64),N=Math.pow(10,T/4/10),T=f.exp_nspsytune>>8&63,T>=32&&(T-=64),m=Math.pow(10,T/4/10),T=f.exp_nspsytune>>14&63,T>=32&&(T-=64),k=Math.pow(10,T/4/10),T=f.exp_nspsytune>>20&63,T>=32&&(T-=64),S=k*Math.pow(10,T/4/10),T=0;T<O.SBMAX_l;T++){var h;T<=6?h=N:T<=13?h=m:T<=20?h=k:h=S,R.nsPsy.longfact[T]=h}for(T=0;T<O.SBMAX_s;T++){var h;T<=5?h=N:T<=10?h=m:T<=11?h=k:h=S,R.nsPsy.shortfact[T]=h}}}},this.on_pe=function(f,R,C,T,N,m){var k=f.internal_flags,S=0,h,g=Np(2),_,v=new Fu(S),y=t.ResvMaxBits(f,T,v,m);S=v.bits;var w=S+y;for(w>mt.MAX_BITS_PER_GRANULE&&(w=mt.MAX_BITS_PER_GRANULE),h=0,_=0;_<k.channels_out;++_)C[_]=Math.min(mt.MAX_BITS_PER_CHANNEL,S/k.channels_out),g[_]=0|C[_]*R[N][_]/700-C[_],g[_]>T*3/4&&(g[_]=T*3/4),g[_]<0&&(g[_]=0),g[_]+C[_]>mt.MAX_BITS_PER_CHANNEL&&(g[_]=Math.max(0,mt.MAX_BITS_PER_CHANNEL-C[_])),h+=g[_];if(h>y)for(_=0;_<k.channels_out;++_)g[_]=y*g[_]/h;for(_=0;_<k.channels_out;++_)C[_]+=g[_],y-=g[_];for(h=0,_=0;_<k.channels_out;++_)h+=C[_];if(h>mt.MAX_BITS_PER_GRANULE){var j=0;for(_=0;_<k.channels_out;++_)C[_]*=mt.MAX_BITS_PER_GRANULE,C[_]/=h,j+=C[_]}return w},this.reduce_side=function(f,R,C,T){Cr(f[0]+f[1]<=mt.MAX_BITS_PER_GRANULE);var N=.33*(.5-R)/.5;N<0&&(N=0),N>.5&&(N=.5);var m=0|N*.5*(f[0]+f[1]);m>mt.MAX_BITS_PER_CHANNEL-f[0]&&(m=mt.MAX_BITS_PER_CHANNEL-f[0]),m<0&&(m=0),f[1]>=125&&(f[1]-m>125?(f[0]<C&&(f[0]+=m),f[1]-=m):(f[0]+=f[1]-125,f[1]=125)),m=f[0]+f[1],m>T&&(f[0]=T*f[0]/m,f[1]=T*f[1]/m),Cr(f[0]<=mt.MAX_BITS_PER_CHANNEL),Cr(f[1]<=mt.MAX_BITS_PER_CHANNEL),Cr(f[0]+f[1]<=mt.MAX_BITS_PER_GRANULE)},this.athAdjust=function(f,R,C){var T=90.30873362,N=94.82444863,m=mo.FAST_LOG10_X(R,10),k=f*f,S=0;return m-=C,k>1e-20&&(S=1+mo.FAST_LOG10_X(k,10/T)),S<0&&(S=0),m*=S,m+=C+T-N,Math.pow(10,.1*m)},this.calc_xmin=function(f,R,C,T){var N=0,m=f.internal_flags,k,S=0,h=0,g=m.ATH,_=C.xr,v=f.VBR==Ls.vbr_mtrh?1:0,y=m.masking_lower;for((f.VBR==Ls.vbr_mtrh||f.VBR==Ls.vbr_mt)&&(y=1),k=0;k<C.psy_lmax;k++){var w,j,K,P,z,d;f.VBR==Ls.vbr_rh||f.VBR==Ls.vbr_mtrh?j=athAdjust(g.adjust,g.l[k],g.floor):j=g.adjust*g.l[k],z=C.width[k],K=j/z,P=n,d=z>>1,w=0;do{var M,W;M=_[S]*_[S],w+=M,P+=M<K?M:K,S++,W=_[S]*_[S],w+=W,P+=W<K?W:K,S++}while(--d>0);if(w>j&&h++,k==O.SBPSY_l){var $=j*m.nsPsy.longfact[k];P<$&&(P=$)}if(v!=0&&(j=P),!f.ATHonly){var _e=R.en.l[k];if(_e>0){var $;$=w*R.thm.l[k]*y/_e,v!=0&&($*=m.nsPsy.longfact[k]),j<$&&(j=$)}}v!=0?T[N++]=j:T[N++]=j*m.nsPsy.longfact[k]}var Ae=575;if(C.block_type!=O.SHORT_TYPE)for(var Re=576;Re--!=0&&Ea.EQ(_[Re],0);)Ae=Re;C.max_nonzero_coeff=Ae;for(var ge=C.sfb_smin;k<C.psymax;ge++,k+=3){var z,Ve,Ne;for(f.VBR==Ls.vbr_rh||f.VBR==Ls.vbr_mtrh?Ne=athAdjust(g.adjust,g.s[ge],g.floor):Ne=g.adjust*g.s[ge],z=C.width[k],Ve=0;Ve<3;Ve++){var w=0,j,K,P,d=z>>1;K=Ne/z,P=n;do{var M,W;M=_[S]*_[S],w+=M,P+=M<K?M:K,S++,W=_[S]*_[S],w+=W,P+=W<K?W:K,S++}while(--d>0);if(w>Ne&&h++,ge==O.SBPSY_s){var $=Ne*m.nsPsy.shortfact[ge];P<$&&(P=$)}if(v!=0?j=P:j=Ne,!f.ATHonly&&!f.ATHshort){var _e=R.en.s[ge][Ve];if(_e>0){var $;$=w*R.thm.s[ge][Ve]*y/_e,v!=0&&($*=m.nsPsy.shortfact[ge]),j<$&&(j=$)}}v!=0?T[N++]=j:T[N++]=j*m.nsPsy.shortfact[ge]}f.useTemporal&&(T[N-3]>T[N-3+1]&&(T[N-3+1]+=(T[N-3]-T[N-3+1])*m.decay),T[N-3+1]>T[N-3+2]&&(T[N-3+2]+=(T[N-3+1]-T[N-3+2])*m.decay))}return h};function B(f){this.s=f}this.calc_noise_core=function(f,R,C,T){var N=0,m=R.s,k=f.l3_enc;if(m>f.count1)for(;C--!=0;){var S;S=f.xr[m],m++,N+=S*S,S=f.xr[m],m++,N+=S*S}else if(m>f.big_values){var h=Ns(2);for(h[0]=0,h[1]=T;C--!=0;){var S;S=Math.abs(f.xr[m])-h[k[m]],m++,N+=S*S,S=Math.abs(f.xr[m])-h[k[m]],m++,N+=S*S}}else for(;C--!=0;){var S;S=Math.abs(f.xr[m])-A[k[m]]*T,m++,N+=S*S,S=Math.abs(f.xr[m])-A[k[m]]*T,m++,N+=S*S}return R.s=m,N},this.calc_noise=function(f,R,C,T,N){var m=0,k=0,S,h,g=0,_=0,v=0,y=-20,w=0,j=f.scalefac,K=0;for(T.over_SSD=0,S=0;S<f.psymax;S++){var P=f.global_gain-(j[K++]+(f.preflag!=0?p[S]:0)<<f.scalefac_scale+1)-f.subblock_gain[f.window[S]]*8,z=0;if(N!=null&&N.step[S]==P)z=N.noise[S],w+=f.width[S],C[m++]=z/R[k++],z=N.noise_log[S];else{var d=s(P);if(h=f.width[S]>>1,w+f.width[S]>f.max_nonzero_coeff){var M;M=f.max_nonzero_coeff-w+1,M>0?h=M>>1:h=0}var W=new B(w);z=this.calc_noise_core(f,W,h,d),w=W.s,N!=null&&(N.step[S]=P,N.noise[S]=z),z=C[m++]=z/R[k++],z=mo.FAST_LOG10(Math.max(z,1e-20)),N!=null&&(N.noise_log[S]=z)}if(N!=null&&(N.global_gain=f.global_gain),v+=z,z>0){var $;$=Math.max(0|z*10+.5,1),T.over_SSD+=$*$,g++,_+=z}y=Math.max(y,z)}return T.over_count=g,T.tot_noise=v,T.over_noise=_,T.max_noise=y,g},this.set_pinfo=function(f,R,C,T,N){var m=f.internal_flags,k,S,h,g,_,v=R.scalefac_scale==0?.5:1,y=R.scalefac,w=Ns(L3Side.SFBMAX),j=Ns(L3Side.SFBMAX),K=new CalcNoiseResult;calc_xmin(f,C,R,w),calc_noise(R,w,j,K,null);var P=0;for(S=R.sfb_lmax,R.block_type!=O.SHORT_TYPE&&R.mixed_block_flag==0&&(S=22),k=0;k<S;k++){var z=m.scalefac_band.l[k],d=m.scalefac_band.l[k+1],M=d-z;for(g=0;P<d;P++)g+=R.xr[P]*R.xr[P];g/=M,_=1e15,m.pinfo.en[T][N][k]=_*g,m.pinfo.xfsf[T][N][k]=_*w[k]*j[k]/M,C.en.l[k]>0&&!f.ATHonly?g=g/C.en.l[k]:g=0,m.pinfo.thr[T][N][k]=_*Math.max(g*C.thm.l[k],m.ATH.l[k]),m.pinfo.LAMEsfb[T][N][k]=0,R.preflag!=0&&k>=11&&(m.pinfo.LAMEsfb[T][N][k]=-v*p[k]),k<O.SBPSY_l&&(Cr(y[k]>=0),m.pinfo.LAMEsfb[T][N][k]-=v*y[k])}if(R.block_type==O.SHORT_TYPE)for(S=k,k=R.sfb_smin;k<O.SBMAX_s;k++)for(var z=m.scalefac_band.s[k],d=m.scalefac_band.s[k+1],M=d-z,W=0;W<3;W++){for(g=0,h=z;h<d;h++)g+=R.xr[P]*R.xr[P],P++;g=Math.max(g/M,1e-20),_=1e15,m.pinfo.en_s[T][N][3*k+W]=_*g,m.pinfo.xfsf_s[T][N][3*k+W]=_*w[S]*j[S]/M,C.en.s[k][W]>0?g=g/C.en.s[k][W]:g=0,(f.ATHonly||f.ATHshort)&&(g=0),m.pinfo.thr_s[T][N][3*k+W]=_*Math.max(g*C.thm.s[k][W],m.ATH.s[k]),m.pinfo.LAMEsfb_s[T][N][3*k+W]=-2*R.subblock_gain[W],k<O.SBPSY_s&&(m.pinfo.LAMEsfb_s[T][N][3*k+W]-=v*y[S]),S++}m.pinfo.LAMEqss[T][N]=R.global_gain,m.pinfo.LAMEmainbits[T][N]=R.part2_3_length+R.part2_length,m.pinfo.LAMEsfbits[T][N]=R.part2_length,m.pinfo.over[T][N]=K.over_count,m.pinfo.max_noise[T][N]=K.max_noise*10,m.pinfo.over_noise[T][N]=K.over_noise*10,m.pinfo.tot_noise[T][N]=K.tot_noise*10,m.pinfo.over_SSD[T][N]=K.over_SSD}}var jp=Ie.System,Fp=Ie.Arrays,Br=Ie.new_int,fo=Ie.assert;function un(){var e=null;this.qupvt=null,this.setModules=function(h){this.qupvt=h,e=h};function t(h){this.bits=0|h}var a=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function s(h,g,_,v,y,w){var j=.5946/g;for(h=h>>1;h--!=0;)y[w++]=j>_[v++]?0:1,y[w++]=j>_[v++]?0:1}function n(h,g,_,v,y,w){h=h>>1;var j=h%2;for(h=h>>1;h--!=0;){var K,P,z,d,M,W,$,_e;K=_[v++]*g,P=_[v++]*g,M=0|K,z=_[v++]*g,W=0|P,d=_[v++]*g,$=0|z,K+=e.adj43[M],_e=0|d,P+=e.adj43[W],y[w++]=0|K,z+=e.adj43[$],y[w++]=0|P,d+=e.adj43[_e],y[w++]=0|z,y[w++]=0|d}if(j!=0){var K,P,M,W;K=_[v++]*g,P=_[v++]*g,M=0|K,W=0|P,K+=e.adj43[M],P+=e.adj43[W],y[w++]=0|K,y[w++]=0|P}}function r(h,g,_,v,y){var w,j,K=0,P,z=0,d=0,M=0,W=g,$=0,_e=W,Ae=0,Re=h,ge=0;for(P=y!=null&&v.global_gain==y.global_gain,v.block_type==O.SHORT_TYPE?j=38:j=21,w=0;w<=j;w++){var Ve=-1;if((P||v.block_type==O.NORM_TYPE)&&(Ve=v.global_gain-(v.scalefac[w]+(v.preflag!=0?e.pretab[w]:0)<<v.scalefac_scale+1)-v.subblock_gain[v.window[w]]*8),fo(v.width[w]>=0),P&&y.step[w]==Ve)z!=0&&(n(z,_,Re,ge,_e,Ae),z=0),d!=0&&(s(d,_,Re,ge,_e,Ae),d=0);else{var Ne=v.width[w];if(K+v.width[w]>v.max_nonzero_coeff){var he;he=v.max_nonzero_coeff-K+1,Fp.fill(g,v.max_nonzero_coeff,576,0),Ne=he,Ne<0&&(Ne=0),w=j+1}if(z==0&&d==0&&(_e=W,Ae=$,Re=h,ge=M),y!=null&&y.sfb_count1>0&&w>=y.sfb_count1&&y.step[w]>0&&Ve>=y.step[w]?(z!=0&&(n(z,_,Re,ge,_e,Ae),z=0,_e=W,Ae=$,Re=h,ge=M),d+=Ne):(d!=0&&(s(d,_,Re,ge,_e,Ae),d=0,_e=W,Ae=$,Re=h,ge=M),z+=Ne),Ne<=0){d!=0&&(s(d,_,Re,ge,_e,Ae),d=0),z!=0&&(n(z,_,Re,ge,_e,Ae),z=0);break}}w<=j&&($+=v.width[w],M+=v.width[w],K+=v.width[w])}z!=0&&(n(z,_,Re,ge,_e,Ae),z=0),d!=0&&(s(d,_,Re,ge,_e,Ae),d=0)}function o(h,g,_){var v=0,y=0;do{var w=h[g++],j=h[g++];v<w&&(v=w),y<j&&(y=j)}while(g<_);return v<y&&(v=y),v}function u(h,g,_,v,y,w){var j=oe.ht[v].xlen*65536+oe.ht[y].xlen,K=0,P;do{var z=h[g++],d=h[g++];z!=0&&(z>14&&(z=15,K+=j),z*=16),d!=0&&(d>14&&(d=15,K+=j),z+=d),K+=oe.largetbl[z]}while(g<_);return P=K&65535,K>>=16,K>P&&(K=P,v=y),w.bits+=K,v}function b(h,g,_,v){var y=0,w=oe.ht[1].hlen;do{var j=h[g+0]*2+h[g+1];g+=2,y+=w[j]}while(g<_);return v.bits+=y,1}function l(h,g,_,v,y){var w=0,j,K=oe.ht[v].xlen,P;v==2?P=oe.table23:P=oe.table56;do{var z=h[g+0]*K+h[g+1];g+=2,w+=P[z]}while(g<_);return j=w&65535,w>>=16,w>j&&(w=j,v++),y.bits+=w,v}function p(h,g,_,v,y){var w=0,j=0,K=0,P=oe.ht[v].xlen,z=oe.ht[v].hlen,d=oe.ht[v+1].hlen,M=oe.ht[v+2].hlen;do{var W=h[g+0]*P+h[g+1];g+=2,w+=z[W],j+=d[W],K+=M[W]}while(g<_);var $=v;return w>j&&(w=j,$++),w>K&&(w=K,$=v+2),y.bits+=w,$}var c=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function E(h,g,_,v){var y=o(h,g,_);switch(y){case 0:return y;case 1:return b(h,g,_,v);case 2:case 3:return l(h,g,_,c[y-1],v);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return p(h,g,_,c[y-1],v);default:if(y>Gt.IXMAX_VAL)return v.bits=Gt.LARGE_BITS,-1;y-=15;var w;for(w=24;w<32&&!(oe.ht[w].linmax>=y);w++);var j;for(j=w-8;j<24&&!(oe.ht[j].linmax>=y);j++);return u(h,g,_,j,w,v)}}this.noquant_count_bits=function(h,g,_){var v=g.l3_enc,y=Math.min(576,g.max_nonzero_coeff+2>>1<<1);for(_!=null&&(_.sfb_count1=0);y>1&&!(v[y-1]|v[y-2]);y-=2);g.count1=y;for(var w=0,j=0;y>3;y-=4){var K;if(((v[y-1]|v[y-2]|v[y-3]|v[y-4])&2147483647)>1)break;K=((v[y-4]*2+v[y-3])*2+v[y-2])*2+v[y-1],w+=oe.t32l[K],j+=oe.t33l[K]}var P=w;if(g.count1table_select=0,w>j&&(P=j,g.count1table_select=1),g.count1bits=P,g.big_values=y,y==0)return P;if(g.block_type==O.SHORT_TYPE)w=3*h.scalefac_band.s[3],w>g.big_values&&(w=g.big_values),j=g.big_values;else if(g.block_type==O.NORM_TYPE){if(w=g.region0_count=h.bv_scf[y-2],j=g.region1_count=h.bv_scf[y-1],j=h.scalefac_band.l[w+j+2],w=h.scalefac_band.l[w+1],j<y){var z=new t(P);g.table_select[2]=E(v,j,y,z),P=z.bits}}else g.region0_count=7,g.region1_count=O.SBMAX_l-1-7-1,w=h.scalefac_band.l[7+1],j=y,w>j&&(w=j);if(w=Math.min(w,y),j=Math.min(j,y),w>0){var z=new t(P);g.table_select[0]=E(v,0,w,z),P=z.bits}if(w<j){var z=new t(P);g.table_select[1]=E(v,w,j,z),P=z.bits}if(h.use_best_huffman==2&&(g.part2_3_length=P,best_huffman_divide(h,g),P=g.part2_3_length),_!=null&&g.block_type==O.NORM_TYPE){for(var d=0;h.scalefac_band.l[d]<g.big_values;)d++;_.sfb_count1=d}return P},this.count_bits=function(h,g,_,v){var y=_.l3_enc,w=Gt.IXMAX_VAL/e.IPOW20(_.global_gain);if(_.xrpow_max>w)return Gt.LARGE_BITS;if(r(g,y,e.IPOW20(_.global_gain),_,v),h.substep_shaping&2)for(var j=0,K=_.global_gain+_.scalefac_scale,P=.634521682242439/e.IPOW20(K),z=0;z<_.sfbmax;z++){var d=_.width[z];if(h.pseudohalf[z]==0)j+=d;else{var M;for(M=j,j+=d;M<j;++M)y[M]=g[M]>=P?y[M]:0}}return this.noquant_count_bits(h,_,v)};function A(h,g,_,v,y,w,j){for(var K=g.big_values,P=0;P<=7+15;P++)v[P]=Gt.LARGE_BITS;for(var P=0;P<16;P++){var z=h.scalefac_band.l[P+1];if(z>=K)break;var d=0,M=new t(d),W=E(_,0,z,M);d=M.bits;for(var $=0;$<8;$++){var _e=h.scalefac_band.l[P+$+2];if(_e>=K)break;var Ae=d;M=new t(Ae);var Re=E(_,z,_e,M);Ae=M.bits,v[P+$]>Ae&&(v[P+$]=Ae,y[P+$]=P,w[P+$]=W,j[P+$]=Re)}}}function i(h,g,_,v,y,w,j,K){for(var P=g.big_values,z=2;z<O.SBMAX_l+1;z++){var d=h.scalefac_band.l[z];if(d>=P)break;var M=y[z-2]+g.count1bits;if(_.part2_3_length<=M)break;var W=new t(M),$=E(v,d,P,W);M=W.bits,!(_.part2_3_length<=M)&&(_.assign(g),_.part2_3_length=M,_.region0_count=w[z-2],_.region1_count=z-2-w[z-2],_.table_select[0]=j[z-2],_.table_select[1]=K[z-2],_.table_select[2]=$)}}this.best_huffman_divide=function(h,g){var _=new ci,v=g.l3_enc,y=Br(7+15+1),w=Br(7+15+1),j=Br(7+15+1),K=Br(7+15+1);if(!(g.block_type==O.SHORT_TYPE&&h.mode_gr==1)){_.assign(g),g.block_type==O.NORM_TYPE&&(A(h,g,v,y,w,j,K),i(h,_,g,v,y,w,j,K));var P=_.big_values;if(!(P==0||(v[P-2]|v[P-1])>1)&&(P=g.count1+2,!(P>576))){_.assign(g),_.count1=P;for(var z=0,d=0;P>_.big_values;P-=4){var M=((v[P-4]*2+v[P-3])*2+v[P-2])*2+v[P-1];z+=oe.t32l[M],d+=oe.t33l[M]}if(_.big_values=P,_.count1table_select=0,z>d&&(z=d,_.count1table_select=1),_.count1bits=z,_.block_type==O.NORM_TYPE)i(h,_,g,v,y,w,j,K);else{if(_.part2_3_length=z,z=h.scalefac_band.l[7+1],z>P&&(z=P),z>0){var W=new t(_.part2_3_length);_.table_select[0]=E(v,0,z,W),_.part2_3_length=W.bits}if(P>z){var W=new t(_.part2_3_length);_.table_select[1]=E(v,z,P,W),_.part2_3_length=W.bits}g.part2_3_length>_.part2_3_length&&g.assign(_)}}}};var F=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],L=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],B=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],f=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];un.slen1_tab=B,un.slen2_tab=f;function R(h,g){for(var _,v=g.tt[1][h],y=g.tt[0][h],w=0;w<oe.scfsi_band.length-1;w++){for(_=oe.scfsi_band[w];_<oe.scfsi_band[w+1]&&!(y.scalefac[_]!=v.scalefac[_]&&v.scalefac[_]>=0);_++);if(_==oe.scfsi_band[w+1]){for(_=oe.scfsi_band[w];_<oe.scfsi_band[w+1];_++)v.scalefac[_]=-1;g.scfsi[h][w]=1}}var j=0,K=0;for(_=0;_<11;_++)v.scalefac[_]!=-1&&(K++,j<v.scalefac[_]&&(j=v.scalefac[_]));for(var P=0,z=0;_<O.SBPSY_l;_++)v.scalefac[_]!=-1&&(z++,P<v.scalefac[_]&&(P=v.scalefac[_]));for(var w=0;w<16;w++)if(j<F[w]&&P<L[w]){var d=B[w]*K+f[w]*z;v.part2_length>d&&(v.part2_length=d,v.scalefac_compress=w)}}this.best_scalefac_store=function(h,g,_,v){var y=v.tt[g][_],w,j,K,P,z=0;for(K=0,w=0;w<y.sfbmax;w++){var d=y.width[w];for(K+=d,P=-d;P<0&&y.l3_enc[P+K]==0;P++);P==0&&(y.scalefac[w]=z=-2)}if(y.scalefac_scale==0&&y.preflag==0){var M=0;for(w=0;w<y.sfbmax;w++)y.scalefac[w]>0&&(M|=y.scalefac[w]);if(!(M&1)&&M!=0){for(w=0;w<y.sfbmax;w++)y.scalefac[w]>0&&(y.scalefac[w]>>=1);y.scalefac_scale=z=1}}if(y.preflag==0&&y.block_type!=O.SHORT_TYPE&&h.mode_gr==2){for(w=11;w<O.SBPSY_l&&!(y.scalefac[w]<e.pretab[w]&&y.scalefac[w]!=-2);w++);if(w==O.SBPSY_l){for(w=11;w<O.SBPSY_l;w++)y.scalefac[w]>0&&(y.scalefac[w]-=e.pretab[w]);y.preflag=z=1}}for(j=0;j<4;j++)v.scfsi[_][j]=0;for(h.mode_gr==2&&g==1&&v.tt[0][_].block_type!=O.SHORT_TYPE&&v.tt[1][_].block_type!=O.SHORT_TYPE&&(R(_,v),z=0),w=0;w<y.sfbmax;w++)y.scalefac[w]==-2&&(y.scalefac[w]=0);z!=0&&(h.mode_gr==2?this.scale_bitcount(y):this.scale_bitcount_lsf(h,y))};function C(h,g){for(var _=0;_<g;++_)if(h[_]<0)return!1;return!0}var T=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],N=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],m=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(h){var g,_,v=0,y=0,w,j=h.scalefac;if(fo(C(j,h.sfbmax)),h.block_type==O.SHORT_TYPE)w=T,h.mixed_block_flag!=0&&(w=N);else if(w=m,h.preflag==0){for(_=11;_<O.SBPSY_l&&!(j[_]<e.pretab[_]);_++);if(_==O.SBPSY_l)for(h.preflag=1,_=11;_<O.SBPSY_l;_++)j[_]-=e.pretab[_]}for(_=0;_<h.sfbdivide;_++)v<j[_]&&(v=j[_]);for(;_<h.sfbmax;_++)y<j[_]&&(y=j[_]);for(h.part2_length=Gt.LARGE_BITS,g=0;g<16;g++)v<F[g]&&y<L[g]&&h.part2_length>w[g]&&(h.part2_length=w[g],h.scalefac_compress=g);return h.part2_length==Gt.LARGE_BITS};var k=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(h,g){var _,v,y,w,j,K,P,z,d=Br(4),M=g.scalefac;for(g.preflag!=0?_=2:_=0,P=0;P<4;P++)d[P]=0;if(g.block_type==O.SHORT_TYPE){v=1;var W=e.nr_of_sfb_block[_][v];for(z=0,y=0;y<4;y++)for(w=W[y]/3,P=0;P<w;P++,z++)for(j=0;j<3;j++)M[z*3+j]>d[y]&&(d[y]=M[z*3+j])}else{v=0;var W=e.nr_of_sfb_block[_][v];for(z=0,y=0;y<4;y++)for(w=W[y],P=0;P<w;P++,z++)M[z]>d[y]&&(d[y]=M[z])}for(K=!1,y=0;y<4;y++)d[y]>k[_][y]&&(K=!0);if(!K){var $,_e,Ae,Re;for(g.sfb_partition_table=e.nr_of_sfb_block[_][v],y=0;y<4;y++)g.slen[y]=S[d[y]];switch($=g.slen[0],_e=g.slen[1],Ae=g.slen[2],Re=g.slen[3],_){case 0:g.scalefac_compress=($*5+_e<<4)+(Ae<<2)+Re;break;case 1:g.scalefac_compress=400+($*5+_e<<2)+Ae;break;case 2:g.scalefac_compress=500+$*3+_e;break;default:jp.err.printf(`intensity stereo not implemented yet
`);break}}if(!K)for(fo(g.sfb_partition_table!=null),g.part2_length=0,y=0;y<4;y++)g.part2_length+=g.slen[y]*g.sfb_partition_table[y];return K};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(h){for(var g=2;g<=576;g+=2){for(var _=0,v;h.scalefac_band.l[++_]<g;);for(v=a[_][0];h.scalefac_band.l[v+1]>g;)v--;for(v<0&&(v=a[_][0]),h.bv_scf[g-2]=v,v=a[_][1];h.scalefac_band.l[v+h.bv_scf[g-2]+2]>g;)v--;v<0&&(v=a[_][1]),h.bv_scf[g-1]=v}}}var Ha=Ie.System,Hp=Ie.Arrays,Pp=Ie.new_byte,Up=Ie.new_float_n,Dp=Ie.new_int,Ut=Ie.assert;Ea.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=Math.abs(e)*1e-6:Math.abs(e-t)<=Math.abs(t)*1e-6};Ea.NEQ=function(e,t){return!Ea.EQ(e,t)};function Ea(){var e=this,t=32773,a=null,s=null,n=null,r=null;this.setModules=function(k,S,h,g){a=k,s=S,n=h,r=g};var o=null,u=0,b=0,l=0;this.getframebits=function(k){var S=k.internal_flags,h;S.bitrate_index!=0?h=oe.bitrate_table[k.version][S.bitrate_index]:h=k.brate;var g=0|(k.version+1)*72e3*h/k.out_samplerate+S.padding;return 8*g};function p(k){Ha.arraycopy(k.header[k.w_ptr].buf,0,o,b,k.sideinfo_len),b+=k.sideinfo_len,u+=k.sideinfo_len*8,k.w_ptr=k.w_ptr+1&mt.MAX_HEADER_BUF-1}function c(k,S,h){for(;h>0;){var g;l==0&&(l=8,b++,Ut(k.header[k.w_ptr].write_timing>=u),k.header[k.w_ptr].write_timing==u&&p(k),o[b]=0),g=Math.min(h,l),h-=g,l-=g,o[b]|=S>>h<<l,u+=g}}function E(k,S,h){for(;h>0;){var g;l==0&&(l=8,b++,o[b]=0),g=Math.min(h,l),h-=g,l-=g,o[b]|=S>>h<<l,u+=g}}function A(k,S){var h=k.internal_flags,g;if(S>=8&&(c(h,76,8),S-=8),S>=8&&(c(h,65,8),S-=8),S>=8&&(c(h,77,8),S-=8),S>=8&&(c(h,69,8),S-=8),S>=32){var _=n.getLameShortVersion();if(S>=32)for(g=0;g<_.length&&S>=8;++g)S-=8,c(h,_.charAt(g),8)}for(;S>=1;S-=1)c(h,h.ancillary_flag,1),h.ancillary_flag^=k.disable_reservoir?0:1}function i(k,S,h){for(var g=k.header[k.h_ptr].ptr;h>0;){var _=Math.min(h,8-(g&7));h-=_,k.header[k.h_ptr].buf[g>>3]|=S>>h<<8-(g&7)-_,g+=_}k.header[k.h_ptr].ptr=g}function F(k,S){k<<=8;for(var h=0;h<8;h++)k<<=1,S<<=1,(S^k)&65536&&(S^=t);return S}this.CRC_writeheader=function(k,S){var h=65535;h=F(S[2]&255,h),h=F(S[3]&255,h);for(var g=6;g<k.sideinfo_len;g++)h=F(S[g]&255,h);S[4]=byte(h>>8),S[5]=byte(h&255)};function L(k,S){var h=k.internal_flags,g,_,v;if(g=h.l3_side,h.header[h.h_ptr].ptr=0,Hp.fill(h.header[h.h_ptr].buf,0,h.sideinfo_len,0),k.out_samplerate<16e3?i(h,4094,12):i(h,4095,12),i(h,k.version,1),i(h,4-3,2),i(h,k.error_protection?0:1,1),i(h,h.bitrate_index,4),i(h,h.samplerate_index,2),i(h,h.padding,1),i(h,k.extension,1),i(h,k.mode.ordinal(),2),i(h,h.mode_ext,2),i(h,k.copyright,1),i(h,k.original,1),i(h,k.emphasis,2),k.error_protection&&i(h,0,16),k.version==1){for(Ut(g.main_data_begin>=0),i(h,g.main_data_begin,9),h.channels_out==2?i(h,g.private_bits,3):i(h,g.private_bits,5),v=0;v<h.channels_out;v++){var y;for(y=0;y<4;y++)i(h,g.scfsi[v][y],1)}for(_=0;_<2;_++)for(v=0;v<h.channels_out;v++){var w=g.tt[_][v];i(h,w.part2_3_length+w.part2_length,12),i(h,w.big_values/2,9),i(h,w.global_gain,8),i(h,w.scalefac_compress,4),w.block_type!=O.NORM_TYPE?(i(h,1,1),i(h,w.block_type,2),i(h,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),i(h,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(h,w.table_select[1],5),i(h,w.subblock_gain[0],3),i(h,w.subblock_gain[1],3),i(h,w.subblock_gain[2],3)):(i(h,0,1),w.table_select[0]==14&&(w.table_select[0]=16),i(h,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(h,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),i(h,w.table_select[2],5),Ut(w.region0_count>=0&&w.region0_count<16),Ut(w.region1_count>=0&&w.region1_count<8),i(h,w.region0_count,4),i(h,w.region1_count,3)),i(h,w.preflag,1),i(h,w.scalefac_scale,1),i(h,w.count1table_select,1)}}else for(Ut(g.main_data_begin>=0),i(h,g.main_data_begin,8),i(h,g.private_bits,h.channels_out),_=0,v=0;v<h.channels_out;v++){var w=g.tt[_][v];i(h,w.part2_3_length+w.part2_length,12),i(h,w.big_values/2,9),i(h,w.global_gain,8),i(h,w.scalefac_compress,9),w.block_type!=O.NORM_TYPE?(i(h,1,1),i(h,w.block_type,2),i(h,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),i(h,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(h,w.table_select[1],5),i(h,w.subblock_gain[0],3),i(h,w.subblock_gain[1],3),i(h,w.subblock_gain[2],3)):(i(h,0,1),w.table_select[0]==14&&(w.table_select[0]=16),i(h,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(h,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),i(h,w.table_select[2],5),Ut(w.region0_count>=0&&w.region0_count<16),Ut(w.region1_count>=0&&w.region1_count<8),i(h,w.region0_count,4),i(h,w.region1_count,3)),i(h,w.scalefac_scale,1),i(h,w.count1table_select,1)}k.error_protection&&CRC_writeheader(h,h.header[h.h_ptr].buf);{var j=h.h_ptr;Ut(h.header[j].ptr==h.sideinfo_len*8),h.h_ptr=j+1&mt.MAX_HEADER_BUF-1,h.header[h.h_ptr].write_timing=h.header[j].write_timing+S,h.h_ptr==h.w_ptr&&Ha.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function B(k,S){var h=oe.ht[S.count1table_select+32],g,_=0,v=S.big_values,y=S.big_values;for(Ut(S.count1table_select<2),g=(S.count1-S.big_values)/4;g>0;--g){var w=0,j=0,K;K=S.l3_enc[v+0],K!=0&&(j+=8,S.xr[y+0]<0&&w++),K=S.l3_enc[v+1],K!=0&&(j+=4,w*=2,S.xr[y+1]<0&&w++),K=S.l3_enc[v+2],K!=0&&(j+=2,w*=2,S.xr[y+2]<0&&w++),K=S.l3_enc[v+3],K!=0&&(j++,w*=2,S.xr[y+3]<0&&w++),v+=4,y+=4,c(k,w+h.table[j],h.hlen[j]),_+=h.hlen[j]}return _}function f(k,S,h,g,_){var v=oe.ht[S],y=0;if(S==0)return y;for(var w=h;w<g;w+=2){var j=0,K=0,P=v.xlen,z=v.xlen,d=0,M=_.l3_enc[w],W=_.l3_enc[w+1];if(M!=0&&(_.xr[w]<0&&d++,j--),S>15){if(M>14){var $=M-15;Ut($<=v.linmax),d|=$<<1,K=P,M=15}if(W>14){var _e=W-15;Ut(_e<=v.linmax),d<<=P,d|=_e,K+=P,W=15}z=16}W!=0&&(d<<=1,_.xr[w+1]<0&&d++,j--),M=M*z+W,K-=j,j+=v.hlen[M],c(k,v.table[M],j),c(k,d,K),y+=j+K}return y}function R(k,S){var h=3*k.scalefac_band.s[3];h>S.big_values&&(h=S.big_values);var g=f(k,S.table_select[0],0,h,S);return g+=f(k,S.table_select[1],h,S.big_values,S),g}function C(k,S){var h,g,_,v;h=S.big_values;var y=S.region0_count+1;return Ut(y<k.scalefac_band.l.length),_=k.scalefac_band.l[y],y+=S.region1_count+1,Ut(y<k.scalefac_band.l.length),v=k.scalefac_band.l[y],_>h&&(_=h),v>h&&(v=h),g=f(k,S.table_select[0],0,_,S),g+=f(k,S.table_select[1],_,v,S),g+=f(k,S.table_select[2],v,h,S),g}function T(k){var S,h,g,_,v=0,y=k.internal_flags,w=y.l3_side;if(k.version==1)for(S=0;S<2;S++)for(h=0;h<y.channels_out;h++){var j=w.tt[S][h],K=un.slen1_tab[j.scalefac_compress],P=un.slen2_tab[j.scalefac_compress];for(_=0,g=0;g<j.sfbdivide;g++)j.scalefac[g]!=-1&&(c(y,j.scalefac[g],K),_+=K);for(;g<j.sfbmax;g++)j.scalefac[g]!=-1&&(c(y,j.scalefac[g],P),_+=P);Ut(_==j.part2_length),j.block_type==O.SHORT_TYPE?_+=R(y,j):_+=C(y,j),_+=B(y,j),Ut(_==j.part2_3_length+j.part2_length),v+=_}else for(S=0,h=0;h<y.channels_out;h++){var j=w.tt[S][h],z,d,M=0;if(Ut(j.sfb_partition_table!=null),_=0,g=0,d=0,j.block_type==O.SHORT_TYPE){for(;d<4;d++){var W=j.sfb_partition_table[d]/3,$=j.slen[d];for(z=0;z<W;z++,g++)c(y,Math.max(j.scalefac[g*3+0],0),$),c(y,Math.max(j.scalefac[g*3+1],0),$),c(y,Math.max(j.scalefac[g*3+2],0),$),M+=3*$}_+=R(y,j)}else{for(;d<4;d++){var W=j.sfb_partition_table[d],$=j.slen[d];for(z=0;z<W;z++,g++)c(y,Math.max(j.scalefac[g],0),$),M+=$}_+=C(y,j)}_+=B(y,j),Ut(_==j.part2_3_length),Ut(M==j.part2_length),v+=M+_}return v}function N(){this.total=0}function m(k,S){var h=k.internal_flags,g,_,v,y,w;return w=h.w_ptr,y=h.h_ptr-1,y==-1&&(y=mt.MAX_HEADER_BUF-1),g=h.header[y].write_timing-u,S.total=g,g>=0&&(_=1+y-w,y<w&&(_=1+y-w+mt.MAX_HEADER_BUF),g-=_*8*h.sideinfo_len),v=e.getframebits(k),g+=v,S.total+=v,S.total%8!=0?S.total=1+S.total/8:S.total=S.total/8,S.total+=b+1,g<0&&Ha.err.println(`strange error flushing buffer ... 
`),g}this.flush_bitstream=function(k){var S=k.internal_flags,h,g,_=S.h_ptr-1;if(_==-1&&(_=mt.MAX_HEADER_BUF-1),h=S.l3_side,!((g=m(k,new N))<0)){if(A(k,g),Ut(S.header[_].write_timing+this.getframebits(k)==u),S.ResvSize=0,h.main_data_begin=0,S.findReplayGain){var v=a.GetTitleGain(S.rgdata);Ut(NEQ(v,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),S.RadioGain=Math.floor(v*10+.5)|0}S.findPeakSample&&(S.noclipGainChange=Math.ceil(Math.log10(S.PeakSample/32767)*20*10)|0,S.noclipGainChange>0&&(EQ(k.scale,1)||EQ(k.scale,0))?S.noclipScale=Math.floor(32767/S.PeakSample*100)/100:S.noclipScale=-1)}},this.add_dummy_byte=function(k,S,h){for(var g=k.internal_flags,_;h-- >0;)for(E(g,S,8),_=0;_<mt.MAX_HEADER_BUF;++_)g.header[_].write_timing+=8},this.format_bitstream=function(k){var S=k.internal_flags,h;h=S.l3_side;var g=this.getframebits(k);A(k,h.resvDrain_pre),L(k,g);var _=8*S.sideinfo_len;if(_+=T(k),A(k,h.resvDrain_post),_+=h.resvDrain_post,h.main_data_begin+=(g-_)/8,m(k,new N)!=S.ResvSize&&Ha.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),h.main_data_begin*8!=S.ResvSize&&(Ha.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*h.main_data_begin,S.ResvSize,h.resvDrain_post,h.resvDrain_pre,8*S.sideinfo_len,_-h.resvDrain_post-8*S.sideinfo_len,_,_%8,g),Ha.err.println("This is a fatal error.  It has several possible causes:"),Ha.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Ha.err.println(" 9%%  Your system is overclocked"),Ha.err.println(" 1%%  bug in LAME encoding library"),S.ResvSize=h.main_data_begin*8),u>1e9){var v;for(v=0;v<mt.MAX_HEADER_BUF;++v)S.header[v].write_timing-=u;u=0}return 0},this.copy_buffer=function(k,S,h,g,_){var v=b+1;if(v<=0)return 0;if(g!=0&&v>g)return-1;if(Ha.arraycopy(o,0,S,h,v),b=-1,l=0,_!=0){var y=Dp(1);if(y[0]=k.nMusicCRC,r.updateMusicCRC(y,S,h,v),k.nMusicCRC=y[0],v>0&&(k.VBR_seek_table.nBytesWritten+=v),k.decode_on_the_fly){for(var w=Up([2,1152]),j=v,K=-1,P;K!=0;)if(K=s.hip_decode1_unclipped(k.hip,S,h,j,w[0],w[1]),j=0,K==-1&&(K=0),K>0){if(k.findPeakSample){for(P=0;P<K;P++)w[0][P]>k.PeakSample?k.PeakSample=w[0][P]:-w[0][P]>k.PeakSample&&(k.PeakSample=-w[0][P]);if(k.channels_out>1)for(P=0;P<K;P++)w[1][P]>k.PeakSample?k.PeakSample=w[1][P]:-w[1][P]>k.PeakSample&&(k.PeakSample=-w[1][P])}if(k.findReplayGain&&a.AnalyzeSamples(k.rgdata,w[0],0,w[1],0,K,k.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return v},this.init_bit_stream_w=function(k){o=Pp(Qe.LAME_MAXMP3BUFFER),k.h_ptr=k.w_ptr=0,k.header[k.h_ptr].write_timing=0,b=-1,l=0,u=0}}var Vp=Ie.System,Et=Ie.VbrMode,ho=Ie.ShortBlock,js=Ie.new_float,i1=Ie.new_int_n,qp=Ie.new_short_n,us=Ie.assert;function Qe(){var e=this,t=128*1024;Qe.V9=410,Qe.V8=420,Qe.V7=430,Qe.V6=440,Qe.V5=450,Qe.V4=460,Qe.V3=470,Qe.V2=480,Qe.V1=490,Qe.V0=500,Qe.R3MIX=1e3,Qe.STANDARD=1001,Qe.EXTREME=1002,Qe.INSANE=1003,Qe.STANDARD_FAST=1004,Qe.EXTREME_FAST=1005,Qe.MEDIUM=1006,Qe.MEDIUM_FAST=1007;var a=16384+t;Qe.LAME_MAXMP3BUFFER=a;var s,n,r,o,u,b=new co,l,p,c;this.enc=new O,this.setModules=function(d,M,W,$,_e,Ae,Re,ge,Ve){s=d,n=M,r=W,o=$,u=_e,l=Ae,p=ge,c=Ve,this.enc.setModules(n,b,o,l)};function E(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=js(O.SBMAX_l),this.bo_s_weight=js(O.SBMAX_s)}function A(){this.lowerlimit=0}function i(d,M){this.lowpass=M}var F=4294479419;function L(d){var M;return d.class_id=F,M=d.internal_flags=new mt,d.mode=vt.NOT_SET,d.original=1,d.in_samplerate=44100,d.num_channels=2,d.num_samples=-1,d.bWriteVbrTag=!0,d.quality=-1,d.short_blocks=null,M.subblock_gain=-1,d.lowpassfreq=0,d.highpassfreq=0,d.lowpasswidth=-1,d.highpasswidth=-1,d.VBR=Et.vbr_off,d.VBR_q=4,d.ATHcurve=-1,d.VBR_mean_bitrate_kbps=128,d.VBR_min_bitrate_kbps=0,d.VBR_max_bitrate_kbps=0,d.VBR_hard_min=0,M.VBR_min_bitrate=1,M.VBR_max_bitrate=13,d.quant_comp=-1,d.quant_comp_short=-1,d.msfix=-1,M.resample_ratio=1,M.OldValue[0]=180,M.OldValue[1]=180,M.CurrentStep[0]=4,M.CurrentStep[1]=4,M.masking_lower=1,M.nsPsy.attackthre=-1,M.nsPsy.attackthre_s=-1,d.scale=-1,d.athaa_type=-1,d.ATHtype=-1,d.athaa_loudapprox=-1,d.athaa_sensitivity=0,d.useTemporal=null,d.interChRatio=-1,M.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY,d.encoder_padding=0,M.mf_size=O.ENCDELAY-O.MDCTDELAY,d.findReplayGain=!1,d.decode_on_the_fly=!1,M.decode_on_the_fly=!1,M.findReplayGain=!1,M.findPeakSample=!1,M.RadioGain=0,M.AudiophileGain=0,M.noclipGainChange=0,M.noclipScale=-1,d.preset=0,d.write_id3tag_automatic=!0,0}this.lame_init=function(){var d=new Sp;return L(d),d.lame_allocated_gfp=1,d};function B(d){return d>1?0:d<=0?1:Math.cos(Math.PI/2*d)}this.nearestBitrateFullIndex=function(d){var M=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],W=0,$=0,_e=0,Ae=0;Ae=M[16],_e=16,$=M[16],W=16;for(var Re=0;Re<16;Re++)if(Math.max(d,M[Re+1])!=d){Ae=M[Re+1],_e=Re+1,$=M[Re],W=Re;break}return Ae-d>d-$?W:_e};function f(d,M){var W=44100;return M>=48e3?W=48e3:M>=44100?W=44100:M>=32e3?W=32e3:M>=24e3?W=24e3:M>=22050?W=22050:M>=16e3?W=16e3:M>=12e3?W=12e3:M>=11025?W=11025:M>=8e3&&(W=8e3),d==-1?W:(d<=15960&&(W=44100),d<=15250&&(W=32e3),d<=11220&&(W=24e3),d<=9970&&(W=22050),d<=7230&&(W=16e3),d<=5420&&(W=12e3),d<=4510&&(W=11025),d<=3970&&(W=8e3),M<W?M>44100?48e3:M>32e3?44100:M>24e3?32e3:M>22050?24e3:M>16e3?22050:M>12e3?16e3:M>11025?12e3:M>8e3?11025:8e3:W)}function R(d,M){switch(d){case 44100:return M.version=1,0;case 48e3:return M.version=1,1;case 32e3:return M.version=1,2;case 22050:return M.version=0,0;case 24e3:return M.version=0,1;case 16e3:return M.version=0,2;case 11025:return M.version=0,0;case 12e3:return M.version=0,1;case 8e3:return M.version=0,2;default:return M.version=0,-1}}function C(d,M,W){W<16e3&&(M=2);for(var $=oe.bitrate_table[M][1],_e=2;_e<=14;_e++)oe.bitrate_table[M][_e]>0&&Math.abs(oe.bitrate_table[M][_e]-d)<Math.abs($-d)&&($=oe.bitrate_table[M][_e]);return $}function T(d,M,W){W<16e3&&(M=2);for(var $=0;$<=14;$++)if(oe.bitrate_table[M][$]>0&&oe.bitrate_table[M][$]==d)return $;return-1}function N(d,M){var W=[new i(8,2e3),new i(16,3700),new i(24,3900),new i(32,5500),new i(40,7e3),new i(48,7500),new i(56,1e4),new i(64,11e3),new i(80,13500),new i(96,15100),new i(112,15600),new i(128,17e3),new i(160,17500),new i(192,18600),new i(224,19400),new i(256,19700),new i(320,20500)],$=e.nearestBitrateFullIndex(M);d.lowerlimit=W[$].lowpass}function m(d){var M=d.internal_flags,W=32,$=-1;if(M.lowpass1>0){for(var _e=999,Ae=0;Ae<=31;Ae++){var Re=Ae/31;Re>=M.lowpass2&&(W=Math.min(W,Ae)),M.lowpass1<Re&&Re<M.lowpass2&&(_e=Math.min(_e,Ae))}_e==999?M.lowpass1=(W-.75)/31:M.lowpass1=(_e-.75)/31,M.lowpass2=W/31}if(M.highpass2>0&&M.highpass2<.9*(.75/31)&&(M.highpass1=0,M.highpass2=0,Vp.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),M.highpass2>0){for(var ge=-1,Ae=0;Ae<=31;Ae++){var Re=Ae/31;Re<=M.highpass1&&($=Math.max($,Ae)),M.highpass1<Re&&Re<M.highpass2&&(ge=Math.max(ge,Ae))}M.highpass1=$/31,ge==-1?M.highpass2=($+.75)/31:M.highpass2=(ge+.75)/31}for(var Ae=0;Ae<32;Ae++){var Ve,Ne,Re=Ae/31;M.highpass2>M.highpass1?Ve=B((M.highpass2-Re)/(M.highpass2-M.highpass1+1e-20)):Ve=1,M.lowpass2>M.lowpass1?Ne=B((Re-M.lowpass1)/(M.lowpass2-M.lowpass1+1e-20)):Ne=1,M.amp_filter[Ae]=Ve*Ne}}function k(d){var M=d.internal_flags;switch(d.quality){default:case 9:M.psymodel=0,M.noise_shaping=0,M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.use_best_huffman=0,M.full_outer_loop=0;break;case 8:d.quality=7;case 7:M.psymodel=1,M.noise_shaping=0,M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.use_best_huffman=0,M.full_outer_loop=0;break;case 6:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=0,M.full_outer_loop=0;break;case 5:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=0,M.full_outer_loop=0;break;case 4:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 3:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=1,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 2:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=1,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 1:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=2,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 0:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=2,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break}}function S(d){var M=d.internal_flags;d.frameNum=0,d.write_id3tag_automatic&&p.id3tag_write_v2(d),M.bitrate_stereoMode_Hist=i1([16,4+1]),M.bitrate_blockType_Hist=i1([16,4+1+1]),M.PeakSample=0,d.bWriteVbrTag&&l.InitVbrTag(d)}this.lame_init_params=function(d){var M=d.internal_flags;if(M.Class_ID=0,M.ATH==null&&(M.ATH=new Ip),M.PSY==null&&(M.PSY=new E),M.rgdata==null&&(M.rgdata=new Cp),M.channels_in=d.num_channels,M.channels_in==1&&(d.mode=vt.MONO),M.channels_out=d.mode==vt.MONO?1:2,M.mode_ext=O.MPG_MD_MS_LR,d.mode==vt.MONO&&(d.force_ms=!1),d.VBR==Et.vbr_off&&d.VBR_mean_bitrate_kbps!=128&&d.brate==0&&(d.brate=d.VBR_mean_bitrate_kbps),d.VBR==Et.vbr_off||d.VBR==Et.vbr_mtrh||d.VBR==Et.vbr_mt||(d.free_format=!1),d.VBR==Et.vbr_off&&d.brate==0&&Ea.EQ(d.compression_ratio,0)&&(d.compression_ratio=11.025),d.VBR==Et.vbr_off&&d.compression_ratio>0&&(d.out_samplerate==0&&(d.out_samplerate=map2MP3Frequency(int(.97*d.in_samplerate))),d.brate=0|d.out_samplerate*16*M.channels_out/(1e3*d.compression_ratio),M.samplerate_index=R(d.out_samplerate,d),d.free_format||(d.brate=C(d.brate,d.version,d.out_samplerate))),d.out_samplerate!=0&&(d.out_samplerate<16e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,64)):d.out_samplerate<32e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,160)):(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,32),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,320))),d.lowpassfreq==0){var W=16e3;switch(d.VBR){case Et.vbr_off:{var $=new A;N($,d.brate),W=$.lowerlimit;break}case Et.vbr_abr:{var $=new A;N($,d.VBR_mean_bitrate_kbps),W=$.lowerlimit;break}case Et.vbr_rh:{var _e=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Ae=_e[d.VBR_q],Re=_e[d.VBR_q+1],ge=d.VBR_q_frac;W=linear_int(Ae,Re,ge)}else W=19500;break}default:{var _e=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Ae=_e[d.VBR_q],Re=_e[d.VBR_q+1],ge=d.VBR_q_frac;W=linear_int(Ae,Re,ge)}else W=19500}}d.mode==vt.MONO&&(d.VBR==Et.vbr_off||d.VBR==Et.vbr_abr)&&(W*=1.5),d.lowpassfreq=W|0}if(d.out_samplerate==0&&(2*d.lowpassfreq>d.in_samplerate&&(d.lowpassfreq=d.in_samplerate/2),d.out_samplerate=f(d.lowpassfreq|0,d.in_samplerate)),d.lowpassfreq=Math.min(20500,d.lowpassfreq),d.lowpassfreq=Math.min(d.out_samplerate/2,d.lowpassfreq),d.VBR==Et.vbr_off&&(d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.brate)),d.VBR==Et.vbr_abr&&(d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.VBR_mean_bitrate_kbps)),d.bWriteVbrTag||(d.findReplayGain=!1,d.decode_on_the_fly=!1,M.findPeakSample=!1),M.findReplayGain=d.findReplayGain,M.decode_on_the_fly=d.decode_on_the_fly,M.decode_on_the_fly&&(M.findPeakSample=!0),M.findReplayGain&&s.InitGainAnalysis(M.rgdata,d.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return d.internal_flags=null,-6;switch(M.decode_on_the_fly&&!d.decode_only&&(M.hip!=null&&c.hip_decode_exit(M.hip),M.hip=c.hip_decode_init()),M.mode_gr=d.out_samplerate<=24e3?1:2,d.framesize=576*M.mode_gr,d.encoder_delay=O.ENCDELAY,M.resample_ratio=d.in_samplerate/d.out_samplerate,d.VBR){case Et.vbr_mt:case Et.vbr_rh:case Et.vbr_mtrh:{var Ve=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];d.compression_ratio=Ve[d.VBR_q]}break;case Et.vbr_abr:d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.VBR_mean_bitrate_kbps);break;default:d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.brate);break}if(d.mode==vt.NOT_SET&&(d.mode=vt.JOINT_STEREO),d.highpassfreq>0?(M.highpass1=2*d.highpassfreq,d.highpasswidth>=0?M.highpass2=2*(d.highpassfreq+d.highpasswidth):M.highpass2=(1+0)*2*d.highpassfreq,M.highpass1/=d.out_samplerate,M.highpass2/=d.out_samplerate):(M.highpass1=0,M.highpass2=0),d.lowpassfreq>0?(M.lowpass2=2*d.lowpassfreq,d.lowpasswidth>=0?(M.lowpass1=2*(d.lowpassfreq-d.lowpasswidth),M.lowpass1<0&&(M.lowpass1=0)):M.lowpass1=(1-0)*2*d.lowpassfreq,M.lowpass1/=d.out_samplerate,M.lowpass2/=d.out_samplerate):(M.lowpass1=0,M.lowpass2=0),m(d),M.samplerate_index=R(d.out_samplerate,d),M.samplerate_index<0)return d.internal_flags=null,-1;if(d.VBR==Et.vbr_off){if(d.free_format)M.bitrate_index=0;else if(d.brate=C(d.brate,d.version,d.out_samplerate),M.bitrate_index=T(d.brate,d.version,d.out_samplerate),M.bitrate_index<=0)return d.internal_flags=null,-1}else M.bitrate_index=1;d.analysis&&(d.bWriteVbrTag=!1),M.pinfo!=null&&(d.bWriteVbrTag=!1),n.init_bit_stream_w(M);for(var Ne=M.samplerate_index+3*d.version+6*(d.out_samplerate<16e3?1:0),he=0;he<O.SBMAX_l+1;he++)M.scalefac_band.l[he]=o.sfBandIndex[Ne].l[he];for(var he=0;he<O.PSFB21+1;he++){var Ke=(M.scalefac_band.l[22]-M.scalefac_band.l[21])/O.PSFB21,it=M.scalefac_band.l[21]+he*Ke;M.scalefac_band.psfb21[he]=it}M.scalefac_band.psfb21[O.PSFB21]=576;for(var he=0;he<O.SBMAX_s+1;he++)M.scalefac_band.s[he]=o.sfBandIndex[Ne].s[he];for(var he=0;he<O.PSFB12+1;he++){var Ke=(M.scalefac_band.s[13]-M.scalefac_band.s[12])/O.PSFB12,it=M.scalefac_band.s[12]+he*Ke;M.scalefac_band.psfb12[he]=it}M.scalefac_band.psfb12[O.PSFB12]=192,d.version==1?M.sideinfo_len=M.channels_out==1?4+17:4+32:M.sideinfo_len=M.channels_out==1?4+9:4+17,d.error_protection&&(M.sideinfo_len+=2),S(d),M.Class_ID=F;{var U;for(U=0;U<19;U++)M.nsPsy.pefirbuf[U]=700*M.mode_gr*M.channels_out;d.ATHtype==-1&&(d.ATHtype=4)}switch(us(d.VBR_q<=9),us(d.VBR_q>=0),d.VBR){case Et.vbr_mt:d.VBR=Et.vbr_mtrh;case Et.vbr_mtrh:{d.useTemporal==null&&(d.useTemporal=!1),r.apply_preset(d,500-d.VBR_q*10,0),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),d.quality<5&&(d.quality=0),d.quality>5&&(d.quality=5),M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?M.sfb21_extra=!1:M.sfb21_extra=d.out_samplerate>44e3,M.iteration_loop=new VBRNewIterationLoop(u);break}case Et.vbr_rh:{r.apply_preset(d,500-d.VBR_q*10,0),M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?M.sfb21_extra=!1:M.sfb21_extra=d.out_samplerate>44e3,d.quality>6&&(d.quality=6),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),M.iteration_loop=new VBROldIterationLoop(u);break}default:{var Y;M.sfb21_extra=!1,d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),Y=d.VBR,Y==Et.vbr_off&&(d.VBR_mean_bitrate_kbps=d.brate),r.apply_preset(d,d.VBR_mean_bitrate_kbps,0),d.VBR=Y,M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,Y==Et.vbr_off?M.iteration_loop=new Lp(u):M.iteration_loop=new ABRIterationLoop(u);break}}if(us(d.scale>=0),d.VBR!=Et.vbr_off){if(M.VBR_min_bitrate=1,M.VBR_max_bitrate=14,d.out_samplerate<16e3&&(M.VBR_max_bitrate=8),d.VBR_min_bitrate_kbps!=0&&(d.VBR_min_bitrate_kbps=C(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),M.VBR_min_bitrate=T(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),M.VBR_min_bitrate<0)||d.VBR_max_bitrate_kbps!=0&&(d.VBR_max_bitrate_kbps=C(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),M.VBR_max_bitrate=T(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),M.VBR_max_bitrate<0))return-1;d.VBR_min_bitrate_kbps=oe.bitrate_table[d.version][M.VBR_min_bitrate],d.VBR_max_bitrate_kbps=oe.bitrate_table[d.version][M.VBR_max_bitrate],d.VBR_mean_bitrate_kbps=Math.min(oe.bitrate_table[d.version][M.VBR_max_bitrate],d.VBR_mean_bitrate_kbps),d.VBR_mean_bitrate_kbps=Math.max(oe.bitrate_table[d.version][M.VBR_min_bitrate],d.VBR_mean_bitrate_kbps)}return d.tune&&(M.PSY.mask_adjust+=d.tune_value_a,M.PSY.mask_adjust_short+=d.tune_value_a),k(d),us(d.scale>=0),d.athaa_type<0?M.ATH.useAdjust=3:M.ATH.useAdjust=d.athaa_type,M.ATH.aaSensitivityP=Math.pow(10,d.athaa_sensitivity/-10),d.short_blocks==null&&(d.short_blocks=ho.short_block_allowed),d.short_blocks==ho.short_block_allowed&&(d.mode==vt.JOINT_STEREO||d.mode==vt.STEREO)&&(d.short_blocks=ho.short_block_coupled),d.quant_comp<0&&(d.quant_comp=1),d.quant_comp_short<0&&(d.quant_comp_short=0),d.msfix<0&&(d.msfix=0),d.exp_nspsytune=d.exp_nspsytune|1,d.internal_flags.nsPsy.attackthre<0&&(d.internal_flags.nsPsy.attackthre=co.NSATTACKTHRE),d.internal_flags.nsPsy.attackthre_s<0&&(d.internal_flags.nsPsy.attackthre_s=co.NSATTACKTHRE_S),us(d.scale>=0),d.scale<0&&(d.scale=1),d.ATHtype<0&&(d.ATHtype=4),d.ATHcurve<0&&(d.ATHcurve=4),d.athaa_loudapprox<0&&(d.athaa_loudapprox=2),d.interChRatio<0&&(d.interChRatio=0),d.useTemporal==null&&(d.useTemporal=!0),M.slot_lag=M.frac_SpF=0,d.VBR==Et.vbr_off&&(M.slot_lag=M.frac_SpF=(d.version+1)*72e3*d.brate%d.out_samplerate|0),o.iteration_init(d),b.psymodel_init(d),us(d.scale>=0),0};function h(d,M){(d.in_buffer_0==null||d.in_buffer_nsamples<M)&&(d.in_buffer_0=js(M),d.in_buffer_1=js(M),d.in_buffer_nsamples=M)}this.lame_encode_flush=function(d,M,W,$){var _e=d.internal_flags,Ae=qp([2,1152]),Re=0,ge,Ve,Ne,he,Ke=_e.mf_samples_to_encode-O.POSTDELAY,it=g(d);if(_e.mf_samples_to_encode<1)return 0;for(ge=0,d.in_samplerate!=d.out_samplerate&&(Ke+=16*d.out_samplerate/d.in_samplerate),Ne=d.framesize-Ke%d.framesize,Ne<576&&(Ne+=d.framesize),d.encoder_padding=Ne,he=(Ke+Ne)/d.framesize;he>0&&Re>=0;){var U=it-_e.mf_size,Y=d.frameNum;U*=d.in_samplerate,U/=d.out_samplerate,U>1152&&(U=1152),U<1&&(U=1),Ve=$-ge,$==0&&(Ve=0),Re=this.lame_encode_buffer(d,Ae[0],Ae[1],U,M,W,Ve),W+=Re,ge+=Re,he-=Y!=d.frameNum?1:0}if(_e.mf_samples_to_encode=0,Re<0||(Ve=$-ge,$==0&&(Ve=0),n.flush_bitstream(d),Re=n.copy_buffer(_e,M,W,Ve,1),Re<0))return Re;if(W+=Re,ge+=Re,Ve=$-ge,$==0&&(Ve=0),d.write_id3tag_automatic){if(p.id3tag_write_v1(d),Re=n.copy_buffer(_e,M,W,Ve,0),Re<0)return Re;ge+=Re}return ge},this.lame_encode_buffer=function(d,M,W,$,_e,Ae,Re){var ge=d.internal_flags,Ve=[null,null];if(ge.Class_ID!=F)return-3;if($==0)return 0;h(ge,$),Ve[0]=ge.in_buffer_0,Ve[1]=ge.in_buffer_1;for(var Ne=0;Ne<$;Ne++)Ve[0][Ne]=M[Ne],ge.channels_in>1&&(Ve[1][Ne]=W[Ne]);return _(d,Ve[0],Ve[1],$,_e,Ae,Re)};function g(d){var M=O.BLKSIZE+d.framesize-O.FFTOFFSET;return M=Math.max(M,512+d.framesize-32),M}function _(d,M,W,$,_e,Ae,Re){var ge=d.internal_flags,Ve=0,Ne,he,Ke,it,U,Y=[null,null],te=[null,null];if(ge.Class_ID!=F)return-3;if($==0)return 0;if(U=n.copy_buffer(ge,_e,Ae,Re,0),U<0)return U;if(Ae+=U,Ve+=U,te[0]=M,te[1]=W,Ea.NEQ(d.scale,0)&&Ea.NEQ(d.scale,1))for(he=0;he<$;++he)te[0][he]*=d.scale,ge.channels_out==2&&(te[1][he]*=d.scale);if(Ea.NEQ(d.scale_left,0)&&Ea.NEQ(d.scale_left,1))for(he=0;he<$;++he)te[0][he]*=d.scale_left;if(Ea.NEQ(d.scale_right,0)&&Ea.NEQ(d.scale_right,1))for(he=0;he<$;++he)te[1][he]*=d.scale_right;if(d.num_channels==2&&ge.channels_out==1)for(he=0;he<$;++he)te[0][he]=.5*(te[0][he]+te[1][he]),te[1][he]=0;it=g(d),Y[0]=ge.mfbuf[0],Y[1]=ge.mfbuf[1];for(var de=0;$>0;){var me=[null,null],Ee=0,xe=0;me[0]=te[0],me[1]=te[1];var be=new y;if(z(d,Y,me,de,$,be),Ee=be.n_in,xe=be.n_out,ge.findReplayGain&&!ge.decode_on_the_fly&&s.AnalyzeSamples(ge.rgdata,Y[0],ge.mf_size,Y[1],ge.mf_size,xe,ge.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if($-=Ee,de+=Ee,ge.channels_out==2,ge.mf_size+=xe,us(ge.mf_size<=mt.MFSIZE),ge.mf_samples_to_encode<1&&(ge.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY),ge.mf_samples_to_encode+=xe,ge.mf_size>=it){var ke=Re-Ve;if(Re==0&&(ke=0),Ne=v(d,Y[0],Y[1],_e,Ae,ke),Ne<0)return Ne;for(Ae+=Ne,Ve+=Ne,ge.mf_size-=d.framesize,ge.mf_samples_to_encode-=d.framesize,Ke=0;Ke<ge.channels_out;Ke++)for(he=0;he<ge.mf_size;he++)Y[Ke][he]=Y[Ke][he+d.framesize]}}return Ve}function v(d,M,W,$,_e,Ae){var Re=e.enc.lame_encode_mp3_frame(d,M,W,$,_e,Ae);return d.frameNum++,Re}function y(){this.n_in=0,this.n_out=0}function w(){this.num_used=0}function j(d,M){return M!=0?j(M,d%M):d}function K(d,M,W){var $=Math.PI*M;d/=W,d<0&&(d=0),d>1&&(d=1);var _e=d-.5,Ae=.42-.5*Math.cos(2*d*Math.PI)+.08*Math.cos(4*d*Math.PI);return Math.abs(_e)<1e-9?$/Math.PI:Ae*Math.sin(W*$*_e)/(Math.PI*W*_e)}function P(d,M,W,$,_e,Ae,Re,ge,Ve){var Ne=d.internal_flags,he,Ke=0,it,U=d.out_samplerate/j(d.out_samplerate,d.in_samplerate);U>mt.BPC&&(U=mt.BPC);var Y=Math.abs(Ne.resample_ratio-Math.floor(.5+Ne.resample_ratio))<1e-4?1:0,te=1/Ne.resample_ratio;te>1&&(te=1);var de=31;de%2==0&&--de,de+=Y;var me=de+1;if(Ne.fill_buffer_resample_init==0){for(Ne.inbuf_old[0]=js(me),Ne.inbuf_old[1]=js(me),he=0;he<=2*U;++he)Ne.blackfilt[he]=js(me);for(Ne.itime[0]=0,Ne.itime[1]=0,Ke=0;Ke<=2*U;Ke++){var Ee=0,xe=(Ke-U)/(2*U);for(he=0;he<=de;he++)Ee+=Ne.blackfilt[Ke][he]=K(he-xe,te,de);for(he=0;he<=de;he++)Ne.blackfilt[Ke][he]/=Ee}Ne.fill_buffer_resample_init=1}var be=Ne.inbuf_old[Ve];for(it=0;it<$;it++){var ke,pe;if(ke=it*Ne.resample_ratio,Ke=0|Math.floor(ke-Ne.itime[Ve]),de+Ke-de/2>=Re)break;var xe=ke-Ne.itime[Ve]-(Ke+.5*(de%2));pe=0|Math.floor(xe*2*U+U+.5);var De=0;for(he=0;he<=de;++he){var He=0|he+Ke-de/2,fe;fe=He<0?be[me+He]:_e[Ae+He],De+=fe*Ne.blackfilt[pe][he]}M[W+it]=De}if(ge.num_used=Math.min(Re,de+Ke-de/2),Ne.itime[Ve]+=ge.num_used-it*Ne.resample_ratio,ge.num_used>=me)for(he=0;he<me;he++)be[he]=_e[Ae+ge.num_used+he-me];else{var ae=me-ge.num_used;for(he=0;he<ae;++he)be[he]=be[he+ge.num_used];for(Ke=0;he<me;++he,++Ke)be[he]=_e[Ae+Ke];us(Ke==ge.num_used)}return it}function z(d,M,W,$,_e,Ae){var Re=d.internal_flags;if(Re.resample_ratio<.9999||Re.resample_ratio>1.0001)for(var ge=0;ge<Re.channels_out;ge++){var Ve=new w;Ae.n_out=P(d,M[ge],Re.mf_size,d.framesize,W[ge],$,_e,Ve,ge),Ae.n_in=Ve.num_used}else{Ae.n_out=Math.min(d.framesize,_e),Ae.n_in=Ae.n_out;for(var Ne=0;Ne<Ae.n_out;++Ne)M[0][Re.mf_size+Ne]=W[0][$+Ne],Re.channels_out==2&&(M[1][Re.mf_size+Ne]=W[1][$+Ne])}}}var Pa=Ie.VbrMode;function zp(){function e(l,p,c,E,A,i,F,L,B,f,R,C,T,N,m){this.vbr_q=l,this.quant_comp=p,this.quant_comp_s=c,this.expY=E,this.st_lrm=A,this.st_s=i,this.masking_adj=F,this.masking_adj_short=L,this.ath_lower=B,this.ath_curve=f,this.ath_sensitivity=R,this.interch=C,this.safejoint=T,this.sfb21mod=N,this.msfix=m}function t(l,p,c,E,A,i,F,L,B,f,R,C,T,N){this.quant_comp=p,this.quant_comp_s=c,this.safejoint=E,this.nsmsfix=A,this.st_lrm=i,this.st_s=F,this.nsbass=L,this.scale=B,this.masking_adj=f,this.ath_lower=R,this.ath_curve=C,this.interch=T,this.sfscale=N}var a;this.setModules=function(l){a=l};var s=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],n=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function r(l,p,c){var E=l.VBR==Pa.vbr_rh?s:n,A=l.VBR_q_frac,i=E[p],F=E[p+1],L=i;i.st_lrm=i.st_lrm+A*(F.st_lrm-i.st_lrm),i.st_s=i.st_s+A*(F.st_s-i.st_s),i.masking_adj=i.masking_adj+A*(F.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+A*(F.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+A*(F.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+A*(F.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+A*(F.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+A*(F.interch-i.interch),i.msfix=i.msfix+A*(F.msfix-i.msfix),b(l,L.vbr_q),c!=0?l.quant_comp=L.quant_comp:Math.abs(l.quant_comp- -1)>0||(l.quant_comp=L.quant_comp),c!=0?l.quant_comp_short=L.quant_comp_s:Math.abs(l.quant_comp_short- -1)>0||(l.quant_comp_short=L.quant_comp_s),L.expY!=0&&(l.experimentalY=L.expY!=0),c!=0?l.internal_flags.nsPsy.attackthre=L.st_lrm:Math.abs(l.internal_flags.nsPsy.attackthre- -1)>0||(l.internal_flags.nsPsy.attackthre=L.st_lrm),c!=0?l.internal_flags.nsPsy.attackthre_s=L.st_s:Math.abs(l.internal_flags.nsPsy.attackthre_s- -1)>0||(l.internal_flags.nsPsy.attackthre_s=L.st_s),c!=0?l.maskingadjust=L.masking_adj:Math.abs(l.maskingadjust-0)>0||(l.maskingadjust=L.masking_adj),c!=0?l.maskingadjust_short=L.masking_adj_short:Math.abs(l.maskingadjust_short-0)>0||(l.maskingadjust_short=L.masking_adj_short),c!=0?l.ATHlower=-L.ath_lower/10:Math.abs(-l.ATHlower*10-0)>0||(l.ATHlower=-L.ath_lower/10),c!=0?l.ATHcurve=L.ath_curve:Math.abs(l.ATHcurve- -1)>0||(l.ATHcurve=L.ath_curve),c!=0?l.athaa_sensitivity=L.ath_sensitivity:Math.abs(l.athaa_sensitivity- -1)>0||(l.athaa_sensitivity=L.ath_sensitivity),L.interch>0&&(c!=0?l.interChRatio=L.interch:Math.abs(l.interChRatio- -1)>0||(l.interChRatio=L.interch)),L.safejoint>0&&(l.exp_nspsytune=l.exp_nspsytune|L.safejoint),L.sfb21mod>0&&(l.exp_nspsytune=l.exp_nspsytune|L.sfb21mod<<20),c!=0?l.msfix=L.msfix:Math.abs(l.msfix- -1)>0||(l.msfix=L.msfix),c==0&&(l.VBR_q=p,l.VBR_q_frac=A)}var o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function u(l,p,c){var E=p,A=a.nearestBitrateFullIndex(p);if(l.VBR=Pa.vbr_abr,l.VBR_mean_bitrate_kbps=E,l.VBR_mean_bitrate_kbps=Math.min(l.VBR_mean_bitrate_kbps,320),l.VBR_mean_bitrate_kbps=Math.max(l.VBR_mean_bitrate_kbps,8),l.brate=l.VBR_mean_bitrate_kbps,l.VBR_mean_bitrate_kbps>320&&(l.disable_reservoir=!0),o[A].safejoint>0&&(l.exp_nspsytune=l.exp_nspsytune|2),o[A].sfscale>0&&(l.internal_flags.noise_shaping=2),Math.abs(o[A].nsbass)>0){var i=int(o[A].nsbass*4);i<0&&(i+=64),l.exp_nspsytune=l.exp_nspsytune|i<<2}return c!=0?l.quant_comp=o[A].quant_comp:Math.abs(l.quant_comp- -1)>0||(l.quant_comp=o[A].quant_comp),c!=0?l.quant_comp_short=o[A].quant_comp_s:Math.abs(l.quant_comp_short- -1)>0||(l.quant_comp_short=o[A].quant_comp_s),c!=0?l.msfix=o[A].nsmsfix:Math.abs(l.msfix- -1)>0||(l.msfix=o[A].nsmsfix),c!=0?l.internal_flags.nsPsy.attackthre=o[A].st_lrm:Math.abs(l.internal_flags.nsPsy.attackthre- -1)>0||(l.internal_flags.nsPsy.attackthre=o[A].st_lrm),c!=0?l.internal_flags.nsPsy.attackthre_s=o[A].st_s:Math.abs(l.internal_flags.nsPsy.attackthre_s- -1)>0||(l.internal_flags.nsPsy.attackthre_s=o[A].st_s),c!=0?l.scale=o[A].scale:Math.abs(l.scale- -1)>0||(l.scale=o[A].scale),c!=0?l.maskingadjust=o[A].masking_adj:Math.abs(l.maskingadjust-0)>0||(l.maskingadjust=o[A].masking_adj),o[A].masking_adj>0?c!=0?l.maskingadjust_short=o[A].masking_adj*.9:Math.abs(l.maskingadjust_short-0)>0||(l.maskingadjust_short=o[A].masking_adj*.9):c!=0?l.maskingadjust_short=o[A].masking_adj*1.1:Math.abs(l.maskingadjust_short-0)>0||(l.maskingadjust_short=o[A].masking_adj*1.1),c!=0?l.ATHlower=-o[A].ath_lower/10:Math.abs(-l.ATHlower*10-0)>0||(l.ATHlower=-o[A].ath_lower/10),c!=0?l.ATHcurve=o[A].ath_curve:Math.abs(l.ATHcurve- -1)>0||(l.ATHcurve=o[A].ath_curve),c!=0?l.interChRatio=o[A].interch:Math.abs(l.interChRatio- -1)>0||(l.interChRatio=o[A].interch),p}this.apply_preset=function(l,p,c){switch(p){case Qe.R3MIX:{p=Qe.V3,l.VBR=Pa.vbr_mtrh;break}case Qe.MEDIUM:{p=Qe.V4,l.VBR=Pa.vbr_rh;break}case Qe.MEDIUM_FAST:{p=Qe.V4,l.VBR=Pa.vbr_mtrh;break}case Qe.STANDARD:{p=Qe.V2,l.VBR=Pa.vbr_rh;break}case Qe.STANDARD_FAST:{p=Qe.V2,l.VBR=Pa.vbr_mtrh;break}case Qe.EXTREME:{p=Qe.V0,l.VBR=Pa.vbr_rh;break}case Qe.EXTREME_FAST:{p=Qe.V0,l.VBR=Pa.vbr_mtrh;break}case Qe.INSANE:return p=320,l.preset=p,u(l,p,c),l.VBR=Pa.vbr_off,p}switch(l.preset=p,p){case Qe.V9:return r(l,9,c),p;case Qe.V8:return r(l,8,c),p;case Qe.V7:return r(l,7,c),p;case Qe.V6:return r(l,6,c),p;case Qe.V5:return r(l,5,c),p;case Qe.V4:return r(l,4,c),p;case Qe.V3:return r(l,3,c),p;case Qe.V2:return r(l,2,c),p;case Qe.V1:return r(l,1,c),p;case Qe.V0:return r(l,0,c),p}return p>=8&&p<=320?u(l,p,c):(l.preset=0,p)};function b(l,p){var c=0;return p<0&&(c=-1,p=0),p>9&&(c=-1,p=9),l.VBR_q=p,l.VBR_q_frac=0,c}}function Yp(){this.setModules=function(e,t){}}function vo(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var o1=Ie.new_float,Xp=Ie.new_int;function Kp(){this.global_gain=0,this.sfb_count1=0,this.step=Xp(39),this.noise=o1(39),this.noise_log=o1(39)}var ds=Ie.System,l1=Ie.VbrMode,_o=Ie.Util,rr=Ie.Arrays,Lr=Ie.new_float,Nr=Ie.assert;function Gp(){var e;this.rv=null;var t;this.qupvt=null;var a,s=new Yp,n;this.setModules=function(B,f,R,C){e=B,t=f,this.rv=f,a=R,this.qupvt=R,n=C,s.setModules(a,n)},this.ms_convert=function(B,f){for(var R=0;R<576;++R){var C=B.tt[f][0].xr[R],T=B.tt[f][1].xr[R];B.tt[f][0].xr[R]=(C+T)*(_o.SQRT2*.5),B.tt[f][1].xr[R]=(C-T)*(_o.SQRT2*.5)}};function r(B,f,R,C){C=0;for(var T=0;T<=R;++T){var N=Math.abs(B.xr[T]);C+=N,f[T]=Math.sqrt(N*Math.sqrt(N)),f[T]>B.xrpow_max&&(B.xrpow_max=f[T])}return C}this.init_xrpow=function(B,f,R){var C=0,T=0|f.max_nonzero_coeff;if(f.xrpow_max=0,rr.fill(R,T,576,0),C=r(f,R,T,C),C>1e-20){var N=0;B.substep_shaping&2&&(N=1);for(var m=0;m<f.psymax;m++)B.pseudohalf[m]=N;return!0}return rr.fill(f.l3_enc,0,576,0),!1};function o(B,f){var R=B.ATH,C=f.xr;if(f.block_type!=O.SHORT_TYPE)for(var T=!1,N=O.PSFB21-1;N>=0&&!T;N--){var m=B.scalefac_band.psfb21[N],k=B.scalefac_band.psfb21[N+1],S=a.athAdjust(R.adjust,R.psfb21[N],R.floor);B.nsPsy.longfact[21]>1e-12&&(S*=B.nsPsy.longfact[21]);for(var h=k-1;h>=m;h--)if(Math.abs(C[h])<S)C[h]=0;else{T=!0;break}}else for(var g=0;g<3;g++)for(var T=!1,N=O.PSFB12-1;N>=0&&!T;N--){var m=B.scalefac_band.s[12]*3+(B.scalefac_band.s[13]-B.scalefac_band.s[12])*g+(B.scalefac_band.psfb12[N]-B.scalefac_band.psfb12[0]),k=m+(B.scalefac_band.psfb12[N+1]-B.scalefac_band.psfb12[N]),_=a.athAdjust(R.adjust,R.psfb12[N],R.floor);B.nsPsy.shortfact[12]>1e-12&&(_*=B.nsPsy.shortfact[12]);for(var h=k-1;h>=m;h--)if(Math.abs(C[h])<_)C[h]=0;else{T=!0;break}}}this.init_outer_loop=function(B,f){f.part2_3_length=0,f.big_values=0,f.count1=0,f.global_gain=210,f.scalefac_compress=0,f.table_select[0]=0,f.table_select[1]=0,f.table_select[2]=0,f.subblock_gain[0]=0,f.subblock_gain[1]=0,f.subblock_gain[2]=0,f.subblock_gain[3]=0,f.region0_count=0,f.region1_count=0,f.preflag=0,f.scalefac_scale=0,f.count1table_select=0,f.part2_length=0,f.sfb_lmax=O.SBPSY_l,f.sfb_smin=O.SBPSY_s,f.psy_lmax=B.sfb21_extra?O.SBMAX_l:O.SBPSY_l,f.psymax=f.psy_lmax,f.sfbmax=f.sfb_lmax,f.sfbdivide=11;for(var R=0;R<O.SBMAX_l;R++)f.width[R]=B.scalefac_band.l[R+1]-B.scalefac_band.l[R],f.window[R]=3;if(f.block_type==O.SHORT_TYPE){var C=Lr(576);f.sfb_smin=0,f.sfb_lmax=0,f.mixed_block_flag!=0&&(f.sfb_smin=3,f.sfb_lmax=B.mode_gr*2+4),f.psymax=f.sfb_lmax+3*((B.sfb21_extra?O.SBMAX_s:O.SBPSY_s)-f.sfb_smin),f.sfbmax=f.sfb_lmax+3*(O.SBPSY_s-f.sfb_smin),f.sfbdivide=f.sfbmax-18,f.psy_lmax=f.sfb_lmax;var T=B.scalefac_band.l[f.sfb_lmax];ds.arraycopy(f.xr,0,C,0,576);for(var R=f.sfb_smin;R<O.SBMAX_s;R++)for(var N=B.scalefac_band.s[R],m=B.scalefac_band.s[R+1],k=0;k<3;k++)for(var S=N;S<m;S++)f.xr[T++]=C[3*S+k];for(var h=f.sfb_lmax,R=f.sfb_smin;R<O.SBMAX_s;R++)f.width[h]=f.width[h+1]=f.width[h+2]=B.scalefac_band.s[R+1]-B.scalefac_band.s[R],f.window[h]=0,f.window[h+1]=1,f.window[h+2]=2,h+=3}f.count1bits=0,f.sfb_partition_table=a.nr_of_sfb_block[0][0],f.slen[0]=0,f.slen[1]=0,f.slen[2]=0,f.slen[3]=0,f.max_nonzero_coeff=575,rr.fill(f.scalefac,0),o(B,f)};function u(B){this.ordinal=B}u.BINSEARCH_NONE=new u(0),u.BINSEARCH_UP=new u(1),u.BINSEARCH_DOWN=new u(2);function b(B,f,R,C,T){var N,m=B.CurrentStep[C],k=!1,S=B.OldValue[C],h=u.BINSEARCH_NONE;for(f.global_gain=S,R-=f.part2_length;;){var g;if(N=n.count_bits(B,T,f,null),m==1||N==R)break;N>R?(h==u.BINSEARCH_DOWN&&(k=!0),k&&(m/=2),h=u.BINSEARCH_UP,g=m):(h==u.BINSEARCH_UP&&(k=!0),k&&(m/=2),h=u.BINSEARCH_DOWN,g=-m),f.global_gain+=g,f.global_gain<0&&(f.global_gain=0,k=!0),f.global_gain>255&&(f.global_gain=255,k=!0)}for(Nr(f.global_gain>=0),Nr(f.global_gain<256);N>R&&f.global_gain<255;)f.global_gain++,N=n.count_bits(B,T,f,null);return B.CurrentStep[C]=S-f.global_gain>=4?4:2,B.OldValue[C]=f.global_gain,f.part2_3_length=N,N}this.trancate_smallspectrums=function(B,f,R,C){var T=Lr(bs.SFBMAX);if(!(!(B.substep_shaping&4)&&f.block_type==O.SHORT_TYPE||B.substep_shaping&128)){a.calc_noise(f,R,T,new vo,null);for(var m=0;m<576;m++){var N=0;f.l3_enc[m]!=0&&(N=Math.abs(f.xr[m])),C[m]=N}var m=0,k=8;f.block_type==O.SHORT_TYPE&&(k=6);do{var S,h,g,_,v=f.width[k];if(m+=v,!(T[k]>=1)&&(rr.sort(C,m-v,v),!BitStream.EQ(C[m-1],0))){S=(1-T[k])*R[k],h=0,_=0;do{var y;for(g=1;_+g<v&&!BitStream.NEQ(C[_+m-v],C[_+m+g-v]);g++);if(y=C[_+m-v]*C[_+m-v]*g,S<y){_!=0&&(h=C[_+m-v-1]);break}S-=y,_+=g}while(_<v);if(!BitStream.EQ(h,0))do Math.abs(f.xr[m-v])<=h&&(f.l3_enc[m-v]=0);while(--v>0)}}while(++k<f.psymax);f.part2_3_length=n.noquant_count_bits(B,f,null)}};function l(B){for(var f=0;f<B.sfbmax;f++)if(B.scalefac[f]+B.subblock_gain[B.window[f]]==0)return!1;return!0}function p(B){return _o.FAST_LOG10(.368+.632*B*B*B)}function c(B,f){for(var R=1e-37,C=0;C<f.psymax;C++)R+=p(B[C]);return Math.max(1e-20,R)}function E(B,f,R,C,T){var N;switch(B){default:case 9:{f.over_count>0?(N=R.over_SSD<=f.over_SSD,R.over_SSD==f.over_SSD&&(N=R.bits<f.bits)):N=R.max_noise<0&&R.max_noise*10+R.bits<=f.max_noise*10+f.bits;break}case 0:N=R.over_count<f.over_count||R.over_count==f.over_count&&R.over_noise<f.over_noise||R.over_count==f.over_count&&BitStream.EQ(R.over_noise,f.over_noise)&&R.tot_noise<f.tot_noise;break;case 8:R.max_noise=c(T,C);case 1:N=R.max_noise<f.max_noise;break;case 2:N=R.tot_noise<f.tot_noise;break;case 3:N=R.tot_noise<f.tot_noise&&R.max_noise<f.max_noise;break;case 4:N=R.max_noise<=0&&f.max_noise>.2||R.max_noise<=0&&f.max_noise<0&&f.max_noise>R.max_noise-.2&&R.tot_noise<f.tot_noise||R.max_noise<=0&&f.max_noise>0&&f.max_noise>R.max_noise-.2&&R.tot_noise<f.tot_noise+f.over_noise||R.max_noise>0&&f.max_noise>-.05&&f.max_noise>R.max_noise-.1&&R.tot_noise+R.over_noise<f.tot_noise+f.over_noise||R.max_noise>0&&f.max_noise>-.1&&f.max_noise>R.max_noise-.15&&R.tot_noise+R.over_noise+R.over_noise<f.tot_noise+f.over_noise+f.over_noise;break;case 5:N=R.over_noise<f.over_noise||BitStream.EQ(R.over_noise,f.over_noise)&&R.tot_noise<f.tot_noise;break;case 6:N=R.over_noise<f.over_noise||BitStream.EQ(R.over_noise,f.over_noise)&&(R.max_noise<f.max_noise||BitStream.EQ(R.max_noise,f.max_noise)&&R.tot_noise<=f.tot_noise);break;case 7:N=R.over_count<f.over_count||R.over_noise<f.over_noise;break}return f.over_count==0&&(N=N&&R.bits<f.bits),N}function A(B,f,R,C,T){var N=B.internal_flags,m;f.scalefac_scale==0?m=1.2968395546510096:m=1.6817928305074292;for(var k=0,S=0;S<f.sfbmax;S++)k<R[S]&&(k=R[S]);var h=N.noise_shaping_amp;switch(h==3&&(T?h=2:h=1),h){case 2:break;case 1:k>1?k=Math.pow(k,.5):k*=.95;break;case 0:default:k>1?k=1:k*=.95;break}for(var g=0,S=0;S<f.sfbmax;S++){var _=f.width[S],v;if(g+=_,!(R[S]<k)){if(N.substep_shaping&2&&(N.pseudohalf[S]=N.pseudohalf[S]==0?1:0,N.pseudohalf[S]==0&&N.noise_shaping_amp==2))return;for(f.scalefac[S]++,v=-_;v<0;v++)C[g+v]*=m,C[g+v]>f.xrpow_max&&(f.xrpow_max=C[g+v]);if(N.noise_shaping_amp==2)return}}}function i(B,f){for(var R=1.2968395546510096,C=0,T=0;T<B.sfbmax;T++){var N=B.width[T],m=B.scalefac[T];if(B.preflag!=0&&(m+=a.pretab[T]),C+=N,m&1){m++;for(var k=-N;k<0;k++)f[C+k]*=R,f[C+k]>B.xrpow_max&&(B.xrpow_max=f[C+k])}B.scalefac[T]=m>>1}B.preflag=0,B.scalefac_scale=1}function F(B,f,R){var C,T=f.scalefac;for(C=0;C<f.sfb_lmax;C++)if(T[C]>=16)return!0;for(var N=0;N<3;N++){var m=0,k=0;for(C=f.sfb_lmax+N;C<f.sfbdivide;C+=3)m<T[C]&&(m=T[C]);for(;C<f.sfbmax;C+=3)k<T[C]&&(k=T[C]);if(!(m<16&&k<8)){if(f.subblock_gain[N]>=7)return!0;f.subblock_gain[N]++;var S=B.scalefac_band.l[f.sfb_lmax];for(C=f.sfb_lmax+N;C<f.sfbmax;C+=3){var h,g=f.width[C],_=T[C];if(_=_-(4>>f.scalefac_scale),_>=0){T[C]=_,S+=g*3;continue}T[C]=0;{var v=210+(_<<f.scalefac_scale+1);h=a.IPOW20(v)}S+=g*(N+1);for(var y=-g;y<0;y++)R[S+y]*=h,R[S+y]>f.xrpow_max&&(f.xrpow_max=R[S+y]);S+=g*(3-N-1)}{var h=a.IPOW20(202);S+=f.width[C]*(N+1);for(var y=-f.width[C];y<0;y++)R[S+y]*=h,R[S+y]>f.xrpow_max&&(f.xrpow_max=R[S+y])}}}return!1}function L(B,f,R,C,T){var N=B.internal_flags;A(B,f,R,C,T);var m=l(f);return m?!1:(N.mode_gr==2?m=n.scale_bitcount(f):m=n.scale_bitcount_lsf(N,f),m?(N.noise_shaping>1&&(rr.fill(N.pseudohalf,0),f.scalefac_scale==0?(i(f,C),m=!1):f.block_type==O.SHORT_TYPE&&N.subblock_gain>0&&(m=F(N,f,C)||l(f))),m||(N.mode_gr==2?m=n.scale_bitcount(f):m=n.scale_bitcount_lsf(N,f)),!m):!0)}this.outer_loop=function(B,f,R,C,T,N){var m=B.internal_flags,k=new ci,S=Lr(576),h=Lr(bs.SFBMAX),g=new vo,_,v=new Kp,y=9999999,w=!1,j=!1,K=0;if(b(m,f,N,T,C),m.noise_shaping==0)return 100;a.calc_noise(f,R,h,g,v),g.bits=f.part2_3_length,k.assign(f);var P=0;for(ds.arraycopy(C,0,S,0,576);!w;){do{var z=new vo,d,M=255;if(m.substep_shaping&2?d=20:d=3,m.sfb21_extra&&(h[k.sfbmax]>1||k.block_type==O.SHORT_TYPE&&(h[k.sfbmax+1]>1||h[k.sfbmax+2]>1))||!L(B,k,h,C,j))break;k.scalefac_scale!=0&&(M=254);var W=N-k.part2_length;if(W<=0)break;for(;(k.part2_3_length=n.count_bits(m,C,k,v))>W&&k.global_gain<=M;)k.global_gain++;if(k.global_gain>M)break;if(g.over_count==0){for(;(k.part2_3_length=n.count_bits(m,C,k,v))>y&&k.global_gain<=M;)k.global_gain++;if(k.global_gain>M)break}if(a.calc_noise(k,R,h,z,v),z.bits=k.part2_3_length,f.block_type!=O.SHORT_TYPE?_=B.quant_comp:_=B.quant_comp_short,_=E(_,g,z,k,h)?1:0,_!=0)y=f.part2_3_length,g=z,f.assign(k),P=0,ds.arraycopy(C,0,S,0,576);else if(m.full_outer_loop==0&&(++P>d&&g.over_count==0||m.noise_shaping_amp==3&&j&&P>30||m.noise_shaping_amp==3&&j&&k.global_gain-K>15))break}while(k.global_gain+k.scalefac_scale<255);m.noise_shaping_amp==3?j?w=!0:(k.assign(f),ds.arraycopy(S,0,C,0,576),P=0,K=k.global_gain,j=!0):w=!0}return Nr(f.global_gain+f.scalefac_scale<=255),B.VBR==l1.vbr_rh||B.VBR==l1.vbr_mtrh?ds.arraycopy(S,0,C,0,576):m.substep_shaping&1&&trancate_smallspectrums(m,f,R,C),g.over_count},this.iteration_finish_one=function(B,f,R){var C=B.l3_side,T=C.tt[f][R];n.best_scalefac_store(B,f,R,C),B.use_best_huffman==1&&n.best_huffman_divide(B,T),t.ResvAdjust(B,T)},this.VBR_encode_granule=function(B,f,R,C,T,N,m){var k=B.internal_flags,S=new ci,h=Lr(576),g=m,_=m+1,v=(m+N)/2,y,w,j=0,K=k.sfb21_extra;Nr(g<=LameInternalFlags.MAX_BITS_PER_CHANNEL),rr.fill(S.l3_enc,0);do v>g-42?k.sfb21_extra=!1:k.sfb21_extra=K,w=outer_loop(B,f,R,C,T,v),w<=0?(j=1,_=f.part2_3_length,S.assign(f),ds.arraycopy(C,0,h,0,576),m=_-32,y=m-N,v=(m+N)/2):(N=v+32,y=m-N,v=(m+N)/2,j!=0&&(j=2,f.assign(S),ds.arraycopy(h,0,C,0,576)));while(y>12);k.sfb21_extra=K,j==2&&ds.arraycopy(S.l3_enc,0,f.l3_enc,0,576),Nr(f.part2_3_length<=g)},this.get_framebits=function(B,f){var R=B.internal_flags;R.bitrate_index=R.VBR_min_bitrate;var C=e.getframebits(B);R.bitrate_index=1,C=e.getframebits(B);for(var T=1;T<=R.VBR_max_bitrate;T++){R.bitrate_index=T;var N=new MeanBits(C);f[T]=t.ResvFrameBegin(B,N),C=N.bits}},this.VBR_old_prepare=function(B,f,R,C,T,N,m,k,S){var h=B.internal_flags,g,_=0,v=1,y=0;h.bitrate_index=h.VBR_max_bitrate;var w=t.ResvFrameBegin(B,new MeanBits(0))/h.mode_gr;get_framebits(B,N);for(var j=0;j<h.mode_gr;j++){var K=a.on_pe(B,f,k[j],w,j,0);h.mode_ext==O.MPG_MD_MS_LR&&(ms_convert(h.l3_side,j),a.reduce_side(k[j],R[j],w,K));for(var P=0;P<h.channels_out;++P){var z=h.l3_side.tt[j][P];z.block_type!=O.SHORT_TYPE?(_=1.28/(1+Math.exp(3.5-f[j][P]/300))-.05,g=h.PSY.mask_adjust-_):(_=2.56/(1+Math.exp(3.5-f[j][P]/300))-.14,g=h.PSY.mask_adjust_short-_),h.masking_lower=Math.pow(10,g*.1),init_outer_loop(h,z),S[j][P]=a.calc_xmin(B,C[j][P],z,T[j][P]),S[j][P]!=0&&(v=0),m[j][P]=126,y+=k[j][P]}}for(var j=0;j<h.mode_gr;j++)for(var P=0;P<h.channels_out;P++)y>N[h.VBR_max_bitrate]&&(k[j][P]*=N[h.VBR_max_bitrate],k[j][P]/=y),m[j][P]>k[j][P]&&(m[j][P]=k[j][P]);return v},this.bitpressure_strategy=function(B,f,R,C){for(var T=0;T<B.mode_gr;T++)for(var N=0;N<B.channels_out;N++){for(var m=B.l3_side.tt[T][N],k=f[T][N],S=0,h=0;h<m.psy_lmax;h++)k[S++]*=1+.029*h*h/O.SBMAX_l/O.SBMAX_l;if(m.block_type==O.SHORT_TYPE)for(var h=m.sfb_smin;h<O.SBMAX_s;h++)k[S++]*=1+.029*h*h/O.SBMAX_s/O.SBMAX_s,k[S++]*=1+.029*h*h/O.SBMAX_s/O.SBMAX_s,k[S++]*=1+.029*h*h/O.SBMAX_s/O.SBMAX_s;C[T][N]=0|Math.max(R[T][N],.9*C[T][N])}},this.VBR_new_prepare=function(B,f,R,C,T,N){var m=B.internal_flags,k=1,S=0,h=0,g;if(B.free_format){m.bitrate_index=0;var _=new MeanBits(S);g=t.ResvFrameBegin(B,_),S=_.bits,T[0]=g}else{m.bitrate_index=m.VBR_max_bitrate;var _=new MeanBits(S);t.ResvFrameBegin(B,_),S=_.bits,get_framebits(B,T),g=T[m.VBR_max_bitrate]}for(var v=0;v<m.mode_gr;v++){a.on_pe(B,f,N[v],S,v,0),m.mode_ext==O.MPG_MD_MS_LR&&ms_convert(m.l3_side,v);for(var y=0;y<m.channels_out;++y){var w=m.l3_side.tt[v][y];m.masking_lower=Math.pow(10,m.PSY.mask_adjust*.1),init_outer_loop(m,w),a.calc_xmin(B,R[v][y],w,C[v][y])!=0&&(k=0),h+=N[v][y]}}for(var v=0;v<m.mode_gr;v++)for(var y=0;y<m.channels_out;y++)h>g&&(N[v][y]*=g,N[v][y]/=h);return k},this.calc_target_bits=function(B,f,R,C,T,N){var m=B.internal_flags,k=m.l3_side,S,h,g,_,v=0;m.bitrate_index=m.VBR_max_bitrate;var y=new MeanBits(v);for(N[0]=t.ResvFrameBegin(B,y),v=y.bits,m.bitrate_index=1,v=e.getframebits(B)-m.sideinfo_len*8,T[0]=v/(m.mode_gr*m.channels_out),v=B.VBR_mean_bitrate_kbps*B.framesize*1e3,m.substep_shaping&1&&(v*=1.09),v/=B.out_samplerate,v-=m.sideinfo_len*8,v/=m.mode_gr*m.channels_out,S=.93+.07*(11-B.compression_ratio)/(11-5.5),S<.9&&(S=.9),S>1&&(S=1),h=0;h<m.mode_gr;h++){var w=0;for(g=0;g<m.channels_out;g++){if(C[h][g]=int(S*v),f[h][g]>700){var j=int((f[h][g]-700)/1.4),K=k.tt[h][g];C[h][g]=int(S*v),K.block_type==O.SHORT_TYPE&&j<v/2&&(j=v/2),j>v*3/2?j=v*3/2:j<0&&(j=0),C[h][g]+=j}C[h][g]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(C[h][g]=LameInternalFlags.MAX_BITS_PER_CHANNEL),w+=C[h][g]}if(w>LameInternalFlags.MAX_BITS_PER_GRANULE)for(g=0;g<m.channels_out;++g)C[h][g]*=LameInternalFlags.MAX_BITS_PER_GRANULE,C[h][g]/=w}if(m.mode_ext==O.MPG_MD_MS_LR)for(h=0;h<m.mode_gr;h++)a.reduce_side(C[h],R[h],v*m.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(_=0,h=0;h<m.mode_gr;h++)for(g=0;g<m.channels_out;g++)C[h][g]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(C[h][g]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=C[h][g];if(_>N[0])for(h=0;h<m.mode_gr;h++)for(g=0;g<m.channels_out;g++)C[h][g]*=N[0],C[h][g]/=_}}var c1=Ie.assert;function Zp(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,a){var s=t.internal_flags,n,r=s.l3_side,o=e.getframebits(t);a.bits=(o-s.sideinfo_len*8)/s.mode_gr;var u=8*256*s.mode_gr-8;t.brate>320?n=8*int(t.brate*1e3/(t.out_samplerate/1152)/8+.5):(n=8*1440,t.strict_ISO&&(n=8*int(32e4/(t.out_samplerate/1152)/8+.5))),s.ResvMax=n-o,s.ResvMax>u&&(s.ResvMax=u),(s.ResvMax<0||t.disable_reservoir)&&(s.ResvMax=0);var b=a.bits*s.mode_gr+Math.min(s.ResvSize,s.ResvMax);return b>n&&(b=n),c1(s.ResvMax%8==0),c1(s.ResvMax>=0),r.resvDrain_pre=0,s.pinfo!=null&&(s.pinfo.mean_bits=a.bits/2,s.pinfo.resvsize=s.ResvSize),b},this.ResvMaxBits=function(t,a,s,n){var r=t.internal_flags,o,u=r.ResvSize,b=r.ResvMax;n!=0&&(u+=a),r.substep_shaping&1&&(b*=.9),s.bits=a,u*10>b*9?(o=u-b*9/10,s.bits+=o,r.substep_shaping|=128):(o=0,r.substep_shaping&=127,!t.disable_reservoir&&!(r.substep_shaping&1)&&(s.bits-=.1*a));var l=u<r.ResvMax*6/10?u:r.ResvMax*6/10;return l-=o,l<0&&(l=0),l},this.ResvAdjust=function(t,a){t.ResvSize-=a.part2_3_length+a.part2_length},this.ResvFrameEnd=function(t,a){var s,n=t.l3_side;t.ResvSize+=a*t.mode_gr;var r=0;n.resvDrain_post=0,n.resvDrain_pre=0,(s=t.ResvSize%8)!=0&&(r+=s),s=t.ResvSize-r-t.ResvMax,s>0&&(r+=s);{var o=Math.min(n.main_data_begin*8,r)/8;n.resvDrain_pre+=8*o,r-=8*o,t.ResvSize-=8*o,n.main_data_begin-=o}n.resvDrain_post+=r,t.ResvSize-=r}}function Wp(){var e="http://www.mp3dev.org/",t=3,a=98,s=4,n=0,r=93;this.getLameVersion=function(){return t+"."+a+"."+s},this.getLameShortVersion=function(){return t+"."+a+"."+s},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+a+"r"},this.getPsyVersion=function(){return n+"."+r},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var Qp=Ie.System,po=Ie.VbrMode,u1=Ie.ShortBlock,$p=Ie.Arrays,Yn=Ie.new_byte,Jp=Ie.assert;dn.NUMTOCENTRIES=100;dn.MAXFRAMESIZE=2880;function dn(){var e,t,a;this.setModules=function(v,y,w){e=v,t=y,a=w};var s=1,n=2,r=4,o=8,u=dn.NUMTOCENTRIES,b=dn.MAXFRAMESIZE,l=u+4+4+4+4+4,p=l+9+1+1+8+1+1+3+1+1+2+4+2+2,c=128,E=64,A=32,i=null,F="Xing",L="Info",B=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function f(v,y){if(v.nVbrNumFrames++,v.sum+=y,v.seen++,!(v.seen<v.want)&&(v.pos<v.size&&(v.bag[v.pos]=v.sum,v.pos++,v.seen=0),v.pos==v.size)){for(var w=1;w<v.size;w+=2)v.bag[w/2]=v.bag[w];v.want*=2,v.pos/=2}}function R(v,y){if(!(v.pos<=0))for(var w=1;w<u;++w){var j=w/u,K,P,z=0|Math.floor(j*v.pos);z>v.pos-1&&(z=v.pos-1),K=v.bag[z],P=v.sum;var d=0|256*K/P;d>255&&(d=255),y[w]=255&d}}this.addVbrFrame=function(v){var y=v.internal_flags,w=Tables.bitrate_table[v.version][y.bitrate_index];Jp(y.VBR_seek_table.bag!=null),f(y.VBR_seek_table,w)};function C(v,y){var w=v[y+0]&255;return w<<=8,w|=v[y+1]&255,w<<=8,w|=v[y+2]&255,w<<=8,w|=v[y+3]&255,w}function T(v,y,w){v[y+0]=255&(w>>24&255),v[y+1]=255&(w>>16&255),v[y+2]=255&(w>>8&255),v[y+3]=255&(w&255)}function N(v,y,w){v[y+0]=255&(w>>8&255),v[y+1]=255&(w&255)}function m(v,y){return new String(v,y,F.length(),i).equals(F)||new String(v,y,L.length(),i).equals(L)}function k(v,y,w){return 255&(v<<y|w&~(-1<<y))}function S(v,y){var w=v.internal_flags;y[0]=k(y[0],8,255),y[1]=k(y[1],3,7),y[1]=k(y[1],1,v.out_samplerate<16e3?0:1),y[1]=k(y[1],1,v.version),y[1]=k(y[1],2,4-3),y[1]=k(y[1],1,v.error_protection?0:1),y[2]=k(y[2],4,w.bitrate_index),y[2]=k(y[2],2,w.samplerate_index),y[2]=k(y[2],1,0),y[2]=k(y[2],1,v.extension),y[3]=k(y[3],2,v.mode.ordinal()),y[3]=k(y[3],2,w.mode_ext),y[3]=k(y[3],1,v.copyright),y[3]=k(y[3],1,v.original),y[3]=k(y[3],2,v.emphasis),y[0]=255;var j=255&(y[1]&241),K;v.version==1?K=c:v.out_samplerate<16e3?K=A:K=E,v.VBR==po.vbr_off&&(K=v.brate);var P;v.free_format?P=0:P=255&16*e.BitrateIndex(K,v.version,v.out_samplerate),v.version==1?(y[1]=255&(j|10),j=255&(y[2]&13),y[2]=255&(P|j)):(y[1]=255&(j|2),j=255&(y[2]&13),y[2]=255&(P|j))}this.getVbrTag=function(v){var y=new VBRTagData,w=0;y.flags=0;var j=v[w+1]>>3&1,K=v[w+2]>>2&3,P=v[w+3]>>6&3,z=v[w+2]>>4&15;if(z=Tables.bitrate_table[j][z],v[w+1]>>4==14?y.samprate=Tables.samplerate_table[2][K]:y.samprate=Tables.samplerate_table[j][K],j!=0?P!=3?w+=32+4:w+=17+4:P!=3?w+=17+4:w+=9+4,!m(v,w))return null;w+=4,y.hId=j;var d=y.flags=C(v,w);if(w+=4,d&s&&(y.frames=C(v,w),w+=4),d&n&&(y.bytes=C(v,w),w+=4),d&r){if(y.toc!=null)for(var M=0;M<u;M++)y.toc[M]=v[w+M];w+=u}y.vbrScale=-1,d&o&&(y.vbrScale=C(v,w),w+=4),y.headersize=(j+1)*72e3*z/y.samprate,w+=21;var W=v[w+0]<<4;W+=v[w+1]>>4;var $=(v[w+1]&15)<<8;return $+=v[w+2]&255,(W<0||W>3e3)&&(W=-1),($<0||$>3e3)&&($=-1),y.encDelay=W,y.encPadding=$,y},this.InitVbrTag=function(v){var y=v.internal_flags,w;v.version==1?w=c:v.out_samplerate<16e3?w=A:w=E,v.VBR==po.vbr_off&&(w=v.brate);var j=(v.version+1)*72e3*w/v.out_samplerate,K=y.sideinfo_len+p;if(y.VBR_seek_table.TotalFrameSize=j,j<K||j>b){v.bWriteVbrTag=!1;return}y.VBR_seek_table.nVbrNumFrames=0,y.VBR_seek_table.nBytesWritten=0,y.VBR_seek_table.sum=0,y.VBR_seek_table.seen=0,y.VBR_seek_table.want=1,y.VBR_seek_table.pos=0,y.VBR_seek_table.bag==null&&(y.VBR_seek_table.bag=new int[400],y.VBR_seek_table.size=400);var P=Yn(b);S(v,P);for(var z=y.VBR_seek_table.TotalFrameSize,d=0;d<z;++d)t.add_dummy_byte(v,P[d]&255,1)};function h(v,y){var w=y^v;return y=y>>8^B[w&255],y}this.updateMusicCRC=function(v,y,w,j){for(var K=0;K<j;++K)v[0]=h(y[w+K],v[0])};function g(v,y,w,j,K){var P=v.internal_flags,z=0,d=v.encoder_delay,M=v.encoder_padding,W=100-10*v.VBR_q-v.quality,$=a.getLameVeryShortVersion(),_e,Ae=0,Re,ge=[1,5,3,2,4,0,3],Ve=0|(v.lowpassfreq/100+.5>255?255:v.lowpassfreq/100+.5),Ne=0,he=0,Ke=0,it=v.internal_flags.noise_shaping,U=0,Y=0,te=0,de=0,me=0,Ee=(v.exp_nspsytune&1)!=0,xe=(v.exp_nspsytune&2)!=0,be=!1,ke=!1,pe=v.internal_flags.nogap_total,De=v.internal_flags.nogap_current,He=v.ATHtype,fe=0,ae;switch(v.VBR){case vbr_abr:ae=v.VBR_mean_bitrate_kbps;break;case vbr_off:ae=v.brate;break;default:ae=v.VBR_min_bitrate_kbps}switch(v.VBR.ordinal()<ge.length?_e=ge[v.VBR.ordinal()]:_e=0,Re=16*Ae+_e,P.findReplayGain&&(P.RadioGain>510&&(P.RadioGain=510),P.RadioGain<-510&&(P.RadioGain=-510),he=8192,he|=3072,P.RadioGain>=0?he|=P.RadioGain:(he|=512,he|=-P.RadioGain)),P.findPeakSample&&(Ne=Math.abs(0|P.PeakSample/32767*Math.pow(2,23)+.5)),pe!=-1&&(De>0&&(ke=!0),De<pe-1&&(be=!0)),fe=He+((Ee?1:0)<<4)+((xe?1:0)<<5)+((be?1:0)<<6)+((ke?1:0)<<7),W<0&&(W=0),v.mode){case MONO:U=0;break;case STEREO:U=1;break;case DUAL_CHANNEL:U=2;break;case JOINT_STEREO:v.force_ms?U=4:U=3;break;case NOT_SET:default:U=7;break}v.in_samplerate<=32e3?te=0:v.in_samplerate==48e3?te=2:v.in_samplerate>48e3?te=3:te=1,(v.short_blocks==u1.short_block_forced||v.short_blocks==u1.short_block_dispensed||v.lowpassfreq==-1&&v.highpassfreq==-1||v.scale_left<v.scale_right||v.scale_left>v.scale_right||v.disable_reservoir&&v.brate<320||v.noATH||v.ATHonly||He==0||v.in_samplerate<=32e3)&&(Y=1),de=it+(U<<2)+(Y<<5)+(te<<6),me=P.nMusicCRC,T(w,j+z,W),z+=4;for(var ve=0;ve<9;ve++)w[j+z+ve]=255&$.charAt(ve);z+=9,w[j+z]=255&Re,z++,w[j+z]=255&Ve,z++,T(w,j+z,Ne),z+=4,N(w,j+z,he),z+=2,N(w,j+z,Ke),z+=2,w[j+z]=255&fe,z++,ae>=255?w[j+z]=255:w[j+z]=255&ae,z++,w[j+z]=255&d>>4,w[j+z+1]=255&(d<<4)+(M>>8),w[j+z+2]=255&M,z+=3,w[j+z]=255&de,z++,w[j+z++]=0,N(w,j+z,v.preset),z+=2,T(w,j+z,y),z+=4,N(w,j+z,me),z+=2;for(var se=0;se<z;se++)K=h(w[j+se],K);return N(w,j+z,K),z+=2,z}function _(v){v.seek(0);var y=Yn(10);v.readFully(y);var w;return new String(y,"ISO-8859-1").startsWith("ID3")?w=0:w=((y[6]&127)<<21|(y[7]&127)<<14|(y[8]&127)<<7|y[9]&127)+y.length,w}this.getLameTagFrame=function(v,y){var w=v.internal_flags;if(!v.bWriteVbrTag||w.Class_ID!=Lame.LAME_ID||w.VBR_seek_table.pos<=0)return 0;if(y.length<w.VBR_seek_table.TotalFrameSize)return w.VBR_seek_table.TotalFrameSize;$p.fill(y,0,w.VBR_seek_table.TotalFrameSize,0),S(v,y);var j=Yn(u);if(v.free_format)for(var K=1;K<u;++K)j[K]=255&255*K/100;else R(w.VBR_seek_table,j);var P=w.sideinfo_len;v.error_protection&&(P-=2),v.VBR==po.vbr_off?(y[P++]=255&L.charAt(0),y[P++]=255&L.charAt(1),y[P++]=255&L.charAt(2),y[P++]=255&L.charAt(3)):(y[P++]=255&F.charAt(0),y[P++]=255&F.charAt(1),y[P++]=255&F.charAt(2),y[P++]=255&F.charAt(3)),T(y,P,s+n+r+o),P+=4,T(y,P,w.VBR_seek_table.nVbrNumFrames),P+=4;var z=w.VBR_seek_table.nBytesWritten+w.VBR_seek_table.TotalFrameSize;T(y,P,0|z),P+=4,Qp.arraycopy(j,0,y,P,j.length),P+=j.length,v.error_protection&&t.CRC_writeheader(w,y);for(var d=0,K=0;K<P;K++)d=h(y[K],d);return P+=g(v,z,y,P,d),w.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(v,y){var w=v.internal_flags;if(w.VBR_seek_table.pos<=0||(y.seek(y.length()),y.length()==0))return-1;var j=_(y);y.seek(j);var K=Yn(b),P=getLameTagFrame(v,K);return P>K.length?-1:(P<1||y.write(K,0,P),0)}}var d1=Ie.new_byte,eg=Ie.assert;function tg(){this.setModules=function(e,t){}}function ag(){this.setModules=function(e,t,a){}}function sg(){}function rg(){this.setModules=function(e,t){}}function ng(e,t,a){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,a=128);var s=new Qe,n=new tg,r=new jt,o=new Ea,u=new zp,b=new Gt,l=new Gp,p=new dn,c=new Wp,E=new rg,A=new Zp,i=new un,F=new ag,L=new sg;s.setModules(r,o,u,b,l,p,c,E,L),o.setModules(r,L,c,p),E.setModules(o,c),u.setModules(s),l.setModules(o,A,b,i),b.setModules(i,A,s.enc.psy),A.setModules(o),i.setModules(b),p.setModules(s,o,c),n.setModules(F,L),F.setModules(c,E,u);var B=s.lame_init();B.num_channels=e,B.in_samplerate=t,B.brate=a,B.mode=vt.STEREO,B.quality=3,B.bWriteVbrTag=!1,B.disable_reservoir=!0,B.write_id3tag_automatic=!1,s.lame_init_params(B);var f=1152,R=0|1.25*f+7200,C=d1(R);this.encodeBuffer=function(T,N){e==1&&(N=T),eg(T.length==N.length),T.length>f&&(f=T.length,R=0|1.25*f+7200,C=d1(R));var m=s.lame_encode_buffer(B,T,N,T.length,C,0,R);return new Int8Array(C.subarray(0,m))},this.flush=function(){var T=s.lame_encode_flush(B,C,0,R);return new Int8Array(C.subarray(0,T))}}function ji(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}ji("RIFF");ji("WAVE");ji("fmt ");ji("data");class ig{constructor(t){this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new ng(1,this.sampleRate,this.bitRate)}encode(t){const s=this._convertBuffer(t);let n=s.length;for(let r=0;n>=0;r+=1152){const o=s.subarray(r,r+1152),u=this.encoder.encodeBuffer(o);this.dataBuffer.push(new Int8Array(u)),n-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const t=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:t,url:URL.createObjectURL(t)}}_floatTo16BitPCM(t,a){for(let s=0;s<t.length;s++){const n=Math.max(-1,Math.min(1,t[s]));a[s]=n<0?n*32768:n*32767}}_convertBuffer(t){const a=new Float32Array(t),s=new Int16Array(t.length);return this._floatTo16BitPCM(a,s),s}}class og{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new ig(this.encoderOptions))}stop(){this.stream.getTracks().forEach(a=>a.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;t=this.lameEncoder.finish(),t.duration=this.duration,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,this.processor.onaudioprocess=a=>{const s=a.inputBuffer.getChannelData(0);let n=0;this.lameEncoder&&this.lameEncoder.encode(s);for(let r=0;r<s.length;++r)n+=s[r]*s[r];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(n/s.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}var m1=window.chrome,Ll=window.navigator,lg=Ll.vendor,cg=typeof window.opr<"u",ug=Ll.userAgent.indexOf("Edg")>-1,dg=Ll.userAgent.match("CriOS");function mg(){return dg?!0:m1!==null&&typeof m1<"u"&&lg==="Google Inc."&&cg===!1&&ug===!1}function f1(){var e=fg(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function fg(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const hg={name:"RoomFooter",components:{SvgIcon:zt,EmojiPickerContainer:Tu,RoomFiles:p3,RoomMessageReply:D3,RoomUsersTag:G3,RoomEmojis:J3,RoomTemplatesText:op},directives:{clickOutside:Bi},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new fu({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=f1();let t=!0;this.getTextareaRef().addEventListener("keyup",a=>{a.key==="Enter"&&!a.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!a.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){f1()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const t=mg()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+t,this.cursorRangePosition+t),this.cursorRangePosition=null}))},onChangeInput(){var e,t,a;((e=this.getTextareaRef())!=null&&e.value||((t=this.getTextareaRef())==null?void 0:t.value)==="")&&(this.message=(a=this.getTextareaRef())==null?void 0:a.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-t*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const a=(t=e.clipboardData)==null?void 0:t.items;a&&Array.from(a).forEach(s=>{if(s.type.includes("image")){const n=s.getAsFile();this.onFileChange([n])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:a}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(a,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:a}=this.getCharPosition("/"),s=this.message.substr(a,a).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+s+this.message.substr(a,this.message.length-1),this.cursorRangePosition=t+e.text.length+s.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async t=>{const a=URL.createObjectURL(t),s=t.name.lastIndexOf(".");this.files.push({loading:!0,name:t.name.substring(0,s),size:t.size,type:t.type,extension:t.name.substring(s+1),localUrl:a});const n=await fetch(a).then(o=>o.blob());let r=this.files.find(o=>o.localUrl===a);r&&(r.blob=n,r.loading=!1,delete r.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const t=this.recorder.records[0];this.files.push({blob:t.blob,name:`audio.${this.format}`,size:t.blob.size,duration:t.duration,type:t.blob.type,audio:!0,localUrl:URL.createObjectURL(t.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t||this.isFileLoading)return;this.selectedUsersTag.forEach(s=>{t=t.replace(`@${s.username}`,`<usertag>${s._id}</usertag>`)});const a=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(e=this.editedMessage.files)!=null&&e.length||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:a,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:a,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const a=t,s="<usertag>",n="</usertag>";[...t.matchAll(new RegExp(s,"gi"))].map(o=>o.index).forEach(o=>{const u=a.substring(o+s.length,a.indexOf(n,o)),b=this.room.users.find(l=>l._id===u);t=t.replace(`${s}${u}${n}`,`@${(b==null?void 0:b.username)||"unknown"}`),this.selectUserTag(b,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||e===":"&&!this.emojisSuggestionEnabled||e==="@"&&(!this.userTagsEnabled||!this.room.users)||e==="/"&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let a=t;for(;a>0&&this.message.charAt(a-1)!==e&&(this.message.charAt(a-1)!==" "||e!==":");)a--;const s=this.message.charAt(a-2),n=!s.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(a-1)===e&&(!s||s===" "||n)){const r=this.message.substring(a,t);e===":"?this.updateEmojis(r):e==="@"?this.updateShowUsersTag(r):e==="/"&&this.updateShowTemplatesText(r)}else this.resetFooterList(e)},updateShowUsersTag(e){this.filteredUsersTag=Po(this.room.users,"username",e,!0).filter(t=>t._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:a,endPosition:s}=this.getCharPosition("@"),n=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,a)+e.username+n+this.message.substr(s,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=a+e.username.length+n.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=Po(this.templatesText,"tag",e,!0)},getCharPosition(e){let a=this.getTextareaRef().selectionStart;for(;a>0&&this.message.charAt(a-1)!==e;)a--;const s=this.getTextareaRef().selectionEnd;return{position:a,endPosition:s}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(a=>a.unicode)},resetFooterList(e=null){e===":"?this.filteredEmojis=[]:e==="@"?this.filteredUsersTag=[]:e==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new og({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},vg={key:0,class:"vac-icon-textarea-left"},_g=Me("div",{class:"vac-dot-audio-record"},null,-1),pg={class:"vac-dot-audio-record-time"},gg=["placeholder"],bg={class:"vac-icon-textarea"},yg={key:1},wg=["accept"];function Sg(e,t,a,s,n,r){const o=Ge("room-emojis"),u=Ge("room-users-tag"),b=Ge("room-templates-text"),l=Ge("room-message-reply"),p=Ge("room-files"),c=Ge("svg-icon"),E=Ge("emoji-picker-container"),A=yi("click-outside");return ts((ee(),ue("div",{id:"room-footer",class:rt(["vac-room-footer",{"vac-app-box-shadow":r.shadowFooter}])},[Fe(o,{"filtered-emojis":n.filteredEmojis,"select-item":n.selectEmojiItem,"active-up-or-down":n.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=i=>r.selectEmoji(i)),onActivateItem:t[1]||(t[1]=i=>n.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Fe(u,{"filtered-users-tag":n.filteredUsersTag,"select-item":n.selectUsersTagItem,"active-up-or-down":n.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=i=>r.selectUserTag(i)),onActivateItem:t[3]||(t[3]=i=>n.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Fe(b,{"filtered-templates-text":n.filteredTemplatesText,"select-item":n.selectTemplatesTextItem,"active-up-or-down":n.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=i=>r.selectTemplateText(i)),onActivateItem:t[5]||(t[5]=i=>n.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Fe(l,{room:a.room,"message-reply":n.messageReply,"text-formatting":a.textFormatting,"link-options":a.linkOptions,onResetMessage:r.resetMessage},Mt({_:2},[at(e.$slots,(i,F)=>({name:F,fn:Ze(L=>[Le(e.$slots,F,St(bt(L)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Fe(p,{files:n.files,onRemoveFile:r.removeFile,onResetMessage:r.resetMessage},Mt({_:2},[at(e.$slots,(i,F)=>({name:F,fn:Ze(L=>[Le(e.$slots,F,St(bt(L)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),Me("div",{class:rt(["vac-box-footer",{"vac-box-footer-border":!n.files.length}])},[a.showAudio&&!n.files.length?(ee(),ue("div",vg,[n.isRecording?(ee(),ue(ft,{key:0},[Me("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...i)=>r.stopRecorder&&r.stopRecorder(...i))},[Le(e.$slots,"audio-stop-icon",{},()=>[Fe(c,{name:"close-outline"})])]),_g,Me("div",pg,$e(r.recordedTime),1),Me("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=i=>r.toggleRecorder(!1))},[Le(e.$slots,"audio-check-icon",{},()=>[Fe(c,{name:"checkmark"})])])],64)):(ee(),ue("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=i=>r.toggleRecorder(!0))},[Le(e.$slots,"microphone-icon",{},()=>[Fe(c,{name:"microphone",class:"vac-icon-microphone"})])]))])):Ce("",!0),Me("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:a.textMessages.TYPE_MESSAGE,class:rt(["vac-textarea",{"vac-textarea-outline":n.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...i)=>r.onChangeInput&&r.onChangeInput(...i)),onKeydown:[t[10]||(t[10]=Hs((...i)=>r.escapeTextarea&&r.escapeTextarea(...i),["esc"])),t[11]||(t[11]=Hs(Ya((...i)=>r.selectItem&&r.selectItem(...i),["exact","prevent"]),["enter"])),t[13]||(t[13]=Hs(Ya(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=Hs((...i)=>r.selectItem&&r.selectItem(...i),["tab"])),t[15]||(t[15]=Hs(i=>r.updateActiveUpOrDown(i,-1),["up"])),t[16]||(t[16]=Hs(i=>r.updateActiveUpOrDown(i,1),["down"]))],onPaste:t[12]||(t[12]=(...i)=>r.onPasteImage&&r.onPasteImage(...i))},null,42,gg),Me("div",bg,[n.editedMessage._id?(ee(),ue("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...i)=>r.resetMessage&&r.resetMessage(...i))},[Le(e.$slots,"edit-close-icon",{},()=>[Fe(c,{name:"close-outline"})])])):Ce("",!0),a.showEmojis?ts((ee(),ue("div",yg,[Le(e.$slots,"emoji-picker",hl({emojiOpened:n.emojiOpened},{addEmoji:r.addEmoji}),()=>[Fe(E,{"emoji-opened":n.emojiOpened,"position-top":!0,"emoji-data-source":a.emojiDataSource,onAddEmoji:r.addEmoji,onOpenEmoji:t[18]||(t[18]=i=>n.emojiOpened=i)},{"emoji-picker-icon":Ze(()=>[Le(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[A,()=>n.emojiOpened=!1]]):Ce("",!0),a.showFiles?(ee(),ue("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...i)=>r.launchFilePicker&&r.launchFilePicker(...i))},[Le(e.$slots,"paperclip-icon",{},()=>[Fe(c,{name:"paperclip"})])])):Ce("",!0),a.textareaActionEnabled?(ee(),ue("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...i)=>r.textareaActionHandler&&r.textareaActionHandler(...i))},[Le(e.$slots,"custom-action-icon",{},()=>[Fe(c,{name:"deleted"})])])):Ce("",!0),a.showFiles?(ee(),ue("input",{key:4,ref:"file",type:"file",multiple:"",accept:a.acceptedFiles,style:{display:"none"},onChange:t[21]||(t[21]=i=>r.onFileChange(i.target.files))},null,40,wg)):Ce("",!0),a.showSendIcon?(ee(),ue("div",{key:5,class:rt(["vac-svg-button",{"vac-send-disabled":r.isMessageEmpty}]),onClick:t[22]||(t[22]=(...i)=>r.sendMessage&&r.sendMessage(...i))},[Le(e.$slots,"send-icon",{},()=>[Fe(c,{name:"send",param:r.isMessageEmpty||r.isFileLoading?"disabled":""},null,8,["param"])])],2)):Ce("",!0)])],2)],2)),[[Mi,Object.keys(a.room).length&&a.showFooter]])}var Mg=Tt(hg,[["render",Sg]]);const Eg={name:"MessageReply",components:{AudioPlayer:Bl,SvgIcon:zt,FormatMessage:Sn},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(a=>a._id===e);return t?t.username:""},firstFile(){var e,t;return(t=(e=this.message.replyMessage)==null?void 0:e.files)!=null&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return Li(this.firstFile)},isImage(){return _r(this.firstFile)},isVideo(){return Mn(this.firstFile)},isOtherFile(){var e;return((e=this.message.replyMessage.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Ag={class:"vac-reply-message"},kg={class:"vac-reply-username"},Tg={key:0,class:"vac-image-reply-container"},Rg={key:1,class:"vac-video-reply-container"},xg={controls:""},Og=["src"],Ig={key:3,class:"vac-file-container"},Cg={class:"vac-text-ellipsis"},Bg={key:0,class:"vac-text-ellipsis vac-text-extension"},Lg={class:"vac-reply-content"};function Ng(e,t,a,s,n,r){const o=Ge("audio-player"),u=Ge("svg-icon"),b=Ge("format-message");return ee(),ue("div",Ag,[Me("div",kg,$e(r.replyUsername),1),r.isImage?(ee(),ue("div",Tg,[Me("div",{class:"vac-message-image vac-message-image-reply",style:Ot({"background-image":`url('${r.firstFile.url}')`})},null,4)])):r.isVideo?(ee(),ue("div",Rg,[Me("video",xg,[Me("source",{src:r.firstFile.url},null,8,Og)])])):r.isAudio?(ee(),gt(o,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=l=>e.progressTime=l),onHoverAudioProgress:t[1]||(t[1]=l=>e.hoverAudioProgress=l)},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["src"])):r.isOtherFile?(ee(),ue("div",Ig,[Me("div",null,[Le(e.$slots,"file-icon",{},()=>[Fe(u,{name:"file"})])]),Me("div",Cg,$e(r.firstFile.name),1),r.firstFile.extension?(ee(),ue("div",Bg,$e(r.firstFile.extension),1)):Ce("",!0)])):Ce("",!0),Me("div",Lg,[Fe(b,{"message-id":a.message.replyMessage._id,content:a.message.replyMessage.content,users:a.roomUsers,"text-formatting":a.textFormatting,"link-options":a.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var jg=Tt(Eg,[["render",Ng]]);const Fg={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){return{radius:35,stroke:4,normalizedRadius:27,circumference:54*Math.PI}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Hg={ref:"progress",class:"vac-progress-wrapper"},Pg=["height","width"],Ug=["stroke-dasharray","stroke-width","r","cx","cy"],Dg={class:"vac-progress-text"},Vg=Me("span",{class:"vac-progress-pourcent"},"%",-1);function qg(e,t,a,s,n,r){return ee(),gt(Ht,{name:"vac-fade-spinner",appear:""},{default:Ze(()=>[Me("div",Hg,[(ee(),ue("svg",{height:n.radius*2,width:n.radius*2},[Me("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":n.circumference+" "+n.circumference,style:Ot({strokeDashoffset:r.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":n.stroke,fill:"transparent",r:n.normalizedRadius,cx:n.radius,cy:n.radius},null,12,Ug)],8,Pg)),Me("div",{class:"vac-progress-content",style:Ot({height:n.radius*2-19+"px",width:n.radius*2-19+"px"})},[Me("div",Dg,[Ss($e(a.progress),1),Vg])],4)],512)]),_:1})}var Hu=Tt(Fg,[["render",qg]]);const zg={name:"MessageFile",components:{SvgIcon:zt,Loader:Ei,ProgressBar:Hu},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1||this.imageLoading},isImage(){return _r(this.file)},isVideo(){return Mn(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!_r(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},Yg={class:"vac-message-file-container"},Xg={key:0,class:"vac-image-buttons"},Kg={controls:""},Gg=["src"];function Zg(e,t,a,s,n,r){const o=Ge("progress-bar"),u=Ge("loader"),b=Ge("svg-icon");return ee(),ue("div",Yg,[r.isImage?(ee(),ue("div",{key:0,ref:"imageRef"+a.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=l=>n.imageHover=!0),onMouseleave:t[3]||(t[3]=l=>n.imageHover=!1),onClick:t[4]||(t[4]=l=>r.openFile(l,"preview"))},[a.file.progress>=0?(ee(),gt(o,{key:0,progress:a.file.progress,style:Ot({top:`${n.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(ee(),gt(u,{key:1,show:r.isImageLoading,type:"message-file","message-id":a.message._id,style:Ot({top:`${n.imageResponsive.loaderTop}px`})},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["show","message-id","style"])),Me("div",{class:rt(["vac-message-image",{"vac-blur-loading":r.isImageLoading&&a.message.senderId===a.currentUserId}]),style:Ot({"background-image":`url('${r.isImageLoading&&a.file.preview||a.file.url}')`,"max-height":`${n.imageResponsive.maxHeight}px`})},[Fe(Ht,{name:"vac-fade-image"},{default:Ze(()=>[!a.messageSelectionEnabled&&n.imageHover&&!r.isImageLoading?(ee(),ue("div",Xg,[Me("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=l=>r.openFile(l,"preview"))},[Le(e.$slots,"eye-icon_"+a.message._id,{},()=>[Fe(b,{name:"eye"})])]),Me("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=l=>r.openFile(l,"download"))},[Le(e.$slots,"document-icon_"+a.message._id,{},()=>[Fe(b,{name:"document"})])])])):Ce("",!0)]),_:3})],6)],544)):r.isVideo?(ee(),ue("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Ya(l=>r.openFile(l,"preview"),["prevent"]))},[a.file.progress>=0?(ee(),gt(o,{key:0,progress:a.file.progress},null,8,["progress"])):Ce("",!0),Me("video",Kg,[Me("source",{src:a.file.url},null,8,Gg)])])):Ce("",!0)])}var Wg=Tt(zg,[["render",Zg]]);const Qg={name:"MessageFiles",components:{SvgIcon:zt,FormatMessage:Sn,ProgressBar:Hu,MessageFile:Wg},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>Rc(e))},otherFiles(){return this.message.files.filter(e=>!Rc(e))}},methods:{openFile(e,t,a){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:a}))}}},$g={class:"vac-message-files-container"},Jg=["onClick"],e4={class:"vac-svg-button"},t4={class:"vac-text-ellipsis"},a4={key:0,class:"vac-text-ellipsis vac-text-extension"};function s4(e,t,a,s,n,r){const o=Ge("message-file"),u=Ge("progress-bar"),b=Ge("svg-icon"),l=Ge("format-message");return ee(),ue("div",$g,[(ee(!0),ue(ft,null,at(r.imageVideoFiles,(p,c)=>(ee(),ue("div",{key:c+"iv"},[Fe(o,{file:p,"current-user-id":a.currentUserId,message:a.message,index:c,"message-selection-enabled":a.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=E=>e.$emit("open-file",E))},Mt({_:2},[at(e.$slots,(E,A)=>({name:A,fn:Ze(i=>[Le(e.$slots,A,St(bt(i)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(ee(!0),ue(ft,null,at(r.otherFiles,(p,c)=>(ee(),ue("div",{key:c+"a",class:"vac-file-wrapper"},[p.progress>=0?(ee(),gt(u,{key:0,progress:p.progress,style:{top:"44px"}},null,8,["progress"])):Ce("",!0),Me("div",{class:rt(["vac-file-container",{"vac-file-container-progress":p.progress>=0}]),onClick:E=>r.openFile(E,p,"download")},[Me("div",e4,[Le(e.$slots,"document-icon",{},()=>[Fe(b,{name:"document"})])]),Me("div",t4,$e(p.name),1),p.extension?(ee(),ue("div",a4,$e(p.extension),1)):Ce("",!0)],10,Jg)]))),128)),Fe(l,{"message-id":a.message._id,content:a.message.content,users:a.roomUsers,"text-formatting":a.textFormatting,"link-options":a.linkOptions,onOpenUserTag:t[1]||(t[1]=p=>e.$emit("open-user-tag",p))},null,8,["message-id","content","users","text-formatting","link-options"])])}var r4=Tt(Qg,[["render",s4]]);const n4={name:"MessageActions",components:{SvgIcon:zt,EmojiPickerContainer:Tu},directives:{clickOutside:Bi},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=ku(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,a=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-a>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},i4={class:"vac-message-actions-wrapper"},o4={key:"3"},l4={class:"vac-menu-list"},c4=["onClick"];function u4(e,t,a,s,n,r){const o=Ge("svg-icon"),u=Ge("emoji-picker-container"),b=yi("click-outside");return ee(),ue("div",i4,[Me("div",{class:"vac-options-container",style:Ot({display:a.hoverAudioProgress?"none":"initial",width:r.filteredMessageActions.length&&a.showReactionEmojis?"70px":"45px"})},[Fe(pl,{name:"vac-slide-left",tag:"span"},{default:Ze(()=>[r.isMessageActions||r.isMessageReactions?(ee(),ue("div",{key:"1",class:rt(["vac-blur-container",{"vac-options-me":a.message.senderId===a.currentUserId}])},null,2)):Ce("",!0),r.isMessageActions?(ee(),ue("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...l)=>r.openOptions&&r.openOptions(...l))},[Le(e.$slots,"dropdown-icon_"+a.message._id,{},()=>[Fe(o,{name:"dropdown",param:"message"})])],512)):Ce("",!0),r.isMessageReactions?ts((ee(),ue("div",o4,[Le(e.$slots,"emoji-picker",hl({emojiOpened:n.emojiOpened},{addEmoji:r.sendMessageReaction}),()=>[Fe(u,{class:"vac-message-emojis",style:Ot({right:r.isMessageActions?"30px":"5px"}),"emoji-opened":n.emojiOpened,"emoji-reaction":!0,"position-right":a.message.senderId===a.currentUserId,"message-id":a.message._id,"emoji-data-source":a.emojiDataSource,onAddEmoji:r.sendMessageReaction,onOpenEmoji:r.openEmoji},Mt({_:2},[at(e.$slots,(l,p)=>({name:p,fn:Ze(c=>[Le(e.$slots,p,St(bt(c)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[b,r.closeEmoji]]):Ce("",!0)]),_:3})],4),r.filteredMessageActions.length?(ee(),gt(Ht,{key:0,name:a.message.senderId===a.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Ze(()=>[n.optionsOpened?ts((ee(),ue("div",{key:0,ref:"menuOptions",class:rt(["vac-menu-options",{"vac-menu-left":a.message.senderId!==a.currentUserId}]),style:Ot({top:`${n.menuOptionsTop}px`})},[Me("div",l4,[(ee(!0),ue(ft,null,at(r.filteredMessageActions,l=>(ee(),ue("div",{key:l.name},[Me("div",{class:"vac-menu-item",onClick:p=>r.messageActionHandler(l)},$e(l.title),9,c4)]))),128))])],6)),[[b,r.closeOptions]]):Ce("",!0)]),_:1},8,["name"])):Ce("",!0)])}var d4=Tt(n4,[["render",u4]]);const m4={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},f4=["onClick"];function h4(e,t,a,s,n,r){return a.message.deleted?Ce("",!0):(ee(),gt(pl,{key:0,name:"vac-slide-left",tag:"span"},{default:Ze(()=>[(ee(!0),ue(ft,null,at(a.message.reactions,(o,u)=>ts((ee(),ue("button",{key:u+0,class:rt(["vac-button-reaction",{"vac-reaction-me":o.indexOf(a.currentUserId)!==-1}]),style:Ot({float:a.message.senderId===a.currentUserId?"right":"left"}),onClick:b=>r.sendMessageReaction({unicode:u},o)},[Ss($e(u),1),Me("span",null,$e(o.length),1)],14,f4)),[[Mi,o.length]])),128))]),_:1}))}var v4=Tt(m4,[["render",h4]]);function _4(e){if(!((s,n)=>n.every(r=>{let o=!1;return(r.type[0]==="array"&&Array.isArray(s[r.key])||r.type.find(u=>u===typeof s[r.key]))&&(o=!0),o&&Nl(s,r.key)}))(e,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function p4(e){if(!((s,n)=>n.every(r=>r.type.find(u=>u===typeof s[r.key])&&Nl(s,r.key)))(e,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function g4(e){if(!((s,n)=>n.every(r=>r.type.find(u=>u===typeof s[r.key])&&Nl(s,r.key)))(e,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function Nl(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&e[t]!==void 0}const b4={name:"RoomMessage",components:{SvgIcon:zt,FormatMessage:Sn,AudioPlayer:Bl,MessageReply:jg,MessageFiles:r4,MessageActions:d4,MessageReactions:v4},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return(e=this.message.files)==null?void 0:e.some(t=>Li(t))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){if(!e.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=e.reduce((t,a)=>a.index<t.index?a:t)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){g4(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&t.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},y4=["id"],w4={key:0,class:"vac-card-info vac-card-date"},S4={key:1,class:"vac-line-new"},M4={key:2,class:"vac-card-info vac-card-system"},E4={key:1,class:"vac-avatar-offset"},A4={key:0,class:"vac-progress-time"},k4={class:"vac-text-timestamp"},T4={key:0,class:"vac-icon-edited"},R4={key:1},x4=Me("div",{class:"vac-failure-text"},"!",-1),O4=[x4],I4={key:3,class:"vac-avatar-current-offset"};function C4(e,t,a,s,n,r){const o=Ge("format-message"),u=Ge("message-reply"),b=Ge("message-files"),l=Ge("audio-player"),p=Ge("svg-icon"),c=Ge("message-actions"),E=Ge("message-reactions");return ee(),ue("div",{id:a.message._id,ref:"message",class:"vac-message-wrapper"},[r.showDate?(ee(),ue("div",w4,$e(a.message.date),1)):Ce("",!0),n.newMessage._id===a.message._id?(ee(),ue("div",S4,$e(a.textMessages.NEW_MESSAGES),1)):Ce("",!0),a.message.system?(ee(),ue("div",M4,[Le(e.$slots,"message_"+a.message._id,{},()=>[Fe(o,{"message-id":a.message._id,content:a.message.content,deleted:!!a.message.deleted,users:a.roomUsers,"text-messages":a.textMessages,"text-formatting":a.textFormatting,"link-options":a.linkOptions,onOpenUserTag:r.openUserTag},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(ee(),ue("div",{key:3,class:rt(["vac-message-box",{"vac-offset-current":a.message.senderId===a.currentUserId}]),onClick:t[8]||(t[8]=(...A)=>r.selectMessage&&r.selectMessage(...A))},[Le(e.$slots,"message_"+a.message._id,{},()=>[a.message.senderId!==a.currentUserId?Le(e.$slots,"message-avatar_"+a.message._id,{key:0},()=>[a.message.avatar?(ee(),ue("div",{key:0,class:"vac-avatar",style:Ot({"background-image":`url('${a.message.avatar}')`})},null,4)):Ce("",!0)]):Ce("",!0),r.hasSenderUserAvatar&&!a.message.avatar?(ee(),ue("div",E4)):Ce("",!0),Me("div",{class:rt(["vac-message-container",{"vac-message-container-offset":r.messageOffset}])},[Me("div",{class:rt(["vac-message-card",{"vac-message-highlight":r.isMessageHover,"vac-message-current":a.message.senderId===a.currentUserId,"vac-message-deleted":a.message.deleted,"vac-item-clickable":a.messageSelectionEnabled,"vac-message-selected":r.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...A)=>r.onHoverMessage&&r.onHoverMessage(...A)),onMouseleave:t[6]||(t[6]=(...A)=>r.onLeaveMessage&&r.onLeaveMessage(...A))},[r.showUsername?(ee(),ue("div",{key:0,class:rt(["vac-text-username",{"vac-username-reply":!a.message.deleted&&a.message.replyMessage}])},[Me("span",null,$e(a.message.username),1)],2)):Ce("",!0),!a.message.deleted&&a.message.replyMessage?(ee(),gt(u,{key:1,message:a.message,"room-users":a.roomUsers,"text-formatting":a.textFormatting,"link-options":a.linkOptions},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Ce("",!0),a.message.deleted||!a.message.files||!a.message.files.length?(ee(),gt(o,{key:2,"message-id":a.message._id,content:a.message.content,deleted:!!a.message.deleted,users:a.roomUsers,"text-formatting":a.textFormatting,"text-messages":a.textMessages,"link-options":a.linkOptions,onOpenUserTag:r.openUserTag},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!r.isAudio||a.message.files.length>1?(ee(),gt(b,{key:3,"current-user-id":a.currentUserId,message:a.message,"room-users":a.roomUsers,"text-formatting":a.textFormatting,"link-options":a.linkOptions,"message-selection-enabled":a.messageSelectionEnabled,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(ee(),ue(ft,{key:4},[Fe(l,{"message-id":a.message._id,src:a.message.files[0].url,"message-selection-enabled":a.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=A=>n.progressTime=A),onHoverAudioProgress:t[1]||(t[1]=A=>n.hoverAudioProgress=A)},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["message-id","src","message-selection-enabled"]),a.message.deleted?Ce("",!0):(ee(),ue("div",A4,$e(n.progressTime),1))],64)),Me("div",k4,[a.message.edited&&!a.message.deleted?(ee(),ue("div",T4,[Le(e.$slots,"pencil-icon_"+a.message._id,{},()=>[Fe(p,{name:"pencil"})])])):Ce("",!0),Me("span",null,$e(a.message.timestamp),1),r.isCheckmarkVisible?(ee(),ue("span",R4,[Le(e.$slots,"checkmark-icon_"+a.message._id,{},()=>[Fe(p,{name:a.message.distributed?"double-checkmark":"checkmark",param:a.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ce("",!0)]),Fe(c,{"current-user-id":a.currentUserId,message:a.message,"message-actions":a.messageActions,"show-reaction-emojis":a.showReactionEmojis,"message-hover":n.messageHover,"hover-message-id":n.hoverMessageId,"hover-audio-progress":n.hoverAudioProgress,"emoji-data-source":a.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=A=>n.messageHover=A),onUpdateOptionsOpened:t[3]||(t[3]=A=>n.optionsOpened=A),onUpdateEmojiOpened:t[4]||(t[4]=A=>n.emojiOpened=A),onMessageActionHandler:r.messageActionHandler,onSendMessageReaction:r.sendMessageReaction},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Fe(E,{"current-user-id":a.currentUserId,message:a.message,onSendMessageReaction:r.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Le(e.$slots,"message-failure_"+a.message._id,{},()=>[a.message.failure&&a.message.senderId===a.currentUserId?(ee(),ue("div",{key:0,class:rt(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":a.message.avatar&&a.message.senderId===a.currentUserId}]),onClick:t[7]||(t[7]=A=>e.$emit("open-failed-message",{message:a.message}))},O4,2)):Ce("",!0)]),a.message.senderId===a.currentUserId?Le(e.$slots,"message-avatar_"+a.message._id,{key:2},()=>[a.message.avatar?(ee(),ue("div",{key:0,class:"vac-avatar vac-avatar-current",style:Ot({"background-image":`url('${a.message.avatar}')`})},null,4)):Ce("",!0)]):Ce("",!0),r.hasCurrentUserAvatar&&!a.message.avatar?(ee(),ue("div",I4)):Ce("",!0)])],2))],8,y4)}var B4=Tt(b4,[["render",C4]]);const L4={name:"ChatRoom",components:{Loader:Ei,SvgIcon:zt,RoomHeader:kv,RoomFooter:Mg,RoomMessage:B4},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((a,s)=>{this.showNewMessagesDivider&&!a.seen&&a.senderId!==this.currentUserId&&this.newMessages.push({_id:a._id,index:s})}),(t==null?void 0:t.length)===(e==null?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(a=>{a[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,a=new ResizeObserver(n=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),a.disconnect())});for(var s=0;s<e.children.length;s++)a.observe(e.children[s])},touchStart(e){if(!this.singleRoom&&e.changedTouches.length===1){const t=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY;addEventListener("touchend",s=>this.touchEnd(s,t,a),{once:!0})}},touchEnd(e,t,a){if(e.changedTouches.length===1){const s=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,r=s-t>100,o=Math.abs(n-a)>50;r&&!o&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const a=this.$refs.scrollContainer;a&&(e(),setTimeout(()=>{a.scrollTo({top:a.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:a}){if(t!==this.messages.length-1)return;const s=a.offsetHeight+60;setTimeout(()=>{const n=this.getBottomScroll(this.$refs.scrollContainer)>s;e.senderId===this.currentUserId?n?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():n?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":this.initReplyMessage=t,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=t,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":this.selectedMessages=[t],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:a,scrollTop:s}=e;return t-a-s},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth"))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},N4={class:"vac-container-center vac-room-empty"},j4={class:"vac-messages-container"},F4={key:0,class:"vac-text-started"},H4={key:1,class:"vac-text-started"},P4={key:0,id:"infinite-loader-messages"},U4={key:2},D4={key:0,class:"vac-badge-counter vac-messages-count"};function V4(e,t,a,s,n,r){const o=Ge("room-header"),u=Ge("loader"),b=Ge("room-message"),l=Ge("svg-icon"),p=Ge("room-footer");return ts((ee(),ue("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Ya((...c)=>r.onDropFiles&&r.onDropFiles(...c),["prevent"])),onDragenter:t[13]||(t[13]=Ya(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Ya(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Ya(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...c)=>r.touchStart&&r.touchStart(...c))},[r.showNoRoom?Le(e.$slots,"no-room-selected",{key:0},()=>[Me("div",N4,[Me("div",null,$e(a.textMessages.ROOM_EMPTY),1)])]):(ee(),gt(o,{key:1,"current-user-id":a.currentUserId,"text-messages":a.textMessages,"single-room":a.singleRoom,"show-rooms-list":a.showRoomsList,"is-mobile":a.isMobile,"room-info-enabled":a.roomInfoEnabled,"menu-actions":a.menuActions,room:r.room,"message-selection-enabled":n.messageSelectionEnabled,"message-selection-actions":a.messageSelectionActions,"selected-messages-total":n.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=c=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=c=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=c=>e.$emit("menu-action-handler",c)),onMessageSelectionActionHandler:r.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=c=>n.messageSelectionEnabled=!1)},Mt({_:2},[at(e.$slots,(c,E)=>({name:E,fn:Ze(A=>[Le(e.$slots,E,St(bt(A)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Me("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...c)=>r.onContainerScroll&&r.onContainerScroll(...c))},[Fe(u,{show:n.loadingMessages,type:"messages"},Mt({_:2},[at(e.$slots,(c,E)=>({name:E,fn:Ze(A=>[Le(e.$slots,E,St(bt(A)))])}))]),1032,["show"]),Me("div",j4,[Me("div",{class:rt({"vac-messages-hidden":n.loadingMessages})},[Fe(Ht,{name:"vac-fade-message"},{default:Ze(()=>[Me("div",null,[r.showNoMessages?(ee(),ue("div",F4,[Le(e.$slots,"messages-empty",{},()=>[Ss($e(a.textMessages.MESSAGES_EMPTY),1)])])):Ce("",!0),r.showMessagesStarted?(ee(),ue("div",H4,$e(a.textMessages.CONVERSATION_STARTED)+" "+$e(a.messages[0].date),1)):Ce("",!0)])]),_:3}),a.messages.length&&!a.messagesLoaded?(ee(),ue("div",P4,[Fe(u,{show:!0,infinite:!0,type:"infinite-messages"},Mt({_:2},[at(e.$slots,(c,E)=>({name:E,fn:Ze(A=>[Le(e.$slots,E,St(bt(A)))])}))]),1024)])):Ce("",!0),(ee(),gt(pl,{key:a.roomId,name:"vac-fade-message",tag:"span"},{default:Ze(()=>[(ee(!0),ue(ft,null,at(a.messages,(c,E)=>(ee(),ue("div",{key:c.indexId||c._id},[Fe(b,{"current-user-id":a.currentUserId,message:c,index:E,messages:a.messages,"edited-message-id":n.editedMessageId,"message-actions":a.messageActions,"room-users":r.room.users,"text-messages":a.textMessages,"new-messages":n.newMessages,"show-reaction-emojis":a.showReactionEmojis,"show-new-messages-divider":a.showNewMessagesDivider,"text-formatting":a.textFormatting,"link-options":a.linkOptions,"username-options":a.usernameOptions,"message-selection-enabled":n.messageSelectionEnabled,"selected-messages":n.selectedMessages,"emoji-data-source":a.emojiDataSource,onMessageAdded:r.onMessageAdded,onMessageActionHandler:r.messageActionHandler,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:t[4]||(t[4]=A=>e.$emit("open-failed-message",A)),onSendMessageReaction:r.sendMessageReaction,onSelectMessage:r.selectMessage,onUnselectMessage:r.unselectMessage},Mt({_:2},[at(e.$slots,(A,i)=>({name:i,fn:Ze(F=>[Le(e.$slots,i,St(bt(F)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),n.loadingMessages?Ce("",!0):(ee(),ue("div",U4,[Fe(Ht,{name:"vac-bounce"},{default:Ze(()=>[n.scrollIcon?(ee(),ue("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...c)=>r.scrollToBottom&&r.scrollToBottom(...c))},[Fe(Ht,{name:"vac-bounce"},{default:Ze(()=>[n.scrollMessagesCount?(ee(),ue("div",D4,$e(n.scrollMessagesCount),1)):Ce("",!0)]),_:1}),Le(e.$slots,"scroll-icon",{},()=>[Fe(l,{name:"dropdown",param:"scroll"})])])):Ce("",!0)]),_:3})])),Fe(p,{room:r.room,"room-id":a.roomId,"room-message":a.roomMessage,"text-messages":a.textMessages,"show-send-icon":a.showSendIcon,"show-files":a.showFiles,"show-audio":a.showAudio,"show-emojis":a.showEmojis,"show-footer":a.showFooter,"accepted-files":a.acceptedFiles,"textarea-action-enabled":a.textareaActionEnabled,"textarea-auto-focus":a.textareaAutoFocus,"user-tags-enabled":a.userTagsEnabled,"emojis-suggestion-enabled":a.emojisSuggestionEnabled,"templates-text":a.templatesText,"text-formatting":a.textFormatting,"link-options":a.linkOptions,"audio-bit-rate":a.audioBitRate,"audio-sample-rate":a.audioSampleRate,"init-reply-message":n.initReplyMessage,"init-edit-message":n.initEditMessage,"dropped-files":n.droppedFiles,"emoji-data-source":a.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=c=>n.editedMessageId=c),onEditMessage:t[8]||(t[8]=c=>e.$emit("edit-message",c)),onSendMessage:t[9]||(t[9]=c=>e.$emit("send-message",c)),onTypingMessage:t[10]||(t[10]=c=>e.$emit("typing-message",c)),onTextareaActionHandler:t[11]||(t[11]=c=>e.$emit("textarea-action-handler",c))},Mt({_:2},[at(e.$slots,(c,E)=>({name:E,fn:Ze(A=>[Le(e.$slots,E,St(bt(A)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Mi,a.isMobile&&!a.showRoomsList||!a.isMobile||a.singleRoom]])}var q4=Tt(L4,[["render",V4]]);const z4={name:"MediaPreview",components:{SvgIcon:zt},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return _r(this.file)},isVideo(){return Mn(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},Y4={key:0,class:"vac-media-preview-container"},X4={key:1,class:"vac-media-preview-container"},K4={controls:"",autoplay:""},G4=["src"],Z4={class:"vac-svg-button"};function W4(e,t,a,s,n,r){const o=Ge("svg-icon");return ee(),ue("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Ya((...u)=>r.closeModal&&r.closeModal(...u),["stop"])),onKeydown:t[1]||(t[1]=Hs((...u)=>r.closeModal&&r.closeModal(...u),["esc"]))},[Fe(Ht,{name:"vac-bounce-preview",appear:""},{default:Ze(()=>[r.isImage?(ee(),ue("div",Y4,[Me("div",{class:"vac-image-preview",style:Ot({"background-image":`url('${a.file.url}')`})},null,4)])):r.isVideo?(ee(),ue("div",X4,[Me("video",K4,[Me("source",{src:a.file.url},null,8,G4)])])):Ce("",!0)]),_:1}),Me("div",Z4,[Le(e.$slots,"preview-close-icon",{},()=>[Fe(o,{name:"close-outline",param:"preview"})])])],544)}var Q4=Tt(z4,[["render",W4]]),$4={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const J4={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},e5=({general:e,container:t,header:a,footer:s,sidemenu:n,content:r,dropdown:o,message:u,markdown:b,room:l,emoji:p,icons:c})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":a.background,"--chat-header-color-name":a.colorRoomName,"--chat-header-color-info":a.colorRoomInfo,"--chat-footer-bg-color":s.background,"--chat-border-style-input":s.borderStyleInput,"--chat-border-color-input-selected":s.borderInputSelected,"--chat-footer-bg-color-reply":s.backgroundReply,"--chat-footer-bg-color-tag-active":s.backgroundTagActive,"--chat-footer-bg-color-tag":s.backgroundTag,"--chat-content-bg-color":r.background,"--chat-sidemenu-bg-color":n.background,"--chat-sidemenu-bg-color-hover":n.backgroundHover,"--chat-sidemenu-bg-color-active":n.backgroundActive,"--chat-sidemenu-color-active":n.colorActive,"--chat-sidemenu-border-color-search":n.borderColorSearch,"--chat-dropdown-bg-color":o.background,"--chat-dropdown-bg-color-hover":o.backgroundHover,"--chat-message-bg-color":u.background,"--chat-message-bg-color-me":u.backgroundMe,"--chat-message-color-started":u.colorStarted,"--chat-message-bg-color-deleted":u.backgroundDeleted,"--chat-message-bg-color-selected":u.backgroundSelected,"--chat-message-color-deleted":u.colorDeleted,"--chat-message-color-username":u.colorUsername,"--chat-message-color-timestamp":u.colorTimestamp,"--chat-message-bg-color-date":u.backgroundDate,"--chat-message-color-date":u.colorDate,"--chat-message-bg-color-system":u.backgroundSystem,"--chat-message-color-system":u.colorSystem,"--chat-message-color":u.color,"--chat-message-bg-color-media":u.backgroundMedia,"--chat-message-bg-color-reply":u.backgroundReply,"--chat-message-color-reply-username":u.colorReplyUsername,"--chat-message-color-reply-content":u.colorReply,"--chat-message-color-tag":u.colorTag,"--chat-message-bg-color-image":u.backgroundImage,"--chat-message-color-new-messages":u.colorNewMessages,"--chat-message-bg-color-scroll-counter":u.backgroundScrollCounter,"--chat-message-color-scroll-counter":u.colorScrollCounter,"--chat-message-bg-color-reaction":u.backgroundReaction,"--chat-message-border-style-reaction":u.borderStyleReaction,"--chat-message-bg-color-reaction-hover":u.backgroundReactionHover,"--chat-message-border-style-reaction-hover":u.borderStyleReactionHover,"--chat-message-color-reaction-counter":u.colorReactionCounter,"--chat-message-bg-color-reaction-me":u.backgroundReactionMe,"--chat-message-border-style-reaction-me":u.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":u.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":u.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":u.colorReactionCounterMe,"--chat-message-bg-color-audio-record":u.backgroundAudioRecord,"--chat-message-bg-color-audio-line":u.backgroundAudioLine,"--chat-message-bg-color-audio-progress":u.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":u.backgroundAudioProgressSelector,"--chat-message-color-file-extension":u.colorFileExtension,"--chat-markdown-bg":b.background,"--chat-markdown-border":b.border,"--chat-markdown-color":b.color,"--chat-markdown-color-multi":b.colorMulti,"--chat-room-color-username":l.colorUsername,"--chat-room-color-message":l.colorMessage,"--chat-room-color-timestamp":l.colorTimestamp,"--chat-room-color-online":l.colorStateOnline,"--chat-room-color-offline":l.colorStateOffline,"--chat-room-bg-color-badge":l.backgroundCounterBadge,"--chat-room-color-badge":l.colorCounterBadge,"--chat-emoji-bg-color":p.background,"--chat-icon-color-search":c.search,"--chat-icon-color-add":c.add,"--chat-icon-color-toggle":c.toggle,"--chat-icon-color-menu":c.menu,"--chat-icon-color-close":c.close,"--chat-icon-color-close-image":c.closeImage,"--chat-icon-color-file":c.file,"--chat-icon-color-paperclip":c.paperclip,"--chat-icon-color-close-outline":c.closeOutline,"--chat-icon-color-close-preview":c.closePreview,"--chat-icon-color-send":c.send,"--chat-icon-color-send-disabled":c.sendDisabled,"--chat-icon-color-emoji":c.emoji,"--chat-icon-color-emoji-reaction":c.emojiReaction,"--chat-icon-color-document":c.document,"--chat-icon-color-pencil":c.pencil,"--chat-icon-color-checkmark":c.checkmark,"--chat-icon-color-checkmark-seen":c.checkmarkSeen,"--chat-icon-color-eye":c.eye,"--chat-icon-color-dropdown-message":c.dropdownMessage,"--chat-icon-bg-dropdown-message":c.dropdownMessageBackground,"--chat-icon-color-dropdown-room":c.dropdownRoom,"--chat-icon-color-dropdown-scroll":c.dropdownScroll,"--chat-icon-color-microphone":c.microphone,"--chat-icon-color-audio-play":c.audioPlay,"--chat-icon-color-audio-pause":c.audioPause,"--chat-icon-color-audio-cancel":c.audioCancel,"--chat-icon-color-audio-confirm":c.audioConfirm});var t5=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const a5={name:"ChatContainer",components:{RoomsList:uv,Room:q4,MediaPreview:Q4},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"°",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...$4,...this.textMessagesCasted}},cssVars(){const e=J4[this.theme],t={};return Object.keys(e).map(a=>{t[a]={...e[a],...this.stylesCasted[a]||{}}}),e5(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const a=e.index||0,s=t.index||0;return this.roomsOrder==="asc"?a<s?-1:s<a?1:0:a>s?-1:s>a?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find(a=>a.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const a=e.find(s=>s.roomId===this.roomId)||{};this.fetchRoom({room:a})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const a=this.roomsCasted.find(s=>s.roomId===e);this.fetchRoom({room:a})}else t&&!e&&(this.room={})}},room(e){!e||Object.entries(e).length===0||(_4(e),e.users.forEach(t=>{p4(t)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return e==="true"||e===!0},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?typeof e=="object"?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&t.action==="preview"?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},s5={class:"vac-chat-container"};function r5(e,t,a,s,n,r){const o=Ge("rooms-list"),u=Ge("room"),b=Ge("media-preview");return ee(),ue("div",{class:"vac-card-window",style:Ot([{height:a.height},r.cssVars])},[Me("div",s5,[r.singleRoomCasted?Ce("",!0):(ee(),gt(o,{key:0,"current-user-id":a.currentUserId,rooms:r.orderedRooms,"loading-rooms":r.loadingRoomsCasted,"rooms-loaded":r.roomsLoadedCasted,room:n.room,"room-actions":r.roomActionsCasted,"custom-search-room-enabled":a.customSearchRoomEnabled,"text-messages":r.t,"show-search":r.showSearchCasted,"show-add-room":r.showAddRoomCasted,"show-rooms-list":n.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":n.isMobile,"scroll-distance":a.scrollDistance,onFetchRoom:r.fetchRoom,onFetchMoreRooms:r.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=l=>n.loadingMoreRooms=l),onAddRoom:r.addRoom,onSearchRoom:r.searchRoom,onRoomActionHandler:r.roomActionHandler},Mt({_:2},[at(n.slots,l=>({name:l.slot,fn:Ze(p=>[Le(e.$slots,l.slot,St(bt(p)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Fe(u,{"current-user-id":a.currentUserId,rooms:r.roomsCasted,"room-id":n.room.roomId||"","load-first-room":r.loadFirstRoomCasted,messages:r.messagesCasted,"room-message":a.roomMessage,"messages-loaded":r.messagesLoadedCasted,"menu-actions":r.menuActionsCasted,"message-actions":r.messageActionsCasted,"message-selection-actions":r.messageSelectionActionsCasted,"auto-scroll":r.autoScrollCasted,"show-send-icon":r.showSendIconCasted,"show-files":r.showFilesCasted,"show-audio":r.showAudioCasted,"audio-bit-rate":a.audioBitRate,"audio-sample-rate":a.audioSampleRate,"show-emojis":r.showEmojisCasted,"show-reaction-emojis":r.showReactionEmojisCasted,"show-new-messages-divider":r.showNewMessagesDividerCasted,"show-footer":r.showFooterCasted,"text-messages":r.t,"single-room":r.singleRoomCasted,"show-rooms-list":n.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":n.isMobile,"loading-rooms":r.loadingRoomsCasted,"room-info-enabled":r.roomInfoEnabledCasted,"textarea-action-enabled":r.textareaActionEnabledCasted,"textarea-auto-focus":r.textareaAutoFocusCasted,"user-tags-enabled":r.userTagsEnabledCasted,"emojis-suggestion-enabled":r.emojisSuggestionEnabledCasted,"scroll-distance":a.scrollDistance,"accepted-files":a.acceptedFiles,"templates-text":r.templatesTextCasted,"username-options":r.usernameOptionsCasted,"emoji-data-source":a.emojiDataSource,onToggleRoomsList:r.toggleRoomsList,onRoomInfo:r.roomInfo,onFetchMessages:r.fetchMessages,onSendMessage:r.sendMessage,onEditMessage:r.editMessage,onDeleteMessage:r.deleteMessage,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:r.openFailedMessage,onMenuActionHandler:r.menuActionHandler,onMessageActionHandler:r.messageActionHandler,onMessageSelectionActionHandler:r.messageSelectionActionHandler,onSendMessageReaction:r.sendMessageReaction,onTypingMessage:r.typingMessage,onTextareaActionHandler:r.textareaActionHandler},Mt({_:2},[at(n.slots,l=>({name:l.slot,fn:Ze(p=>[Le(e.$slots,l.slot,St(bt(p)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Fe(Ht,{name:"vac-fade-preview",appear:""},{default:Ze(()=>[n.showMediaPreview?(ee(),gt(b,{key:0,file:n.previewFile,onCloseMediaPreview:t[1]||(t[1]=l=>n.showMediaPreview=!1)},Mt({_:2},[at(n.slots,l=>({name:l.slot,fn:Ze(p=>[Le(e.$slots,l.slot,St(bt(p)))])}))]),1032,["file"])):Ce("",!0)]),_:3})],4)}var n5=Tt(a5,[["render",r5],["styles",[t5]]]);const i5=Lf(n5),h1="vue-advanced-chat";function o5(){customElements.get(h1)||customElements.define(h1,i5)}const Pu=e=>(Zu("data-v-ed8ef417"),e=e(),Wu(),e),l5=Pu(()=>la("span",{class:"team_list"},"成员列表",-1)),c5={class:"member-item"},u5=Pu(()=>la("img",{class:"avatar",src:$u},null,-1)),d5={class:"member-info"},m5={class:"member-name"},f5={class:"member-email"},h5=["innerHTML"],v5={class:"dialog-footer"},_5={class:"dialog-footer"},p5={class:"dialog-footer"},g5={class:"dialog-footer"},jr="140px",Xn=20,b5={__name:"chatHome",setup(e){o5();const t=Vu(),a=ht(),s=ht(),n=ht(),r=ht([]),o=ht([]),u=ht(),b=ht("800px"),l=ht(!1),p=ht(!1),c=ht(!1),E=ht(!1),A=ht(!1),i=ht(!0),F=ht(!0),L=ht(!0),B=ht(),f=ht([]),R=ht([]),C=ht(),T=ht([]),N=ht([]),m=ht([]),k=ht([]),S=ht([]),h=ht([]),g=ht([]),_=ht(),v=ht(),y=ht(),w=ht(!1),j=ht([]),K=Vl([{name:"selectMessages",title:"Select"},{name:"privateChatAction",title:"私聊"}]),P=Vl([{name:"mergeSend",title:"合并转发"},{name:"seperateSend",title:"逐条转发"}]);async function z(){let fe=await Dt.searchHistory(y.value,h.value);g.value=fe.data.matches}async function d(){let fe=await Qu.queryTeamMember(s.value),ae=[];fe.data.members.forEach(ve=>{ve.id!=n.value&&ae.push(ve)}),N.value=ae}async function M(fe){m.value=N.value;let ve=(await Dt.getRoomInfo(fe)).data.members;m.value=m.value.filter(se=>!ve.find(le=>le.id===se.id))}async function W(fe){let ae=await Dt.getRoomInfo(fe);k.value=ae.data.members}async function $(fe){let ae=await Dt.getRoomInfo(fe),ve=ae.data.admin;ve===null?(i.value=!1,F.value=!0):ve.toString()!==n.value?(i.value=!1,F.value=!1):(i.value=!0,F.value=!1),S.value=ae.data.members}async function _e(fe){await Dt.deleteChat(fe),await he()}async function Ae(fe,ae,ve=null){await Dt.createRoom(s.value,fe,ae,ve),await he()}async function Re(){let fe=[];f.value.length===0?Xi.error("您还未添加任何一名群聊成员"):(f.value.forEach(ae=>{N.value.forEach(ve=>{ae===ve.name&&fe.push(ve.id)})}),fe.push(n.value),await Ae(fe,B.value)),l.value=!1}async function ge(){let fe=[];R.value.length===0?Xi.error("您还未添加任何一名群聊成员"):(R.value.forEach(ae=>{m.value.forEach(ve=>{ae===ve.name&&fe.push(ve.id)})}),await Dt.addTeamMember(y.value,fe),R.value=[]),p.value=!1}async function Ve(){let fe=[];T.value.length===0?Xi.error("您还未选择任何一名群聊成员"):(T.value.forEach(ae=>{k.value.forEach(ve=>{ae===ve.name&&fe.push(ve.id)})}),await Dt.deleteTeamMember(y.value,fe),T.value=[],await he()),c.value=!1}async function Ne(){let fe,ae=[];r.value.forEach(ve=>{ve.roomName===C.value&&(fe=ve.roomId)}),j.value.forEach(ve=>{ae.push(ve._id)}),L.value===!0?await Dt.sendHole(y.value,ae,fe):await Dt.sendDivide(y.value,ae,fe)}async function he(){let fe=await Dt.queryAllRoom(s.value);const ae=[];fe.data.forEach(ve=>{let se=[];ve.members.forEach(Q=>{let Oe={_id:Q.id.toString(),username:Q.name,timestamp:Q.update_time,avatar:""};se.push(Oe)});let le={};ve.last_message===null?le={roomId:ve.id,roomName:ve.name,users:se,avatar:"/doe.png",unreadCount:ve.unread_count}:le={roomId:ve.id,roomName:ve.name,users:se,avatar:"/doe.png",unreadCount:ve.unread_count,lastMessage:{_id:ve.last_message.id.toString(),content:ve.last_message.content.substring(0,100),senderId:ve.last_message.sender.toString(),username:ve.last_message.sender_name,timestamp:ve.last_message.update_time}},ae.push(le)}),r.value=ae}async function Ke({room:fe,options:ae={}}){let ve,se;y.value=fe.roomId,w.value=!1,ae.reset?(o.value=[],v.value?(ve=await Dt.queryMessage(fe.roomId,v.value,Xn,!0),se=v.value,v.value=null):ve=await Dt.queryMessage(fe.roomId,null,Xn)):ve=await Dt.queryMessage(fe.roomId,o.value[0]._id,Xn),await Dt.readAllMessage(fe.roomId),(!ve.data||ve.data.length===0||ve.data.length<Xn)&&!se&&setTimeout(()=>{w.value=!0},0),ve.data.forEach(le=>{if(le.type=="text"){let Q={_id:le.id,content:le.content,senderId:le.sender.toString(),username:le.sender_name,date:le.created_time,timestamp:le.created_time,avatar:"/doe.png",usersTag:""};o.value.unshift(Q)}else{console.log("------downFile------"),console.log(le.content);let Q={_id:le.id,content:"",senderId:le.sender.toString(),username:le.sender_name,date:le.created_time,timestamp:le.created_time,avatar:"/doe.png",usersTag:"",files:[{name:"我的文件",url:le.content,type:le.content.split(".")[le.content.split(".").length-1]}]};o.value.unshift(Q)}}),await he(),setTimeout(()=>{De(se)},100)}async function it(fe){console.log("------fileMessage------"),console.log(fe);let ae=new FileReader;if(fe.files!==null)for(const ve of fe.files)ae.readAsDataURL(ve.blob),await Dt.sendFile(y.value,ve.type,ve.extension,ve.blob);if(fe.content!==""){let ve={team:s.value,receiver:"",chat:fe.roomId,content:fe.content,type:"text"};a.value.send(JSON.stringify(ve))}}function U({file:fe}){window.open(fe.file.url,"_blank")}async function Y(fe){let ae=JSON.parse(fe.data);if(ae.type==="text"){if(ae.chat===y.value){let ve={_id:ae.id,content:ae.content,senderId:n.value.toString(),username:ae.sender_name,date:ae.created_time,timestamp:ae.created_time,avatar:"/doe.png"};o.value.push(ve)}}else{let ve={_id:ae.id,content:"",senderId:n.value.toString(),username:ae.sender_name,date:ae.created_time,timestamp:ae.created_time,avatar:"/doe.png",files:[{name:"基本项",url:ae.content,type:ae.content.split(".")[ae.content.split(".").length-1]}]};o.value.push(ve)}await Dt.readAllMessage(y.value),he()}function te({action:fe}){switch(fe.name){}}function de({roomId:fe,action:ae,message:ve}){let se=[],le="to "+ve.username;switch(se.push(ve.senderId.toString()),se.push(n.value),ae.name){case"replyAction":break;case"privateChatAction":Ae(se,le,"single");break}}function me(){M(y.value),p.value=!0}function Ee(){M(y.value),W(y.value),c.value=!0}function xe(){_e(y.value),A.value=!1}function be(){i.value===!0?Dt.deleteChatAdmin(y.value):Dt.deleteChatNormal(y.value)}function ke(fe){A.value=!0,y.value=fe.roomId,$(fe.roomId)}function pe(fe){switch(E.value=!0,console.log("@@@@@"),console.log(fe.messages),j.value=fe.messages,fe.action.name){case"mergeSend":L.value=!0;break;case"seperateSend":L.value=!1;break}}function De(fe){window.document.getElementsByTagName("vue-advanced-chat")[0].shadowRoot.getElementById(fe).scrollIntoView()}function He(fe){De(fe.id),A.value=!1}return qu(()=>{s.value=t.params.team_id,n.value=zu(),u.value=n.value,he().then(()=>{_.value=t.query.room,v.value=t.query.message}),d(),a.value=new WebSocket(`ws://azure.bienboy.store/summer/ws/chat/${n.value}`),a.value.addEventListener("message",Y)}),(fe,ae)=>{const ve=$t("vue-advanced-chat"),se=$t("font-awesome-icon"),le=$t("el-button"),Q=$t("el-dropdown-item"),Oe=$t("el-dropdown-menu"),x=$t("el-dropdown"),I=$t("el-table-column"),D=$t("el-table"),V=$t("el-drawer"),X=$t("el-input"),H=$t("el-form-item"),Z=$t("el-option"),J=$t("el-select"),G=$t("el-form"),ie=$t("el-dialog");return Xt(),ks(er,null,[lt(ve,{"current-user-id":u.value,"room-info-enabled":!0,rooms:JSON.stringify(r.value),messages:JSON.stringify(o.value),"rooms-loaded":!0,height:b.value,"message-actions":JSON.stringify(K),"menu-action-handler":te,"messages-loaded":w.value,"load-first-room":!1,"room-id":_.value,"message-selection-actions":JSON.stringify(P),onOpenUserTag:ae[0]||(ae[0]=q=>console.log("")),onSendMessage:ae[1]||(ae[1]=q=>it(q.detail[0])),onOpenFile:ae[2]||(ae[2]=q=>U(q.detail[0])),onAddRoom:ae[3]||(ae[3]=q=>l.value=!0),onMessageActionHandler:ae[4]||(ae[4]=q=>de(q.detail[0])),onFetchMessages:ae[5]||(ae[5]=q=>Ke(q.detail[0])),onRoomInfo:ae[6]||(ae[6]=q=>ke(q.detail[0])),onMessageSelectionActionHandler:ae[7]||(ae[7]=q=>pe(q.detail[0]))},{"message-content":st(({message:q})=>[la("div",{class:Yu("message sender-"+q.senderId)},Yi(q.content),3)]),_:1},8,["current-user-id","rooms","messages","height","message-actions","messages-loaded","room-id","message-selection-actions"]),lt(V,{modelValue:A.value,"onUpdate:modelValue":ae[10]||(ae[10]=q=>A.value=q),direction:"rtl",size:"18%"},{default:st(()=>[l5,F.value?Tr("",!0):(Xt(),Za(x,{key:0},{dropdown:st(()=>[lt(Oe,null,{default:st(()=>[i.value?(Xt(),Za(Q,{key:0,onClick:me},{default:st(()=>[ya("邀请成员")]),_:1})):Tr("",!0),i.value?(Xt(),Za(Q,{key:1,onClick:Ee},{default:st(()=>[ya("删除成员")]),_:1})):Tr("",!0),!F.value&&i.value?(Xt(),Za(Q,{key:2,onClick:xe},{default:st(()=>[ya("解散群聊")]),_:1})):Tr("",!0),F.value?Tr("",!0):(Xt(),Za(Q,{key:3,onClick:be},{default:st(()=>[ya("退出群聊")]),_:1}))]),_:1})]),default:st(()=>[lt(le,{text:""},{default:st(()=>[lt(se,{icon:["fas","ellipsis-vertical"]})]),_:1})]),_:1})),(Xt(!0),ks(er,null,Rr(S.value,q=>(Xt(),ks("div",c5,[u5,la("div",d5,[la("div",m5,Yi(q.name),1),la("div",f5,Yi(q.email),1)])]))),256)),la("form",{class:"search-bar",onSubmit:ae[9]||(ae[9]=Gu(()=>{},["prevent"]))},[Xu(la("input",{"onUpdate:modelValue":ae[8]||(ae[8]=q=>h.value=q),size:"small",placeholder:"Search...",onChange:z},null,544),[[Ku,h.value]]),la("button",null,[lt(se,{icon:["fas","magnifying-glass"]})])],32),lt(D,{data:g.value,style:{width:"100%"},onRowClick:He},{default:st(()=>[lt(I,{prop:"update_time",label:"发送时间"}),lt(I,{prop:"sender_name",label:"发送者姓名",width:"100px"}),lt(I,{prop:"content",label:"发送内容",width:"310px"},{default:st(({row:q})=>[la("div",{class:"content-cell",innerHTML:q.content},null,8,h5)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"]),lt(ie,{modelValue:l.value,"onUpdate:modelValue":ae[14]||(ae[14]=q=>l.value=q),title:"创建群聊"},{footer:st(()=>[la("span",v5,[lt(le,{onClick:ae[13]||(ae[13]=q=>l.value=!1)},{default:st(()=>[ya("取消")]),_:1}),lt(le,{type:"primary",onClick:Re},{default:st(()=>[ya(" 确认 ")]),_:1})])]),default:st(()=>[lt(G,{model:B.value},{default:st(()=>[lt(H,{label:"群聊名称","label-width":jr},{default:st(()=>[lt(X,{modelValue:B.value,"onUpdate:modelValue":ae[11]||(ae[11]=q=>B.value=q),autocomplete:"off",style:{width:"auto"}},null,8,["modelValue"])]),_:1}),lt(H,{label:"群聊成员","label-width":jr},{default:st(()=>[lt(J,{modelValue:f.value,"onUpdate:modelValue":ae[12]||(ae[12]=q=>f.value=q),multiple:"",placeholder:"Select"},{default:st(()=>[(Xt(!0),ks(er,null,Rr(N.value,q=>(Xt(),Za(Z,{key:q.id,label:q.name,value:q.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),lt(ie,{modelValue:p.value,"onUpdate:modelValue":ae[17]||(ae[17]=q=>p.value=q),title:"添加成员"},{footer:st(()=>[la("span",_5,[lt(le,{onClick:ae[16]||(ae[16]=q=>p.value=!1)},{default:st(()=>[ya("取消")]),_:1}),lt(le,{type:"primary",onClick:ge},{default:st(()=>[ya(" 确认 ")]),_:1})])]),default:st(()=>[lt(G,{model:B.value},{default:st(()=>[lt(H,{label:"群聊成员","label-width":jr},{default:st(()=>[lt(J,{modelValue:R.value,"onUpdate:modelValue":ae[15]||(ae[15]=q=>R.value=q),multiple:"",placeholder:"Select"},{default:st(()=>[(Xt(!0),ks(er,null,Rr(m.value,q=>(Xt(),Za(Z,{key:q.id,label:q.name,value:q.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),lt(ie,{modelValue:c.value,"onUpdate:modelValue":ae[20]||(ae[20]=q=>c.value=q),title:"删除成员"},{footer:st(()=>[la("span",p5,[lt(le,{onClick:ae[19]||(ae[19]=q=>c.value=!1)},{default:st(()=>[ya("取消")]),_:1}),lt(le,{type:"primary",onClick:Ve},{default:st(()=>[ya(" 确认 ")]),_:1})])]),default:st(()=>[lt(G,{model:B.value},{default:st(()=>[lt(H,{label:"群聊成员","label-width":jr},{default:st(()=>[lt(J,{modelValue:T.value,"onUpdate:modelValue":ae[18]||(ae[18]=q=>T.value=q),multiple:"",placeholder:"Select"},{default:st(()=>[(Xt(!0),ks(er,null,Rr(k.value,q=>(Xt(),Za(Z,{key:q.id,label:q.name,value:q.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),lt(ie,{modelValue:E.value,"onUpdate:modelValue":ae[23]||(ae[23]=q=>E.value=q),title:"创建群聊"},{footer:st(()=>[la("span",g5,[lt(le,{onClick:ae[22]||(ae[22]=q=>E.value=!1)},{default:st(()=>[ya("Cancel")]),_:1}),lt(le,{type:"primary",onClick:Ne},{default:st(()=>[ya(" Confirm ")]),_:1})])]),default:st(()=>[lt(G,{model:B.value},{default:st(()=>[lt(H,{label:"发送的群聊","label-width":jr},{default:st(()=>[lt(J,{modelValue:C.value,"onUpdate:modelValue":ae[21]||(ae[21]=q=>C.value=q),placeholder:"Select"},{default:st(()=>[(Xt(!0),ks(er,null,Rr(r.value,q=>(Xt(),Za(Z,{key:q.roomId,label:q.roomName,value:q.roomName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}},M5=Du(b5,[["__scopeId","data-v-ed8ef417"]]);export{M5 as default};
